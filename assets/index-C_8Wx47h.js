(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function aC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qx={exports:{}},Vh={},Jx={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wu=Symbol.for("react.element"),oC=Symbol.for("react.portal"),lC=Symbol.for("react.fragment"),uC=Symbol.for("react.strict_mode"),cC=Symbol.for("react.profiler"),fC=Symbol.for("react.provider"),hC=Symbol.for("react.context"),dC=Symbol.for("react.forward_ref"),pC=Symbol.for("react.suspense"),mC=Symbol.for("react.memo"),gC=Symbol.for("react.lazy"),ov=Symbol.iterator;function vC(t){return t===null||typeof t!="object"?null:(t=ov&&t[ov]||t["@@iterator"],typeof t=="function"?t:null)}var Zx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ew=Object.assign,tw={};function Xo(t,e,r){this.props=t,this.context=e,this.refs=tw,this.updater=r||Zx}Xo.prototype.isReactComponent={};Xo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Xo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rw(){}rw.prototype=Xo.prototype;function ym(t,e,r){this.props=t,this.context=e,this.refs=tw,this.updater=r||Zx}var xm=ym.prototype=new rw;xm.constructor=ym;ew(xm,Xo.prototype);xm.isPureReactComponent=!0;var lv=Array.isArray,nw=Object.prototype.hasOwnProperty,wm={current:null},iw={key:!0,ref:!0,__self:!0,__source:!0};function sw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)nw.call(e,n)&&!iw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Wu,type:t,key:s,ref:a,props:i,_owner:wm.current}}function _C(t,e){return{$$typeof:Wu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Em(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wu}function yC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var uv=/\/+/g;function Gd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?yC(""+t.key):e.toString(36)}function lf(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Wu:case oC:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Gd(a,0):n,lv(i)?(r="",t!=null&&(r=t.replace(uv,"$&/")+"/"),lf(i,e,r,"",function(u){return u})):i!=null&&(Em(i)&&(i=_C(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(uv,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",lv(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Gd(s,o);a+=lf(s,e,r,l,i)}else if(l=vC(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Gd(s,o++),a+=lf(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ic(t,e,r){if(t==null)return t;var n=[],i=0;return lf(t,n,"","",function(s){return e.call(r,s,i++)}),n}function xC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rr={current:null},uf={transition:null},wC={ReactCurrentDispatcher:Rr,ReactCurrentBatchConfig:uf,ReactCurrentOwner:wm};function aw(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:Ic,forEach:function(t,e,r){Ic(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ic(t,function(){e++}),e},toArray:function(t){return Ic(t,function(e){return e})||[]},only:function(t){if(!Em(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ue.Component=Xo;Ue.Fragment=lC;Ue.Profiler=cC;Ue.PureComponent=ym;Ue.StrictMode=uC;Ue.Suspense=pC;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wC;Ue.act=aw;Ue.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ew({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=wm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)nw.call(e,l)&&!iw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Wu,type:t.type,key:i,ref:s,props:n,_owner:a}};Ue.createContext=function(t){return t={$$typeof:hC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fC,_context:t},t.Consumer=t};Ue.createElement=sw;Ue.createFactory=function(t){var e=sw.bind(null,t);return e.type=t,e};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(t){return{$$typeof:dC,render:t}};Ue.isValidElement=Em;Ue.lazy=function(t){return{$$typeof:gC,_payload:{_status:-1,_result:t},_init:xC}};Ue.memo=function(t,e){return{$$typeof:mC,type:t,compare:e===void 0?null:e}};Ue.startTransition=function(t){var e=uf.transition;uf.transition={};try{t()}finally{uf.transition=e}};Ue.unstable_act=aw;Ue.useCallback=function(t,e){return Rr.current.useCallback(t,e)};Ue.useContext=function(t){return Rr.current.useContext(t)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(t){return Rr.current.useDeferredValue(t)};Ue.useEffect=function(t,e){return Rr.current.useEffect(t,e)};Ue.useId=function(){return Rr.current.useId()};Ue.useImperativeHandle=function(t,e,r){return Rr.current.useImperativeHandle(t,e,r)};Ue.useInsertionEffect=function(t,e){return Rr.current.useInsertionEffect(t,e)};Ue.useLayoutEffect=function(t,e){return Rr.current.useLayoutEffect(t,e)};Ue.useMemo=function(t,e){return Rr.current.useMemo(t,e)};Ue.useReducer=function(t,e,r){return Rr.current.useReducer(t,e,r)};Ue.useRef=function(t){return Rr.current.useRef(t)};Ue.useState=function(t){return Rr.current.useState(t)};Ue.useSyncExternalStore=function(t,e,r){return Rr.current.useSyncExternalStore(t,e,r)};Ue.useTransition=function(){return Rr.current.useTransition()};Ue.version="18.3.1";Jx.exports=Ue;var ke=Jx.exports;const EC=aC(ke);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TC=ke,SC=Symbol.for("react.element"),AC=Symbol.for("react.fragment"),IC=Object.prototype.hasOwnProperty,CC=TC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RC={key:!0,ref:!0,__self:!0,__source:!0};function ow(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)IC.call(e,n)&&!RC.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:SC,type:t,key:s,ref:a,props:i,_owner:CC.current}}Vh.Fragment=AC;Vh.jsx=ow;Vh.jsxs=ow;Qx.exports=Vh;var v=Qx.exports,K0={},lw={exports:{}},en={},uw={exports:{}},cw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(he,J){var te=he.length;he.push(J);e:for(;0<te;){var ce=te-1>>>1,V=he[ce];if(0<i(V,J))he[ce]=J,he[te]=V,te=ce;else break e}}function r(he){return he.length===0?null:he[0]}function n(he){if(he.length===0)return null;var J=he[0],te=he.pop();if(te!==J){he[0]=te;e:for(var ce=0,V=he.length,z=V>>>1;ce<z;){var B=2*(ce+1)-1,j=he[B],re=B+1,ye=he[re];if(0>i(j,te))re<V&&0>i(ye,j)?(he[ce]=ye,he[re]=te,ce=re):(he[ce]=j,he[B]=te,ce=B);else if(re<V&&0>i(ye,te))he[ce]=ye,he[re]=te,ce=re;else break e}}return J}function i(he,J){var te=he.sortIndex-J.sortIndex;return te!==0?te:he.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,h=null,d=3,m=!1,y=!1,g=!1,A=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(he){for(var J=r(u);J!==null;){if(J.callback===null)n(u);else if(J.startTime<=he)n(u),J.sortIndex=J.expirationTime,e(l,J);else break;J=r(u)}}function L(he){if(g=!1,I(he),!y)if(r(l)!==null)y=!0,nt(W);else{var J=r(u);J!==null&&Ke(L,J.startTime-he)}}function W(he,J){y=!1,g&&(g=!1,w(T),T=-1),m=!0;var te=d;try{for(I(J),h=r(l);h!==null&&(!(h.expirationTime>J)||he&&!N());){var ce=h.callback;if(typeof ce=="function"){h.callback=null,d=h.priorityLevel;var V=ce(h.expirationTime<=J);J=t.unstable_now(),typeof V=="function"?h.callback=V:h===r(l)&&n(l),I(J)}else n(l);h=r(l)}if(h!==null)var z=!0;else{var B=r(u);B!==null&&Ke(L,B.startTime-J),z=!1}return z}finally{h=null,d=te,m=!1}}var G=!1,E=null,T=-1,S=5,R=-1;function N(){return!(t.unstable_now()-R<S)}function M(){if(E!==null){var he=t.unstable_now();R=he;var J=!0;try{J=E(!0,he)}finally{J?D():(G=!1,E=null)}}else G=!1}var D;if(typeof x=="function")D=function(){x(M)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,Ie=Re.port2;Re.port1.onmessage=M,D=function(){Ie.postMessage(null)}}else D=function(){A(M,0)};function nt(he){E=he,G||(G=!0,D())}function Ke(he,J){T=A(function(){he(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(he){he.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,nt(W))},t.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<he?Math.floor(1e3/he):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(he){switch(d){case 1:case 2:case 3:var J=3;break;default:J=d}var te=d;d=J;try{return he()}finally{d=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(he,J){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var te=d;d=he;try{return J()}finally{d=te}},t.unstable_scheduleCallback=function(he,J,te){var ce=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?ce+te:ce):te=ce,he){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=te+V,he={id:f++,callback:J,priorityLevel:he,startTime:te,expirationTime:V,sortIndex:-1},te>ce?(he.sortIndex=te,e(u,he),r(l)===null&&he===r(u)&&(g?(w(T),T=-1):g=!0,Ke(L,te-ce))):(he.sortIndex=V,e(l,he),y||m||(y=!0,nt(W))),he},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(he){var J=d;return function(){var te=d;d=J;try{return he.apply(this,arguments)}finally{d=te}}}})(cw);uw.exports=cw;var kC=uw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PC=ke,Jr=kC;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fw=new Set,cu={};function Sa(t,e){Oo(t,e),Oo(t+"Capture",e)}function Oo(t,e){for(cu[t]=e,t=0;t<e.length;t++)fw.add(e[t])}var Ti=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),q0=Object.prototype.hasOwnProperty,NC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cv={},fv={};function DC(t){return q0.call(fv,t)?!0:q0.call(cv,t)?!1:NC.test(t)?fv[t]=!0:(cv[t]=!0,!1)}function OC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function FC(t,e,r,n){if(e===null||typeof e>"u"||OC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kr(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var ur={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ur[t]=new kr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ur[e]=new kr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ur[t]=new kr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ur[t]=new kr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ur[t]=new kr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ur[t]=new kr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ur[t]=new kr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ur[t]=new kr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ur[t]=new kr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Tm=/[\-:]([a-z])/g;function Sm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Tm,Sm);ur[e]=new kr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Tm,Sm);ur[e]=new kr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Tm,Sm);ur[e]=new kr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ur[t]=new kr(t,1,!1,t.toLowerCase(),null,!1,!1)});ur.xlinkHref=new kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ur[t]=new kr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Am(t,e,r,n){var i=ur.hasOwnProperty(e)?ur[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(FC(e,r,i,n)&&(r=null),n||i===null?DC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Oi=PC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cc=Symbol.for("react.element"),io=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),Im=Symbol.for("react.strict_mode"),X0=Symbol.for("react.profiler"),hw=Symbol.for("react.provider"),dw=Symbol.for("react.context"),Cm=Symbol.for("react.forward_ref"),Y0=Symbol.for("react.suspense"),Q0=Symbol.for("react.suspense_list"),Rm=Symbol.for("react.memo"),qi=Symbol.for("react.lazy"),pw=Symbol.for("react.offscreen"),hv=Symbol.iterator;function xl(t){return t===null||typeof t!="object"?null:(t=hv&&t[hv]||t["@@iterator"],typeof t=="function"?t:null)}var xt=Object.assign,Kd;function Pl(t){if(Kd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Kd=e&&e[1]||""}return`
`+Kd+t}var qd=!1;function Xd(t,e){if(!t||qd)return"";qd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{qd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Pl(t):""}function LC(t){switch(t.tag){case 5:return Pl(t.type);case 16:return Pl("Lazy");case 13:return Pl("Suspense");case 19:return Pl("SuspenseList");case 0:case 2:case 15:return t=Xd(t.type,!1),t;case 11:return t=Xd(t.type.render,!1),t;case 1:return t=Xd(t.type,!0),t;default:return""}}function J0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case so:return"Fragment";case io:return"Portal";case X0:return"Profiler";case Im:return"StrictMode";case Y0:return"Suspense";case Q0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dw:return(t.displayName||"Context")+".Consumer";case hw:return(t._context.displayName||"Context")+".Provider";case Cm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rm:return e=t.displayName||null,e!==null?e:J0(t.type)||"Memo";case qi:e=t._payload,t=t._init;try{return J0(t(e))}catch{}}return null}function bC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J0(e);case 8:return e===Im?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ys(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function MC(t){var e=mw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Rc(t){t._valueTracker||(t._valueTracker=MC(t))}function gw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=mw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Pf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Z0(t,e){var r=e.checked;return xt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function dv(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ys(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vw(t,e){e=e.checked,e!=null&&Am(t,"checked",e,!1)}function ep(t,e){vw(t,e);var r=ys(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?tp(t,e.type,r):e.hasOwnProperty("defaultValue")&&tp(t,e.type,ys(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pv(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function tp(t,e,r){(e!=="number"||Pf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Nl=Array.isArray;function _o(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ys(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function rp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return xt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mv(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(fe(92));if(Nl(r)){if(1<r.length)throw Error(fe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ys(r)}}function _w(t,e){var r=ys(e.value),n=ys(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function gv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function np(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kc,xw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kc=kc||document.createElement("div"),kc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fu(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var jl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VC=["Webkit","ms","Moz","O"];Object.keys(jl).forEach(function(t){VC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jl[e]=jl[t]})});function ww(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||jl.hasOwnProperty(t)&&jl[t]?(""+e).trim():e+"px"}function Ew(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ww(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var UC=xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ip(t,e){if(e){if(UC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function sp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ap=null;function km(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var op=null,yo=null,xo=null;function vv(t){if(t=Gu(t)){if(typeof op!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=Wh(e),op(t.stateNode,t.type,e))}}function Tw(t){yo?xo?xo.push(t):xo=[t]:yo=t}function Sw(){if(yo){var t=yo,e=xo;if(xo=yo=null,vv(t),e)for(t=0;t<e.length;t++)vv(e[t])}}function Aw(t,e){return t(e)}function Iw(){}var Yd=!1;function Cw(t,e,r){if(Yd)return t(e,r);Yd=!0;try{return Aw(t,e,r)}finally{Yd=!1,(yo!==null||xo!==null)&&(Iw(),Sw())}}function hu(t,e){var r=t.stateNode;if(r===null)return null;var n=Wh(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(fe(231,e,typeof r));return r}var lp=!1;if(Ti)try{var wl={};Object.defineProperty(wl,"passive",{get:function(){lp=!0}}),window.addEventListener("test",wl,wl),window.removeEventListener("test",wl,wl)}catch{lp=!1}function BC(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var zl=!1,Nf=null,Df=!1,up=null,jC={onError:function(t){zl=!0,Nf=t}};function zC(t,e,r,n,i,s,a,o,l){zl=!1,Nf=null,BC.apply(jC,arguments)}function WC(t,e,r,n,i,s,a,o,l){if(zC.apply(this,arguments),zl){if(zl){var u=Nf;zl=!1,Nf=null}else throw Error(fe(198));Df||(Df=!0,up=u)}}function Aa(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Rw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _v(t){if(Aa(t)!==t)throw Error(fe(188))}function HC(t){var e=t.alternate;if(!e){if(e=Aa(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return _v(i),t;if(s===n)return _v(i),e;s=s.sibling}throw Error(fe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(fe(189))}}if(r.alternate!==n)throw Error(fe(190))}if(r.tag!==3)throw Error(fe(188));return r.stateNode.current===r?t:e}function kw(t){return t=HC(t),t!==null?Pw(t):null}function Pw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Pw(t);if(e!==null)return e;t=t.sibling}return null}var Nw=Jr.unstable_scheduleCallback,yv=Jr.unstable_cancelCallback,$C=Jr.unstable_shouldYield,GC=Jr.unstable_requestPaint,kt=Jr.unstable_now,KC=Jr.unstable_getCurrentPriorityLevel,Pm=Jr.unstable_ImmediatePriority,Dw=Jr.unstable_UserBlockingPriority,Of=Jr.unstable_NormalPriority,qC=Jr.unstable_LowPriority,Ow=Jr.unstable_IdlePriority,Uh=null,Xn=null;function XC(t){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(Uh,t,void 0,(t.current.flags&128)===128)}catch{}}var Dn=Math.clz32?Math.clz32:JC,YC=Math.log,QC=Math.LN2;function JC(t){return t>>>=0,t===0?32:31-(YC(t)/QC|0)|0}var Pc=64,Nc=4194304;function Dl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ff(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Dl(o):(s&=a,s!==0&&(n=Dl(s)))}else a=r&~i,a!==0?n=Dl(a):s!==0&&(n=Dl(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Dn(e),i=1<<r,n|=t[r],e&=~i;return n}function ZC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function e4(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Dn(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=ZC(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function cp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Fw(){var t=Pc;return Pc<<=1,!(Pc&4194240)&&(Pc=64),t}function Qd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Hu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dn(e),t[e]=r}function t4(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Dn(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Nm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Dn(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var et=0;function Lw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bw,Dm,Mw,Vw,Uw,fp=!1,Dc=[],as=null,os=null,ls=null,du=new Map,pu=new Map,Yi=[],r4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xv(t,e){switch(t){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":os=null;break;case"mouseover":case"mouseout":ls=null;break;case"pointerover":case"pointerout":du.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pu.delete(e.pointerId)}}function El(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Gu(e),e!==null&&Dm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function n4(t,e,r,n,i){switch(e){case"focusin":return as=El(as,t,e,r,n,i),!0;case"dragenter":return os=El(os,t,e,r,n,i),!0;case"mouseover":return ls=El(ls,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return du.set(s,El(du.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,pu.set(s,El(pu.get(s)||null,t,e,r,n,i)),!0}return!1}function Bw(t){var e=Zs(t.target);if(e!==null){var r=Aa(e);if(r!==null){if(e=r.tag,e===13){if(e=Rw(r),e!==null){t.blockedOn=e,Uw(t.priority,function(){Mw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function cf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=hp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);ap=n,r.target.dispatchEvent(n),ap=null}else return e=Gu(r),e!==null&&Dm(e),t.blockedOn=r,!1;e.shift()}return!0}function wv(t,e,r){cf(t)&&r.delete(e)}function i4(){fp=!1,as!==null&&cf(as)&&(as=null),os!==null&&cf(os)&&(os=null),ls!==null&&cf(ls)&&(ls=null),du.forEach(wv),pu.forEach(wv)}function Tl(t,e){t.blockedOn===e&&(t.blockedOn=null,fp||(fp=!0,Jr.unstable_scheduleCallback(Jr.unstable_NormalPriority,i4)))}function mu(t){function e(i){return Tl(i,t)}if(0<Dc.length){Tl(Dc[0],t);for(var r=1;r<Dc.length;r++){var n=Dc[r];n.blockedOn===t&&(n.blockedOn=null)}}for(as!==null&&Tl(as,t),os!==null&&Tl(os,t),ls!==null&&Tl(ls,t),du.forEach(e),pu.forEach(e),r=0;r<Yi.length;r++)n=Yi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Yi.length&&(r=Yi[0],r.blockedOn===null);)Bw(r),r.blockedOn===null&&Yi.shift()}var wo=Oi.ReactCurrentBatchConfig,Lf=!0;function s4(t,e,r,n){var i=et,s=wo.transition;wo.transition=null;try{et=1,Om(t,e,r,n)}finally{et=i,wo.transition=s}}function a4(t,e,r,n){var i=et,s=wo.transition;wo.transition=null;try{et=4,Om(t,e,r,n)}finally{et=i,wo.transition=s}}function Om(t,e,r,n){if(Lf){var i=hp(t,e,r,n);if(i===null)o0(t,e,n,bf,r),xv(t,n);else if(n4(i,t,e,r,n))n.stopPropagation();else if(xv(t,n),e&4&&-1<r4.indexOf(t)){for(;i!==null;){var s=Gu(i);if(s!==null&&bw(s),s=hp(t,e,r,n),s===null&&o0(t,e,n,bf,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else o0(t,e,n,null,r)}}var bf=null;function hp(t,e,r,n){if(bf=null,t=km(n),t=Zs(t),t!==null)if(e=Aa(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Rw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return bf=t,null}function jw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(KC()){case Pm:return 1;case Dw:return 4;case Of:case qC:return 16;case Ow:return 536870912;default:return 16}default:return 16}}var ts=null,Fm=null,ff=null;function zw(){if(ff)return ff;var t,e=Fm,r=e.length,n,i="value"in ts?ts.value:ts.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return ff=i.slice(t,1<n?1-n:void 0)}function hf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Oc(){return!0}function Ev(){return!1}function tn(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Oc:Ev,this.isPropagationStopped=Ev,this}return xt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Oc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Oc)},persist:function(){},isPersistent:Oc}),e}var Yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lm=tn(Yo),$u=xt({},Yo,{view:0,detail:0}),o4=tn($u),Jd,Zd,Sl,Bh=xt({},$u,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sl&&(Sl&&t.type==="mousemove"?(Jd=t.screenX-Sl.screenX,Zd=t.screenY-Sl.screenY):Zd=Jd=0,Sl=t),Jd)},movementY:function(t){return"movementY"in t?t.movementY:Zd}}),Tv=tn(Bh),l4=xt({},Bh,{dataTransfer:0}),u4=tn(l4),c4=xt({},$u,{relatedTarget:0}),e0=tn(c4),f4=xt({},Yo,{animationName:0,elapsedTime:0,pseudoElement:0}),h4=tn(f4),d4=xt({},Yo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),p4=tn(d4),m4=xt({},Yo,{data:0}),Sv=tn(m4),g4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},v4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_4[t])?!!e[t]:!1}function bm(){return y4}var x4=xt({},$u,{key:function(t){if(t.key){var e=g4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?v4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bm,charCode:function(t){return t.type==="keypress"?hf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),w4=tn(x4),E4=xt({},Bh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Av=tn(E4),T4=xt({},$u,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bm}),S4=tn(T4),A4=xt({},Yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),I4=tn(A4),C4=xt({},Bh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),R4=tn(C4),k4=[9,13,27,32],Mm=Ti&&"CompositionEvent"in window,Wl=null;Ti&&"documentMode"in document&&(Wl=document.documentMode);var P4=Ti&&"TextEvent"in window&&!Wl,Ww=Ti&&(!Mm||Wl&&8<Wl&&11>=Wl),Iv=" ",Cv=!1;function Hw(t,e){switch(t){case"keyup":return k4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $w(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ao=!1;function N4(t,e){switch(t){case"compositionend":return $w(e);case"keypress":return e.which!==32?null:(Cv=!0,Iv);case"textInput":return t=e.data,t===Iv&&Cv?null:t;default:return null}}function D4(t,e){if(ao)return t==="compositionend"||!Mm&&Hw(t,e)?(t=zw(),ff=Fm=ts=null,ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ww&&e.locale!=="ko"?null:e.data;default:return null}}var O4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!O4[t.type]:e==="textarea"}function Gw(t,e,r,n){Tw(n),e=Mf(e,"onChange"),0<e.length&&(r=new Lm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Hl=null,gu=null;function F4(t){nE(t,0)}function jh(t){var e=uo(t);if(gw(e))return t}function L4(t,e){if(t==="change")return e}var Kw=!1;if(Ti){var t0;if(Ti){var r0="oninput"in document;if(!r0){var kv=document.createElement("div");kv.setAttribute("oninput","return;"),r0=typeof kv.oninput=="function"}t0=r0}else t0=!1;Kw=t0&&(!document.documentMode||9<document.documentMode)}function Pv(){Hl&&(Hl.detachEvent("onpropertychange",qw),gu=Hl=null)}function qw(t){if(t.propertyName==="value"&&jh(gu)){var e=[];Gw(e,gu,t,km(t)),Cw(F4,e)}}function b4(t,e,r){t==="focusin"?(Pv(),Hl=e,gu=r,Hl.attachEvent("onpropertychange",qw)):t==="focusout"&&Pv()}function M4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jh(gu)}function V4(t,e){if(t==="click")return jh(e)}function U4(t,e){if(t==="input"||t==="change")return jh(e)}function B4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bn=typeof Object.is=="function"?Object.is:B4;function vu(t,e){if(bn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!q0.call(e,i)||!bn(t[i],e[i]))return!1}return!0}function Nv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dv(t,e){var r=Nv(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Nv(r)}}function Xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Yw(){for(var t=window,e=Pf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Pf(t.document)}return e}function Vm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function j4(t){var e=Yw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Xw(r.ownerDocument.documentElement,r)){if(n!==null&&Vm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Dv(r,s);var a=Dv(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var z4=Ti&&"documentMode"in document&&11>=document.documentMode,oo=null,dp=null,$l=null,pp=!1;function Ov(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;pp||oo==null||oo!==Pf(n)||(n=oo,"selectionStart"in n&&Vm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),$l&&vu($l,n)||($l=n,n=Mf(dp,"onSelect"),0<n.length&&(e=new Lm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=oo)))}function Fc(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var lo={animationend:Fc("Animation","AnimationEnd"),animationiteration:Fc("Animation","AnimationIteration"),animationstart:Fc("Animation","AnimationStart"),transitionend:Fc("Transition","TransitionEnd")},n0={},Qw={};Ti&&(Qw=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function zh(t){if(n0[t])return n0[t];if(!lo[t])return t;var e=lo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Qw)return n0[t]=e[r];return t}var Jw=zh("animationend"),Zw=zh("animationiteration"),eE=zh("animationstart"),tE=zh("transitionend"),rE=new Map,Fv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ns(t,e){rE.set(t,e),Sa(e,[t])}for(var i0=0;i0<Fv.length;i0++){var s0=Fv[i0],W4=s0.toLowerCase(),H4=s0[0].toUpperCase()+s0.slice(1);Ns(W4,"on"+H4)}Ns(Jw,"onAnimationEnd");Ns(Zw,"onAnimationIteration");Ns(eE,"onAnimationStart");Ns("dblclick","onDoubleClick");Ns("focusin","onFocus");Ns("focusout","onBlur");Ns(tE,"onTransitionEnd");Oo("onMouseEnter",["mouseout","mouseover"]);Oo("onMouseLeave",["mouseout","mouseover"]);Oo("onPointerEnter",["pointerout","pointerover"]);Oo("onPointerLeave",["pointerout","pointerover"]);Sa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ol));function Lv(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,WC(n,e,void 0,t),t.currentTarget=null}function nE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Lv(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Lv(i,o,u),s=l}}}if(Df)throw t=up,Df=!1,up=null,t}function dt(t,e){var r=e[yp];r===void 0&&(r=e[yp]=new Set);var n=t+"__bubble";r.has(n)||(iE(e,t,2,!1),r.add(n))}function a0(t,e,r){var n=0;e&&(n|=4),iE(r,t,n,e)}var Lc="_reactListening"+Math.random().toString(36).slice(2);function _u(t){if(!t[Lc]){t[Lc]=!0,fw.forEach(function(r){r!=="selectionchange"&&($4.has(r)||a0(r,!1,t),a0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Lc]||(e[Lc]=!0,a0("selectionchange",!1,e))}}function iE(t,e,r,n){switch(jw(e)){case 1:var i=s4;break;case 4:i=a4;break;default:i=Om}r=i.bind(null,e,r,t),i=void 0,!lp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function o0(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Zs(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Cw(function(){var u=s,f=km(r),h=[];e:{var d=rE.get(t);if(d!==void 0){var m=Lm,y=t;switch(t){case"keypress":if(hf(r)===0)break e;case"keydown":case"keyup":m=w4;break;case"focusin":y="focus",m=e0;break;case"focusout":y="blur",m=e0;break;case"beforeblur":case"afterblur":m=e0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Tv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=u4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=S4;break;case Jw:case Zw:case eE:m=h4;break;case tE:m=I4;break;case"scroll":m=o4;break;case"wheel":m=R4;break;case"copy":case"cut":case"paste":m=p4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Av}var g=(e&4)!==0,A=!g&&t==="scroll",w=g?d!==null?d+"Capture":null:d;g=[];for(var x=u,I;x!==null;){I=x;var L=I.stateNode;if(I.tag===5&&L!==null&&(I=L,w!==null&&(L=hu(x,w),L!=null&&g.push(yu(x,L,I)))),A)break;x=x.return}0<g.length&&(d=new m(d,y,null,r,f),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==ap&&(y=r.relatedTarget||r.fromElement)&&(Zs(y)||y[Si]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Zs(y):null,y!==null&&(A=Aa(y),y!==A||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(g=Tv,L="onMouseLeave",w="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=Av,L="onPointerLeave",w="onPointerEnter",x="pointer"),A=m==null?d:uo(m),I=y==null?d:uo(y),d=new g(L,x+"leave",m,r,f),d.target=A,d.relatedTarget=I,L=null,Zs(f)===u&&(g=new g(w,x+"enter",y,r,f),g.target=I,g.relatedTarget=A,L=g),A=L,m&&y)t:{for(g=m,w=y,x=0,I=g;I;I=Ka(I))x++;for(I=0,L=w;L;L=Ka(L))I++;for(;0<x-I;)g=Ka(g),x--;for(;0<I-x;)w=Ka(w),I--;for(;x--;){if(g===w||w!==null&&g===w.alternate)break t;g=Ka(g),w=Ka(w)}g=null}else g=null;m!==null&&bv(h,d,m,g,!1),y!==null&&A!==null&&bv(h,A,y,g,!0)}}e:{if(d=u?uo(u):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var W=L4;else if(Rv(d))if(Kw)W=U4;else{W=M4;var G=b4}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(W=V4);if(W&&(W=W(t,u))){Gw(h,W,r,f);break e}G&&G(t,d,u),t==="focusout"&&(G=d._wrapperState)&&G.controlled&&d.type==="number"&&tp(d,"number",d.value)}switch(G=u?uo(u):window,t){case"focusin":(Rv(G)||G.contentEditable==="true")&&(oo=G,dp=u,$l=null);break;case"focusout":$l=dp=oo=null;break;case"mousedown":pp=!0;break;case"contextmenu":case"mouseup":case"dragend":pp=!1,Ov(h,r,f);break;case"selectionchange":if(z4)break;case"keydown":case"keyup":Ov(h,r,f)}var E;if(Mm)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else ao?Hw(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(Ww&&r.locale!=="ko"&&(ao||T!=="onCompositionStart"?T==="onCompositionEnd"&&ao&&(E=zw()):(ts=f,Fm="value"in ts?ts.value:ts.textContent,ao=!0)),G=Mf(u,T),0<G.length&&(T=new Sv(T,t,null,r,f),h.push({event:T,listeners:G}),E?T.data=E:(E=$w(r),E!==null&&(T.data=E)))),(E=P4?N4(t,r):D4(t,r))&&(u=Mf(u,"onBeforeInput"),0<u.length&&(f=new Sv("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:u}),f.data=E))}nE(h,e)})}function yu(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Mf(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=hu(t,r),s!=null&&n.unshift(yu(t,s,i)),s=hu(t,e),s!=null&&n.push(yu(t,s,i))),t=t.return}return n}function Ka(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function bv(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=hu(r,s),l!=null&&a.unshift(yu(r,l,o))):i||(l=hu(r,s),l!=null&&a.push(yu(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var G4=/\r\n?/g,K4=/\u0000|\uFFFD/g;function Mv(t){return(typeof t=="string"?t:""+t).replace(G4,`
`).replace(K4,"")}function bc(t,e,r){if(e=Mv(e),Mv(t)!==e&&r)throw Error(fe(425))}function Vf(){}var mp=null,gp=null;function vp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _p=typeof setTimeout=="function"?setTimeout:void 0,q4=typeof clearTimeout=="function"?clearTimeout:void 0,Vv=typeof Promise=="function"?Promise:void 0,X4=typeof queueMicrotask=="function"?queueMicrotask:typeof Vv<"u"?function(t){return Vv.resolve(null).then(t).catch(Y4)}:_p;function Y4(t){setTimeout(function(){throw t})}function l0(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),mu(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);mu(e)}function us(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Uv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Qo=Math.random().toString(36).slice(2),qn="__reactFiber$"+Qo,xu="__reactProps$"+Qo,Si="__reactContainer$"+Qo,yp="__reactEvents$"+Qo,Q4="__reactListeners$"+Qo,J4="__reactHandles$"+Qo;function Zs(t){var e=t[qn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Si]||r[qn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Uv(t);t!==null;){if(r=t[qn])return r;t=Uv(t)}return e}t=r,r=t.parentNode}return null}function Gu(t){return t=t[qn]||t[Si],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function uo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function Wh(t){return t[xu]||null}var xp=[],co=-1;function Ds(t){return{current:t}}function pt(t){0>co||(t.current=xp[co],xp[co]=null,co--)}function ft(t,e){co++,xp[co]=t.current,t.current=e}var xs={},xr=Ds(xs),Lr=Ds(!1),ca=xs;function Fo(t,e){var r=t.type.contextTypes;if(!r)return xs;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function br(t){return t=t.childContextTypes,t!=null}function Uf(){pt(Lr),pt(xr)}function Bv(t,e,r){if(xr.current!==xs)throw Error(fe(168));ft(xr,e),ft(Lr,r)}function sE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(fe(108,bC(t)||"Unknown",i));return xt({},r,n)}function Bf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||xs,ca=xr.current,ft(xr,t),ft(Lr,Lr.current),!0}function jv(t,e,r){var n=t.stateNode;if(!n)throw Error(fe(169));r?(t=sE(t,e,ca),n.__reactInternalMemoizedMergedChildContext=t,pt(Lr),pt(xr),ft(xr,t)):pt(Lr),ft(Lr,r)}var hi=null,Hh=!1,u0=!1;function aE(t){hi===null?hi=[t]:hi.push(t)}function Z4(t){Hh=!0,aE(t)}function Os(){if(!u0&&hi!==null){u0=!0;var t=0,e=et;try{var r=hi;for(et=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}hi=null,Hh=!1}catch(i){throw hi!==null&&(hi=hi.slice(t+1)),Nw(Pm,Os),i}finally{et=e,u0=!1}}return null}var fo=[],ho=0,jf=null,zf=0,an=[],on=0,fa=null,pi=1,mi="";function Xs(t,e){fo[ho++]=zf,fo[ho++]=jf,jf=t,zf=e}function oE(t,e,r){an[on++]=pi,an[on++]=mi,an[on++]=fa,fa=t;var n=pi;t=mi;var i=32-Dn(n)-1;n&=~(1<<i),r+=1;var s=32-Dn(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,pi=1<<32-Dn(e)+i|r<<i|n,mi=s+t}else pi=1<<s|r<<i|n,mi=t}function Um(t){t.return!==null&&(Xs(t,1),oE(t,1,0))}function Bm(t){for(;t===jf;)jf=fo[--ho],fo[ho]=null,zf=fo[--ho],fo[ho]=null;for(;t===fa;)fa=an[--on],an[on]=null,mi=an[--on],an[on]=null,pi=an[--on],an[on]=null}var Yr=null,qr=null,gt=!1,Cn=null;function lE(t,e){var r=un(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function zv(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Yr=t,qr=us(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Yr=t,qr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=fa!==null?{id:pi,overflow:mi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=un(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Yr=t,qr=null,!0):!1;default:return!1}}function wp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ep(t){if(gt){var e=qr;if(e){var r=e;if(!zv(t,e)){if(wp(t))throw Error(fe(418));e=us(r.nextSibling);var n=Yr;e&&zv(t,e)?lE(n,r):(t.flags=t.flags&-4097|2,gt=!1,Yr=t)}}else{if(wp(t))throw Error(fe(418));t.flags=t.flags&-4097|2,gt=!1,Yr=t}}}function Wv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Yr=t}function Mc(t){if(t!==Yr)return!1;if(!gt)return Wv(t),gt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vp(t.type,t.memoizedProps)),e&&(e=qr)){if(wp(t))throw uE(),Error(fe(418));for(;e;)lE(t,e),e=us(e.nextSibling)}if(Wv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){qr=us(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}qr=null}}else qr=Yr?us(t.stateNode.nextSibling):null;return!0}function uE(){for(var t=qr;t;)t=us(t.nextSibling)}function Lo(){qr=Yr=null,gt=!1}function jm(t){Cn===null?Cn=[t]:Cn.push(t)}var eR=Oi.ReactCurrentBatchConfig;function Al(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(fe(309));var n=r.stateNode}if(!n)throw Error(fe(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(fe(284));if(!r._owner)throw Error(fe(290,t))}return t}function Vc(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Hv(t){var e=t._init;return e(t._payload)}function cE(t){function e(w,x){if(t){var I=w.deletions;I===null?(w.deletions=[x],w.flags|=16):I.push(x)}}function r(w,x){if(!t)return null;for(;x!==null;)e(w,x),x=x.sibling;return null}function n(w,x){for(w=new Map;x!==null;)x.key!==null?w.set(x.key,x):w.set(x.index,x),x=x.sibling;return w}function i(w,x){return w=ds(w,x),w.index=0,w.sibling=null,w}function s(w,x,I){return w.index=I,t?(I=w.alternate,I!==null?(I=I.index,I<x?(w.flags|=2,x):I):(w.flags|=2,x)):(w.flags|=1048576,x)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function o(w,x,I,L){return x===null||x.tag!==6?(x=g0(I,w.mode,L),x.return=w,x):(x=i(x,I),x.return=w,x)}function l(w,x,I,L){var W=I.type;return W===so?f(w,x,I.props.children,L,I.key):x!==null&&(x.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===qi&&Hv(W)===x.type)?(L=i(x,I.props),L.ref=Al(w,x,I),L.return=w,L):(L=yf(I.type,I.key,I.props,null,w.mode,L),L.ref=Al(w,x,I),L.return=w,L)}function u(w,x,I,L){return x===null||x.tag!==4||x.stateNode.containerInfo!==I.containerInfo||x.stateNode.implementation!==I.implementation?(x=v0(I,w.mode,L),x.return=w,x):(x=i(x,I.children||[]),x.return=w,x)}function f(w,x,I,L,W){return x===null||x.tag!==7?(x=aa(I,w.mode,L,W),x.return=w,x):(x=i(x,I),x.return=w,x)}function h(w,x,I){if(typeof x=="string"&&x!==""||typeof x=="number")return x=g0(""+x,w.mode,I),x.return=w,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Cc:return I=yf(x.type,x.key,x.props,null,w.mode,I),I.ref=Al(w,null,x),I.return=w,I;case io:return x=v0(x,w.mode,I),x.return=w,x;case qi:var L=x._init;return h(w,L(x._payload),I)}if(Nl(x)||xl(x))return x=aa(x,w.mode,I,null),x.return=w,x;Vc(w,x)}return null}function d(w,x,I,L){var W=x!==null?x.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return W!==null?null:o(w,x,""+I,L);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Cc:return I.key===W?l(w,x,I,L):null;case io:return I.key===W?u(w,x,I,L):null;case qi:return W=I._init,d(w,x,W(I._payload),L)}if(Nl(I)||xl(I))return W!==null?null:f(w,x,I,L,null);Vc(w,I)}return null}function m(w,x,I,L,W){if(typeof L=="string"&&L!==""||typeof L=="number")return w=w.get(I)||null,o(x,w,""+L,W);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Cc:return w=w.get(L.key===null?I:L.key)||null,l(x,w,L,W);case io:return w=w.get(L.key===null?I:L.key)||null,u(x,w,L,W);case qi:var G=L._init;return m(w,x,I,G(L._payload),W)}if(Nl(L)||xl(L))return w=w.get(I)||null,f(x,w,L,W,null);Vc(x,L)}return null}function y(w,x,I,L){for(var W=null,G=null,E=x,T=x=0,S=null;E!==null&&T<I.length;T++){E.index>T?(S=E,E=null):S=E.sibling;var R=d(w,E,I[T],L);if(R===null){E===null&&(E=S);break}t&&E&&R.alternate===null&&e(w,E),x=s(R,x,T),G===null?W=R:G.sibling=R,G=R,E=S}if(T===I.length)return r(w,E),gt&&Xs(w,T),W;if(E===null){for(;T<I.length;T++)E=h(w,I[T],L),E!==null&&(x=s(E,x,T),G===null?W=E:G.sibling=E,G=E);return gt&&Xs(w,T),W}for(E=n(w,E);T<I.length;T++)S=m(E,w,T,I[T],L),S!==null&&(t&&S.alternate!==null&&E.delete(S.key===null?T:S.key),x=s(S,x,T),G===null?W=S:G.sibling=S,G=S);return t&&E.forEach(function(N){return e(w,N)}),gt&&Xs(w,T),W}function g(w,x,I,L){var W=xl(I);if(typeof W!="function")throw Error(fe(150));if(I=W.call(I),I==null)throw Error(fe(151));for(var G=W=null,E=x,T=x=0,S=null,R=I.next();E!==null&&!R.done;T++,R=I.next()){E.index>T?(S=E,E=null):S=E.sibling;var N=d(w,E,R.value,L);if(N===null){E===null&&(E=S);break}t&&E&&N.alternate===null&&e(w,E),x=s(N,x,T),G===null?W=N:G.sibling=N,G=N,E=S}if(R.done)return r(w,E),gt&&Xs(w,T),W;if(E===null){for(;!R.done;T++,R=I.next())R=h(w,R.value,L),R!==null&&(x=s(R,x,T),G===null?W=R:G.sibling=R,G=R);return gt&&Xs(w,T),W}for(E=n(w,E);!R.done;T++,R=I.next())R=m(E,w,T,R.value,L),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?T:R.key),x=s(R,x,T),G===null?W=R:G.sibling=R,G=R);return t&&E.forEach(function(M){return e(w,M)}),gt&&Xs(w,T),W}function A(w,x,I,L){if(typeof I=="object"&&I!==null&&I.type===so&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Cc:e:{for(var W=I.key,G=x;G!==null;){if(G.key===W){if(W=I.type,W===so){if(G.tag===7){r(w,G.sibling),x=i(G,I.props.children),x.return=w,w=x;break e}}else if(G.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===qi&&Hv(W)===G.type){r(w,G.sibling),x=i(G,I.props),x.ref=Al(w,G,I),x.return=w,w=x;break e}r(w,G);break}else e(w,G);G=G.sibling}I.type===so?(x=aa(I.props.children,w.mode,L,I.key),x.return=w,w=x):(L=yf(I.type,I.key,I.props,null,w.mode,L),L.ref=Al(w,x,I),L.return=w,w=L)}return a(w);case io:e:{for(G=I.key;x!==null;){if(x.key===G)if(x.tag===4&&x.stateNode.containerInfo===I.containerInfo&&x.stateNode.implementation===I.implementation){r(w,x.sibling),x=i(x,I.children||[]),x.return=w,w=x;break e}else{r(w,x);break}else e(w,x);x=x.sibling}x=v0(I,w.mode,L),x.return=w,w=x}return a(w);case qi:return G=I._init,A(w,x,G(I._payload),L)}if(Nl(I))return y(w,x,I,L);if(xl(I))return g(w,x,I,L);Vc(w,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,x!==null&&x.tag===6?(r(w,x.sibling),x=i(x,I),x.return=w,w=x):(r(w,x),x=g0(I,w.mode,L),x.return=w,w=x),a(w)):r(w,x)}return A}var bo=cE(!0),fE=cE(!1),Wf=Ds(null),Hf=null,po=null,zm=null;function Wm(){zm=po=Hf=null}function Hm(t){var e=Wf.current;pt(Wf),t._currentValue=e}function Tp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Eo(t,e){Hf=t,zm=po=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Fr=!0),t.firstContext=null)}function fn(t){var e=t._currentValue;if(zm!==t)if(t={context:t,memoizedValue:e,next:null},po===null){if(Hf===null)throw Error(fe(308));po=t,Hf.dependencies={lanes:0,firstContext:t}}else po=po.next=t;return e}var ea=null;function $m(t){ea===null?ea=[t]:ea.push(t)}function hE(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,$m(e)):(r.next=i.next,i.next=r),e.interleaved=r,Ai(t,n)}function Ai(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Xi=!1;function Gm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _i(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function cs(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,He&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Ai(t,r)}return i=n.interleaved,i===null?(e.next=e,$m(n)):(e.next=i.next,i.next=e),n.interleaved=e,Ai(t,r)}function df(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Nm(t,r)}}function $v(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function $f(t,e,r,n){var i=t.updateQueue;Xi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,f=u=l=null,o=s;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,g=o;switch(d=e,m=r,g.tag){case 1:if(y=g.payload,typeof y=="function"){h=y.call(m,h,d);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,d=typeof y=="function"?y.call(m,h,d):y,d==null)break e;h=xt({},h,d);break e;case 2:Xi=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=h):f=f.next=m,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);da|=a,t.lanes=a,t.memoizedState=h}}function Gv(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(fe(191,i));i.call(n)}}}var Ku={},Yn=Ds(Ku),wu=Ds(Ku),Eu=Ds(Ku);function ta(t){if(t===Ku)throw Error(fe(174));return t}function Km(t,e){switch(ft(Eu,e),ft(wu,t),ft(Yn,Ku),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:np(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=np(e,t)}pt(Yn),ft(Yn,e)}function Mo(){pt(Yn),pt(wu),pt(Eu)}function pE(t){ta(Eu.current);var e=ta(Yn.current),r=np(e,t.type);e!==r&&(ft(wu,t),ft(Yn,r))}function qm(t){wu.current===t&&(pt(Yn),pt(wu))}var _t=Ds(0);function Gf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var c0=[];function Xm(){for(var t=0;t<c0.length;t++)c0[t]._workInProgressVersionPrimary=null;c0.length=0}var pf=Oi.ReactCurrentDispatcher,f0=Oi.ReactCurrentBatchConfig,ha=0,yt=null,zt=null,qt=null,Kf=!1,Gl=!1,Tu=0,tR=0;function hr(){throw Error(fe(321))}function Ym(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!bn(t[r],e[r]))return!1;return!0}function Qm(t,e,r,n,i,s){if(ha=s,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,pf.current=t===null||t.memoizedState===null?sR:aR,t=r(n,i),Gl){s=0;do{if(Gl=!1,Tu=0,25<=s)throw Error(fe(301));s+=1,qt=zt=null,e.updateQueue=null,pf.current=oR,t=r(n,i)}while(Gl)}if(pf.current=qf,e=zt!==null&&zt.next!==null,ha=0,qt=zt=yt=null,Kf=!1,e)throw Error(fe(300));return t}function Jm(){var t=Tu!==0;return Tu=0,t}function Gn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?yt.memoizedState=qt=t:qt=qt.next=t,qt}function hn(){if(zt===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=zt.next;var e=qt===null?yt.memoizedState:qt.next;if(e!==null)qt=e,zt=t;else{if(t===null)throw Error(fe(310));zt=t,t={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},qt===null?yt.memoizedState=qt=t:qt=qt.next=t}return qt}function Su(t,e){return typeof e=="function"?e(t):e}function h0(t){var e=hn(),r=e.queue;if(r===null)throw Error(fe(311));r.lastRenderedReducer=t;var n=zt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((ha&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,yt.lanes|=f,da|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,bn(n,e.memoizedState)||(Fr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,yt.lanes|=s,da|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function d0(t){var e=hn(),r=e.queue;if(r===null)throw Error(fe(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);bn(s,e.memoizedState)||(Fr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function mE(){}function gE(t,e){var r=yt,n=hn(),i=e(),s=!bn(n.memoizedState,i);if(s&&(n.memoizedState=i,Fr=!0),n=n.queue,Zm(yE.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||qt!==null&&qt.memoizedState.tag&1){if(r.flags|=2048,Au(9,_E.bind(null,r,n,i,e),void 0,null),Jt===null)throw Error(fe(349));ha&30||vE(r,e,i)}return i}function vE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function _E(t,e,r,n){e.value=r,e.getSnapshot=n,xE(e)&&wE(t)}function yE(t,e,r){return r(function(){xE(e)&&wE(t)})}function xE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!bn(t,r)}catch{return!0}}function wE(t){var e=Ai(t,1);e!==null&&On(e,t,1,-1)}function Kv(t){var e=Gn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Su,lastRenderedState:t},e.queue=t,t=t.dispatch=iR.bind(null,yt,t),[e.memoizedState,t]}function Au(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function EE(){return hn().memoizedState}function mf(t,e,r,n){var i=Gn();yt.flags|=t,i.memoizedState=Au(1|e,r,void 0,n===void 0?null:n)}function $h(t,e,r,n){var i=hn();n=n===void 0?null:n;var s=void 0;if(zt!==null){var a=zt.memoizedState;if(s=a.destroy,n!==null&&Ym(n,a.deps)){i.memoizedState=Au(e,r,s,n);return}}yt.flags|=t,i.memoizedState=Au(1|e,r,s,n)}function qv(t,e){return mf(8390656,8,t,e)}function Zm(t,e){return $h(2048,8,t,e)}function TE(t,e){return $h(4,2,t,e)}function SE(t,e){return $h(4,4,t,e)}function AE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function IE(t,e,r){return r=r!=null?r.concat([t]):null,$h(4,4,AE.bind(null,e,t),r)}function eg(){}function CE(t,e){var r=hn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Ym(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function RE(t,e){var r=hn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Ym(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function kE(t,e,r){return ha&21?(bn(r,e)||(r=Fw(),yt.lanes|=r,da|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Fr=!0),t.memoizedState=r)}function rR(t,e){var r=et;et=r!==0&&4>r?r:4,t(!0);var n=f0.transition;f0.transition={};try{t(!1),e()}finally{et=r,f0.transition=n}}function PE(){return hn().memoizedState}function nR(t,e,r){var n=hs(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},NE(t))DE(e,r);else if(r=hE(t,e,r,n),r!==null){var i=Ar();On(r,t,n,i),OE(r,e,n)}}function iR(t,e,r){var n=hs(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(NE(t))DE(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,bn(o,a)){var l=e.interleaved;l===null?(i.next=i,$m(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=hE(t,e,i,n),r!==null&&(i=Ar(),On(r,t,n,i),OE(r,e,n))}}function NE(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function DE(t,e){Gl=Kf=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function OE(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Nm(t,r)}}var qf={readContext:fn,useCallback:hr,useContext:hr,useEffect:hr,useImperativeHandle:hr,useInsertionEffect:hr,useLayoutEffect:hr,useMemo:hr,useReducer:hr,useRef:hr,useState:hr,useDebugValue:hr,useDeferredValue:hr,useTransition:hr,useMutableSource:hr,useSyncExternalStore:hr,useId:hr,unstable_isNewReconciler:!1},sR={readContext:fn,useCallback:function(t,e){return Gn().memoizedState=[t,e===void 0?null:e],t},useContext:fn,useEffect:qv,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,mf(4194308,4,AE.bind(null,e,t),r)},useLayoutEffect:function(t,e){return mf(4194308,4,t,e)},useInsertionEffect:function(t,e){return mf(4,2,t,e)},useMemo:function(t,e){var r=Gn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Gn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=nR.bind(null,yt,t),[n.memoizedState,t]},useRef:function(t){var e=Gn();return t={current:t},e.memoizedState=t},useState:Kv,useDebugValue:eg,useDeferredValue:function(t){return Gn().memoizedState=t},useTransition:function(){var t=Kv(!1),e=t[0];return t=rR.bind(null,t[1]),Gn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=yt,i=Gn();if(gt){if(r===void 0)throw Error(fe(407));r=r()}else{if(r=e(),Jt===null)throw Error(fe(349));ha&30||vE(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,qv(yE.bind(null,n,s,t),[t]),n.flags|=2048,Au(9,_E.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Gn(),e=Jt.identifierPrefix;if(gt){var r=mi,n=pi;r=(n&~(1<<32-Dn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Tu++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=tR++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},aR={readContext:fn,useCallback:CE,useContext:fn,useEffect:Zm,useImperativeHandle:IE,useInsertionEffect:TE,useLayoutEffect:SE,useMemo:RE,useReducer:h0,useRef:EE,useState:function(){return h0(Su)},useDebugValue:eg,useDeferredValue:function(t){var e=hn();return kE(e,zt.memoizedState,t)},useTransition:function(){var t=h0(Su)[0],e=hn().memoizedState;return[t,e]},useMutableSource:mE,useSyncExternalStore:gE,useId:PE,unstable_isNewReconciler:!1},oR={readContext:fn,useCallback:CE,useContext:fn,useEffect:Zm,useImperativeHandle:IE,useInsertionEffect:TE,useLayoutEffect:SE,useMemo:RE,useReducer:d0,useRef:EE,useState:function(){return d0(Su)},useDebugValue:eg,useDeferredValue:function(t){var e=hn();return zt===null?e.memoizedState=t:kE(e,zt.memoizedState,t)},useTransition:function(){var t=d0(Su)[0],e=hn().memoizedState;return[t,e]},useMutableSource:mE,useSyncExternalStore:gE,useId:PE,unstable_isNewReconciler:!1};function An(t,e){if(t&&t.defaultProps){e=xt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Sp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:xt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Gh={isMounted:function(t){return(t=t._reactInternals)?Aa(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ar(),i=hs(t),s=_i(n,i);s.payload=e,r!=null&&(s.callback=r),e=cs(t,s,i),e!==null&&(On(e,t,i,n),df(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ar(),i=hs(t),s=_i(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=cs(t,s,i),e!==null&&(On(e,t,i,n),df(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ar(),n=hs(t),i=_i(r,n);i.tag=2,e!=null&&(i.callback=e),e=cs(t,i,n),e!==null&&(On(e,t,n,r),df(e,t,n))}};function Xv(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!vu(r,n)||!vu(i,s):!0}function FE(t,e,r){var n=!1,i=xs,s=e.contextType;return typeof s=="object"&&s!==null?s=fn(s):(i=br(e)?ca:xr.current,n=e.contextTypes,s=(n=n!=null)?Fo(t,i):xs),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gh,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Yv(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Gh.enqueueReplaceState(e,e.state,null)}function Ap(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Gm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=fn(s):(s=br(e)?ca:xr.current,i.context=Fo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Sp(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Gh.enqueueReplaceState(i,i.state,null),$f(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Vo(t,e){try{var r="",n=e;do r+=LC(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function p0(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Ip(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var lR=typeof WeakMap=="function"?WeakMap:Map;function LE(t,e,r){r=_i(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Yf||(Yf=!0,bp=n),Ip(t,e)},r}function bE(t,e,r){r=_i(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Ip(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ip(t,e),typeof n!="function"&&(fs===null?fs=new Set([this]):fs.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function Qv(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new lR;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=ER.bind(null,t,e,r),e.then(t,t))}function Jv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zv(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=_i(-1,1),e.tag=2,cs(r,e,1))),r.lanes|=1),t)}var uR=Oi.ReactCurrentOwner,Fr=!1;function Er(t,e,r,n){e.child=t===null?fE(e,null,r,n):bo(e,t.child,r,n)}function e_(t,e,r,n,i){r=r.render;var s=e.ref;return Eo(e,i),n=Qm(t,e,r,n,s,i),r=Jm(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ii(t,e,i)):(gt&&r&&Um(e),e.flags|=1,Er(t,e,n,i),e.child)}function t_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!lg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,ME(t,e,s,n,i)):(t=yf(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:vu,r(a,n)&&t.ref===e.ref)return Ii(t,e,i)}return e.flags|=1,t=ds(s,n),t.ref=e.ref,t.return=e,e.child=t}function ME(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(vu(s,n)&&t.ref===e.ref)if(Fr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Fr=!0);else return e.lanes=t.lanes,Ii(t,e,i)}return Cp(t,e,r,n,i)}function VE(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(go,Hr),Hr|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ft(go,Hr),Hr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ft(go,Hr),Hr|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ft(go,Hr),Hr|=n;return Er(t,e,i,r),e.child}function UE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Cp(t,e,r,n,i){var s=br(r)?ca:xr.current;return s=Fo(e,s),Eo(e,i),r=Qm(t,e,r,n,s,i),n=Jm(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ii(t,e,i)):(gt&&n&&Um(e),e.flags|=1,Er(t,e,r,i),e.child)}function r_(t,e,r,n,i){if(br(r)){var s=!0;Bf(e)}else s=!1;if(Eo(e,i),e.stateNode===null)gf(t,e),FE(e,r,n),Ap(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=fn(u):(u=br(r)?ca:xr.current,u=Fo(e,u));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&Yv(e,a,n,u),Xi=!1;var d=e.memoizedState;a.state=d,$f(e,n,a,i),l=e.memoizedState,o!==n||d!==l||Lr.current||Xi?(typeof f=="function"&&(Sp(e,r,f,n),l=e.memoizedState),(o=Xi||Xv(e,r,o,n,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,dE(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:An(e.type,o),a.props=u,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=fn(l):(l=br(r)?ca:xr.current,l=Fo(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Yv(e,a,n,l),Xi=!1,d=e.memoizedState,a.state=d,$f(e,n,a,i);var y=e.memoizedState;o!==h||d!==y||Lr.current||Xi?(typeof m=="function"&&(Sp(e,r,m,n),y=e.memoizedState),(u=Xi||Xv(e,r,u,n,d,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Rp(t,e,r,n,s,i)}function Rp(t,e,r,n,i,s){UE(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&jv(e,r,!1),Ii(t,e,s);n=e.stateNode,uR.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=bo(e,t.child,null,s),e.child=bo(e,null,o,s)):Er(t,e,o,s),e.memoizedState=n.state,i&&jv(e,r,!0),e.child}function BE(t){var e=t.stateNode;e.pendingContext?Bv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Bv(t,e.context,!1),Km(t,e.containerInfo)}function n_(t,e,r,n,i){return Lo(),jm(i),e.flags|=256,Er(t,e,r,n),e.child}var kp={dehydrated:null,treeContext:null,retryLane:0};function Pp(t){return{baseLanes:t,cachePool:null,transitions:null}}function jE(t,e,r){var n=e.pendingProps,i=_t.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ft(_t,i&1),t===null)return Ep(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Xh(a,n,0,null),t=aa(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Pp(r),e.memoizedState=kp,t):tg(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return cR(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ds(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=ds(o,s):(s=aa(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Pp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=kp,n}return s=t.child,t=s.sibling,n=ds(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function tg(t,e){return e=Xh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Uc(t,e,r,n){return n!==null&&jm(n),bo(e,t.child,null,r),t=tg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cR(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=p0(Error(fe(422))),Uc(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Xh({mode:"visible",children:n.children},i,0,null),s=aa(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&bo(e,t.child,null,a),e.child.memoizedState=Pp(a),e.memoizedState=kp,s);if(!(e.mode&1))return Uc(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(fe(419)),n=p0(s,n,void 0),Uc(t,e,a,n)}if(o=(a&t.childLanes)!==0,Fr||o){if(n=Jt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ai(t,i),On(n,t,i,-1))}return og(),n=p0(Error(fe(421))),Uc(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=TR.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,qr=us(i.nextSibling),Yr=e,gt=!0,Cn=null,t!==null&&(an[on++]=pi,an[on++]=mi,an[on++]=fa,pi=t.id,mi=t.overflow,fa=e),e=tg(e,n.children),e.flags|=4096,e)}function i_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Tp(t.return,e,r)}function m0(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function zE(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Er(t,e,n.children,r),n=_t.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&i_(t,r,e);else if(t.tag===19)i_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ft(_t,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Gf(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),m0(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Gf(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}m0(e,!0,r,null,s);break;case"together":m0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ii(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),da|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,r=ds(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ds(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function fR(t,e,r){switch(e.tag){case 3:BE(e),Lo();break;case 5:pE(e);break;case 1:br(e.type)&&Bf(e);break;case 4:Km(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ft(Wf,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ft(_t,_t.current&1),e.flags|=128,null):r&e.child.childLanes?jE(t,e,r):(ft(_t,_t.current&1),t=Ii(t,e,r),t!==null?t.sibling:null);ft(_t,_t.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return zE(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ft(_t,_t.current),n)break;return null;case 22:case 23:return e.lanes=0,VE(t,e,r)}return Ii(t,e,r)}var WE,Np,HE,$E;WE=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Np=function(){};HE=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,ta(Yn.current);var s=null;switch(r){case"input":i=Z0(t,i),n=Z0(t,n),s=[];break;case"select":i=xt({},i,{value:void 0}),n=xt({},n,{value:void 0}),s=[];break;case"textarea":i=rp(t,i),n=rp(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Vf)}ip(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(cu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(cu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&dt("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};$E=function(t,e,r,n){r!==n&&(e.flags|=4)};function Il(t,e){if(!gt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function dr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function hR(t,e,r){var n=e.pendingProps;switch(Bm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(e),null;case 1:return br(e.type)&&Uf(),dr(e),null;case 3:return n=e.stateNode,Mo(),pt(Lr),pt(xr),Xm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Mc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Cn!==null&&(Up(Cn),Cn=null))),Np(t,e),dr(e),null;case 5:qm(e);var i=ta(Eu.current);if(r=e.type,t!==null&&e.stateNode!=null)HE(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(fe(166));return dr(e),null}if(t=ta(Yn.current),Mc(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[qn]=e,n[xu]=s,t=(e.mode&1)!==0,r){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(i=0;i<Ol.length;i++)dt(Ol[i],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":dv(n,s),dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},dt("invalid",n);break;case"textarea":mv(n,s),dt("invalid",n)}ip(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&bc(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&bc(n.textContent,o,t),i=["children",""+o]):cu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&dt("scroll",n)}switch(r){case"input":Rc(n),pv(n,s,!0);break;case"textarea":Rc(n),gv(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Vf)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[qn]=e,t[xu]=n,WE(t,e,!1,!1),e.stateNode=t;e:{switch(a=sp(r,n),r){case"dialog":dt("cancel",t),dt("close",t),i=n;break;case"iframe":case"object":case"embed":dt("load",t),i=n;break;case"video":case"audio":for(i=0;i<Ol.length;i++)dt(Ol[i],t);i=n;break;case"source":dt("error",t),i=n;break;case"img":case"image":case"link":dt("error",t),dt("load",t),i=n;break;case"details":dt("toggle",t),i=n;break;case"input":dv(t,n),i=Z0(t,n),dt("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=xt({},n,{value:void 0}),dt("invalid",t);break;case"textarea":mv(t,n),i=rp(t,n),dt("invalid",t);break;default:i=n}ip(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Ew(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xw(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&fu(t,l):typeof l=="number"&&fu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&dt("scroll",t):l!=null&&Am(t,s,l,a))}switch(r){case"input":Rc(t),pv(t,n,!1);break;case"textarea":Rc(t),gv(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ys(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?_o(t,!!n.multiple,s,!1):n.defaultValue!=null&&_o(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Vf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dr(e),null;case 6:if(t&&e.stateNode!=null)$E(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(fe(166));if(r=ta(Eu.current),ta(Yn.current),Mc(e)){if(n=e.stateNode,r=e.memoizedProps,n[qn]=e,(s=n.nodeValue!==r)&&(t=Yr,t!==null))switch(t.tag){case 3:bc(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bc(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qn]=e,e.stateNode=n}return dr(e),null;case 13:if(pt(_t),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gt&&qr!==null&&e.mode&1&&!(e.flags&128))uE(),Lo(),e.flags|=98560,s=!1;else if(s=Mc(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(fe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(fe(317));s[qn]=e}else Lo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dr(e),s=!1}else Cn!==null&&(Up(Cn),Cn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||_t.current&1?Wt===0&&(Wt=3):og())),e.updateQueue!==null&&(e.flags|=4),dr(e),null);case 4:return Mo(),Np(t,e),t===null&&_u(e.stateNode.containerInfo),dr(e),null;case 10:return Hm(e.type._context),dr(e),null;case 17:return br(e.type)&&Uf(),dr(e),null;case 19:if(pt(_t),s=e.memoizedState,s===null)return dr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Il(s,!1);else{if(Wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Gf(t),a!==null){for(e.flags|=128,Il(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ft(_t,_t.current&1|2),e.child}t=t.sibling}s.tail!==null&&kt()>Uo&&(e.flags|=128,n=!0,Il(s,!1),e.lanes=4194304)}else{if(!n)if(t=Gf(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Il(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!gt)return dr(e),null}else 2*kt()-s.renderingStartTime>Uo&&r!==1073741824&&(e.flags|=128,n=!0,Il(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=kt(),e.sibling=null,r=_t.current,ft(_t,n?r&1|2:r&1),e):(dr(e),null);case 22:case 23:return ag(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Hr&1073741824&&(dr(e),e.subtreeFlags&6&&(e.flags|=8192)):dr(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function dR(t,e){switch(Bm(e),e.tag){case 1:return br(e.type)&&Uf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mo(),pt(Lr),pt(xr),Xm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qm(e),null;case 13:if(pt(_t),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));Lo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(_t),null;case 4:return Mo(),null;case 10:return Hm(e.type._context),null;case 22:case 23:return ag(),null;case 24:return null;default:return null}}var Bc=!1,gr=!1,pR=typeof WeakSet=="function"?WeakSet:Set,Se=null;function mo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Tt(t,e,n)}else r.current=null}function Dp(t,e,r){try{r()}catch(n){Tt(t,e,n)}}var s_=!1;function mR(t,e){if(mp=Lf,t=Yw(),Vm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++u===i&&(o=a),d===s&&++f===n&&(l=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(gp={focusedElem:t,selectionRange:r},Lf=!1,Se=e;Se!==null;)if(e=Se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Se=t;else for(;Se!==null;){e=Se;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,A=y.memoizedState,w=e.stateNode,x=w.getSnapshotBeforeUpdate(e.elementType===e.type?g:An(e.type,g),A);w.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(L){Tt(e,e.return,L)}if(t=e.sibling,t!==null){t.return=e.return,Se=t;break}Se=e.return}return y=s_,s_=!1,y}function Kl(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Dp(e,r,s)}i=i.next}while(i!==n)}}function Kh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Op(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function GE(t){var e=t.alternate;e!==null&&(t.alternate=null,GE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qn],delete e[xu],delete e[yp],delete e[Q4],delete e[J4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function KE(t){return t.tag===5||t.tag===3||t.tag===4}function a_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||KE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Vf));else if(n!==4&&(t=t.child,t!==null))for(Fp(t,e,r),t=t.sibling;t!==null;)Fp(t,e,r),t=t.sibling}function Lp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Lp(t,e,r),t=t.sibling;t!==null;)Lp(t,e,r),t=t.sibling}var tr=null,In=!1;function $i(t,e,r){for(r=r.child;r!==null;)qE(t,e,r),r=r.sibling}function qE(t,e,r){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(Uh,r)}catch{}switch(r.tag){case 5:gr||mo(r,e);case 6:var n=tr,i=In;tr=null,$i(t,e,r),tr=n,In=i,tr!==null&&(In?(t=tr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):tr.removeChild(r.stateNode));break;case 18:tr!==null&&(In?(t=tr,r=r.stateNode,t.nodeType===8?l0(t.parentNode,r):t.nodeType===1&&l0(t,r),mu(t)):l0(tr,r.stateNode));break;case 4:n=tr,i=In,tr=r.stateNode.containerInfo,In=!0,$i(t,e,r),tr=n,In=i;break;case 0:case 11:case 14:case 15:if(!gr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Dp(r,e,a),i=i.next}while(i!==n)}$i(t,e,r);break;case 1:if(!gr&&(mo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Tt(r,e,o)}$i(t,e,r);break;case 21:$i(t,e,r);break;case 22:r.mode&1?(gr=(n=gr)||r.memoizedState!==null,$i(t,e,r),gr=n):$i(t,e,r);break;default:$i(t,e,r)}}function o_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new pR),e.forEach(function(n){var i=SR.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function xn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:tr=o.stateNode,In=!1;break e;case 3:tr=o.stateNode.containerInfo,In=!0;break e;case 4:tr=o.stateNode.containerInfo,In=!0;break e}o=o.return}if(tr===null)throw Error(fe(160));qE(s,a,i),tr=null,In=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Tt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)XE(e,t),e=e.sibling}function XE(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xn(e,t),Wn(t),n&4){try{Kl(3,t,t.return),Kh(3,t)}catch(g){Tt(t,t.return,g)}try{Kl(5,t,t.return)}catch(g){Tt(t,t.return,g)}}break;case 1:xn(e,t),Wn(t),n&512&&r!==null&&mo(r,r.return);break;case 5:if(xn(e,t),Wn(t),n&512&&r!==null&&mo(r,r.return),t.flags&32){var i=t.stateNode;try{fu(i,"")}catch(g){Tt(t,t.return,g)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&vw(i,s),sp(o,a);var u=sp(o,s);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?Ew(i,h):f==="dangerouslySetInnerHTML"?xw(i,h):f==="children"?fu(i,h):Am(i,f,h,u)}switch(o){case"input":ep(i,s);break;case"textarea":_w(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?_o(i,!!s.multiple,m,!1):d!==!!s.multiple&&(s.defaultValue!=null?_o(i,!!s.multiple,s.defaultValue,!0):_o(i,!!s.multiple,s.multiple?[]:"",!1))}i[xu]=s}catch(g){Tt(t,t.return,g)}}break;case 6:if(xn(e,t),Wn(t),n&4){if(t.stateNode===null)throw Error(fe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Tt(t,t.return,g)}}break;case 3:if(xn(e,t),Wn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{mu(e.containerInfo)}catch(g){Tt(t,t.return,g)}break;case 4:xn(e,t),Wn(t);break;case 13:xn(e,t),Wn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ig=kt())),n&4&&o_(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(gr=(u=gr)||f,xn(e,t),gr=u):xn(e,t),Wn(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Se=t,f=t.child;f!==null;){for(h=Se=f;Se!==null;){switch(d=Se,m=d.child,d.tag){case 0:case 11:case 14:case 15:Kl(4,d,d.return);break;case 1:mo(d,d.return);var y=d.stateNode;if(typeof y.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(g){Tt(n,r,g)}}break;case 5:mo(d,d.return);break;case 22:if(d.memoizedState!==null){u_(h);continue}}m!==null?(m.return=d,Se=m):u_(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ww("display",a))}catch(g){Tt(t,t.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Tt(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:xn(e,t),Wn(t),n&4&&o_(t);break;case 21:break;default:xn(e,t),Wn(t)}}function Wn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(KE(r)){var n=r;break e}r=r.return}throw Error(fe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(fu(i,""),n.flags&=-33);var s=a_(t);Lp(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=a_(t);Fp(t,o,a);break;default:throw Error(fe(161))}}catch(l){Tt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gR(t,e,r){Se=t,YE(t)}function YE(t,e,r){for(var n=(t.mode&1)!==0;Se!==null;){var i=Se,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Bc;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||gr;o=Bc;var u=gr;if(Bc=a,(gr=l)&&!u)for(Se=i;Se!==null;)a=Se,l=a.child,a.tag===22&&a.memoizedState!==null?c_(i):l!==null?(l.return=a,Se=l):c_(i);for(;s!==null;)Se=s,YE(s),s=s.sibling;Se=i,Bc=o,gr=u}l_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Se=s):l_(t)}}function l_(t){for(;Se!==null;){var e=Se;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gr||Kh(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!gr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:An(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Gv(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Gv(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&mu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}gr||e.flags&512&&Op(e)}catch(d){Tt(e,e.return,d)}}if(e===t){Se=null;break}if(r=e.sibling,r!==null){r.return=e.return,Se=r;break}Se=e.return}}function u_(t){for(;Se!==null;){var e=Se;if(e===t){Se=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Se=r;break}Se=e.return}}function c_(t){for(;Se!==null;){var e=Se;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Kh(4,e)}catch(l){Tt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Tt(e,i,l)}}var s=e.return;try{Op(e)}catch(l){Tt(e,s,l)}break;case 5:var a=e.return;try{Op(e)}catch(l){Tt(e,a,l)}}}catch(l){Tt(e,e.return,l)}if(e===t){Se=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Se=o;break}Se=e.return}}var vR=Math.ceil,Xf=Oi.ReactCurrentDispatcher,rg=Oi.ReactCurrentOwner,cn=Oi.ReactCurrentBatchConfig,He=0,Jt=null,Ft=null,or=0,Hr=0,go=Ds(0),Wt=0,Iu=null,da=0,qh=0,ng=0,ql=null,Nr=null,ig=0,Uo=1/0,fi=null,Yf=!1,bp=null,fs=null,jc=!1,rs=null,Qf=0,Xl=0,Mp=null,vf=-1,_f=0;function Ar(){return He&6?kt():vf!==-1?vf:vf=kt()}function hs(t){return t.mode&1?He&2&&or!==0?or&-or:eR.transition!==null?(_f===0&&(_f=Fw()),_f):(t=et,t!==0||(t=window.event,t=t===void 0?16:jw(t.type)),t):1}function On(t,e,r,n){if(50<Xl)throw Xl=0,Mp=null,Error(fe(185));Hu(t,r,n),(!(He&2)||t!==Jt)&&(t===Jt&&(!(He&2)&&(qh|=r),Wt===4&&Qi(t,or)),Mr(t,n),r===1&&He===0&&!(e.mode&1)&&(Uo=kt()+500,Hh&&Os()))}function Mr(t,e){var r=t.callbackNode;e4(t,e);var n=Ff(t,t===Jt?or:0);if(n===0)r!==null&&yv(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&yv(r),e===1)t.tag===0?Z4(f_.bind(null,t)):aE(f_.bind(null,t)),X4(function(){!(He&6)&&Os()}),r=null;else{switch(Lw(n)){case 1:r=Pm;break;case 4:r=Dw;break;case 16:r=Of;break;case 536870912:r=Ow;break;default:r=Of}r=iT(r,QE.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function QE(t,e){if(vf=-1,_f=0,He&6)throw Error(fe(327));var r=t.callbackNode;if(To()&&t.callbackNode!==r)return null;var n=Ff(t,t===Jt?or:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Jf(t,n);else{e=n;var i=He;He|=2;var s=ZE();(Jt!==t||or!==e)&&(fi=null,Uo=kt()+500,sa(t,e));do try{xR();break}catch(o){JE(t,o)}while(!0);Wm(),Xf.current=s,He=i,Ft!==null?e=0:(Jt=null,or=0,e=Wt)}if(e!==0){if(e===2&&(i=cp(t),i!==0&&(n=i,e=Vp(t,i))),e===1)throw r=Iu,sa(t,0),Qi(t,n),Mr(t,kt()),r;if(e===6)Qi(t,n);else{if(i=t.current.alternate,!(n&30)&&!_R(i)&&(e=Jf(t,n),e===2&&(s=cp(t),s!==0&&(n=s,e=Vp(t,s))),e===1))throw r=Iu,sa(t,0),Qi(t,n),Mr(t,kt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(fe(345));case 2:Ys(t,Nr,fi);break;case 3:if(Qi(t,n),(n&130023424)===n&&(e=ig+500-kt(),10<e)){if(Ff(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ar(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=_p(Ys.bind(null,t,Nr,fi),e);break}Ys(t,Nr,fi);break;case 4:if(Qi(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Dn(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=kt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*vR(n/1960))-n,10<n){t.timeoutHandle=_p(Ys.bind(null,t,Nr,fi),n);break}Ys(t,Nr,fi);break;case 5:Ys(t,Nr,fi);break;default:throw Error(fe(329))}}}return Mr(t,kt()),t.callbackNode===r?QE.bind(null,t):null}function Vp(t,e){var r=ql;return t.current.memoizedState.isDehydrated&&(sa(t,e).flags|=256),t=Jf(t,e),t!==2&&(e=Nr,Nr=r,e!==null&&Up(e)),t}function Up(t){Nr===null?Nr=t:Nr.push.apply(Nr,t)}function _R(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!bn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qi(t,e){for(e&=~ng,e&=~qh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Dn(e),n=1<<r;t[r]=-1,e&=~n}}function f_(t){if(He&6)throw Error(fe(327));To();var e=Ff(t,0);if(!(e&1))return Mr(t,kt()),null;var r=Jf(t,e);if(t.tag!==0&&r===2){var n=cp(t);n!==0&&(e=n,r=Vp(t,n))}if(r===1)throw r=Iu,sa(t,0),Qi(t,e),Mr(t,kt()),r;if(r===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ys(t,Nr,fi),Mr(t,kt()),null}function sg(t,e){var r=He;He|=1;try{return t(e)}finally{He=r,He===0&&(Uo=kt()+500,Hh&&Os())}}function pa(t){rs!==null&&rs.tag===0&&!(He&6)&&To();var e=He;He|=1;var r=cn.transition,n=et;try{if(cn.transition=null,et=1,t)return t()}finally{et=n,cn.transition=r,He=e,!(He&6)&&Os()}}function ag(){Hr=go.current,pt(go)}function sa(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,q4(r)),Ft!==null)for(r=Ft.return;r!==null;){var n=r;switch(Bm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Uf();break;case 3:Mo(),pt(Lr),pt(xr),Xm();break;case 5:qm(n);break;case 4:Mo();break;case 13:pt(_t);break;case 19:pt(_t);break;case 10:Hm(n.type._context);break;case 22:case 23:ag()}r=r.return}if(Jt=t,Ft=t=ds(t.current,null),or=Hr=e,Wt=0,Iu=null,ng=qh=da=0,Nr=ql=null,ea!==null){for(e=0;e<ea.length;e++)if(r=ea[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ea=null}return t}function JE(t,e){do{var r=Ft;try{if(Wm(),pf.current=qf,Kf){for(var n=yt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Kf=!1}if(ha=0,qt=zt=yt=null,Gl=!1,Tu=0,rg.current=null,r===null||r.return===null){Wt=1,Iu=e,Ft=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=or,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Jv(a);if(m!==null){m.flags&=-257,Zv(m,a,o,s,e),m.mode&1&&Qv(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var g=new Set;g.add(l),e.updateQueue=g}else y.add(l);break e}else{if(!(e&1)){Qv(s,u,e),og();break e}l=Error(fe(426))}}else if(gt&&o.mode&1){var A=Jv(a);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Zv(A,a,o,s,e),jm(Vo(l,o));break e}}s=l=Vo(l,o),Wt!==4&&(Wt=2),ql===null?ql=[s]:ql.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=LE(s,l,e);$v(s,w);break e;case 1:o=l;var x=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(fs===null||!fs.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var L=bE(s,o,e);$v(s,L);break e}}s=s.return}while(s!==null)}tT(r)}catch(W){e=W,Ft===r&&r!==null&&(Ft=r=r.return);continue}break}while(!0)}function ZE(){var t=Xf.current;return Xf.current=qf,t===null?qf:t}function og(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),Jt===null||!(da&268435455)&&!(qh&268435455)||Qi(Jt,or)}function Jf(t,e){var r=He;He|=2;var n=ZE();(Jt!==t||or!==e)&&(fi=null,sa(t,e));do try{yR();break}catch(i){JE(t,i)}while(!0);if(Wm(),He=r,Xf.current=n,Ft!==null)throw Error(fe(261));return Jt=null,or=0,Wt}function yR(){for(;Ft!==null;)eT(Ft)}function xR(){for(;Ft!==null&&!$C();)eT(Ft)}function eT(t){var e=nT(t.alternate,t,Hr);t.memoizedProps=t.pendingProps,e===null?tT(t):Ft=e,rg.current=null}function tT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=dR(r,e),r!==null){r.flags&=32767,Ft=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Wt=6,Ft=null;return}}else if(r=hR(r,e,Hr),r!==null){Ft=r;return}if(e=e.sibling,e!==null){Ft=e;return}Ft=e=t}while(e!==null);Wt===0&&(Wt=5)}function Ys(t,e,r){var n=et,i=cn.transition;try{cn.transition=null,et=1,wR(t,e,r,n)}finally{cn.transition=i,et=n}return null}function wR(t,e,r,n){do To();while(rs!==null);if(He&6)throw Error(fe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(t4(t,s),t===Jt&&(Ft=Jt=null,or=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||jc||(jc=!0,iT(Of,function(){return To(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=cn.transition,cn.transition=null;var a=et;et=1;var o=He;He|=4,rg.current=null,mR(t,r),XE(r,t),j4(gp),Lf=!!mp,gp=mp=null,t.current=r,gR(r),GC(),He=o,et=a,cn.transition=s}else t.current=r;if(jc&&(jc=!1,rs=t,Qf=i),s=t.pendingLanes,s===0&&(fs=null),XC(r.stateNode),Mr(t,kt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Yf)throw Yf=!1,t=bp,bp=null,t;return Qf&1&&t.tag!==0&&To(),s=t.pendingLanes,s&1?t===Mp?Xl++:(Xl=0,Mp=t):Xl=0,Os(),null}function To(){if(rs!==null){var t=Lw(Qf),e=cn.transition,r=et;try{if(cn.transition=null,et=16>t?16:t,rs===null)var n=!1;else{if(t=rs,rs=null,Qf=0,He&6)throw Error(fe(331));var i=He;for(He|=4,Se=t.current;Se!==null;){var s=Se,a=s.child;if(Se.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Se=u;Se!==null;){var f=Se;switch(f.tag){case 0:case 11:case 15:Kl(8,f,s)}var h=f.child;if(h!==null)h.return=f,Se=h;else for(;Se!==null;){f=Se;var d=f.sibling,m=f.return;if(GE(f),f===u){Se=null;break}if(d!==null){d.return=m,Se=d;break}Se=m}}}var y=s.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var A=g.sibling;g.sibling=null,g=A}while(g!==null)}}Se=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Se=a;else e:for(;Se!==null;){if(s=Se,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Kl(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Se=w;break e}Se=s.return}}var x=t.current;for(Se=x;Se!==null;){a=Se;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,Se=I;else e:for(a=x;Se!==null;){if(o=Se,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Kh(9,o)}}catch(W){Tt(o,o.return,W)}if(o===a){Se=null;break e}var L=o.sibling;if(L!==null){L.return=o.return,Se=L;break e}Se=o.return}}if(He=i,Os(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(Uh,t)}catch{}n=!0}return n}finally{et=r,cn.transition=e}}return!1}function h_(t,e,r){e=Vo(r,e),e=LE(t,e,1),t=cs(t,e,1),e=Ar(),t!==null&&(Hu(t,1,e),Mr(t,e))}function Tt(t,e,r){if(t.tag===3)h_(t,t,r);else for(;e!==null;){if(e.tag===3){h_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(fs===null||!fs.has(n))){t=Vo(r,t),t=bE(e,t,1),e=cs(e,t,1),t=Ar(),e!==null&&(Hu(e,1,t),Mr(e,t));break}}e=e.return}}function ER(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ar(),t.pingedLanes|=t.suspendedLanes&r,Jt===t&&(or&r)===r&&(Wt===4||Wt===3&&(or&130023424)===or&&500>kt()-ig?sa(t,0):ng|=r),Mr(t,e)}function rT(t,e){e===0&&(t.mode&1?(e=Nc,Nc<<=1,!(Nc&130023424)&&(Nc=4194304)):e=1);var r=Ar();t=Ai(t,e),t!==null&&(Hu(t,e,r),Mr(t,r))}function TR(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),rT(t,r)}function SR(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(fe(314))}n!==null&&n.delete(e),rT(t,r)}var nT;nT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Lr.current)Fr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Fr=!1,fR(t,e,r);Fr=!!(t.flags&131072)}else Fr=!1,gt&&e.flags&1048576&&oE(e,zf,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;gf(t,e),t=e.pendingProps;var i=Fo(e,xr.current);Eo(e,r),i=Qm(null,e,n,t,i,r);var s=Jm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,br(n)?(s=!0,Bf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Gm(e),i.updater=Gh,e.stateNode=i,i._reactInternals=e,Ap(e,n,t,r),e=Rp(null,e,n,!0,s,r)):(e.tag=0,gt&&s&&Um(e),Er(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(gf(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=IR(n),t=An(n,t),i){case 0:e=Cp(null,e,n,t,r);break e;case 1:e=r_(null,e,n,t,r);break e;case 11:e=e_(null,e,n,t,r);break e;case 14:e=t_(null,e,n,An(n.type,t),r);break e}throw Error(fe(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:An(n,i),Cp(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:An(n,i),r_(t,e,n,i,r);case 3:e:{if(BE(e),t===null)throw Error(fe(387));n=e.pendingProps,s=e.memoizedState,i=s.element,dE(t,e),$f(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Vo(Error(fe(423)),e),e=n_(t,e,n,r,i);break e}else if(n!==i){i=Vo(Error(fe(424)),e),e=n_(t,e,n,r,i);break e}else for(qr=us(e.stateNode.containerInfo.firstChild),Yr=e,gt=!0,Cn=null,r=fE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Lo(),n===i){e=Ii(t,e,r);break e}Er(t,e,n,r)}e=e.child}return e;case 5:return pE(e),t===null&&Ep(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,vp(n,i)?a=null:s!==null&&vp(n,s)&&(e.flags|=32),UE(t,e),Er(t,e,a,r),e.child;case 6:return t===null&&Ep(e),null;case 13:return jE(t,e,r);case 4:return Km(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=bo(e,null,n,r):Er(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:An(n,i),e_(t,e,n,i,r);case 7:return Er(t,e,e.pendingProps,r),e.child;case 8:return Er(t,e,e.pendingProps.children,r),e.child;case 12:return Er(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ft(Wf,n._currentValue),n._currentValue=a,s!==null)if(bn(s.value,a)){if(s.children===i.children&&!Lr.current){e=Ii(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=_i(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Tp(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(fe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Tp(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Er(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Eo(e,r),i=fn(i),n=n(i),e.flags|=1,Er(t,e,n,r),e.child;case 14:return n=e.type,i=An(n,e.pendingProps),i=An(n.type,i),t_(t,e,n,i,r);case 15:return ME(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:An(n,i),gf(t,e),e.tag=1,br(n)?(t=!0,Bf(e)):t=!1,Eo(e,r),FE(e,n,i),Ap(e,n,i,r),Rp(null,e,n,!0,t,r);case 19:return zE(t,e,r);case 22:return VE(t,e,r)}throw Error(fe(156,e.tag))};function iT(t,e){return Nw(t,e)}function AR(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(t,e,r,n){return new AR(t,e,r,n)}function lg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function IR(t){if(typeof t=="function")return lg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Cm)return 11;if(t===Rm)return 14}return 2}function ds(t,e){var r=t.alternate;return r===null?(r=un(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function yf(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")lg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case so:return aa(r.children,i,s,e);case Im:a=8,i|=8;break;case X0:return t=un(12,r,e,i|2),t.elementType=X0,t.lanes=s,t;case Y0:return t=un(13,r,e,i),t.elementType=Y0,t.lanes=s,t;case Q0:return t=un(19,r,e,i),t.elementType=Q0,t.lanes=s,t;case pw:return Xh(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hw:a=10;break e;case dw:a=9;break e;case Cm:a=11;break e;case Rm:a=14;break e;case qi:a=16,n=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=un(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function aa(t,e,r,n){return t=un(7,t,n,e),t.lanes=r,t}function Xh(t,e,r,n){return t=un(22,t,n,e),t.elementType=pw,t.lanes=r,t.stateNode={isHidden:!1},t}function g0(t,e,r){return t=un(6,t,null,e),t.lanes=r,t}function v0(t,e,r){return e=un(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function CR(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qd(0),this.expirationTimes=Qd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ug(t,e,r,n,i,s,a,o,l){return t=new CR(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=un(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gm(s),t}function RR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:io,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function sT(t){if(!t)return xs;t=t._reactInternals;e:{if(Aa(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(br(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var r=t.type;if(br(r))return sE(t,r,e)}return e}function aT(t,e,r,n,i,s,a,o,l){return t=ug(r,n,!0,t,i,s,a,o,l),t.context=sT(null),r=t.current,n=Ar(),i=hs(r),s=_i(n,i),s.callback=e??null,cs(r,s,i),t.current.lanes=i,Hu(t,i,n),Mr(t,n),t}function Yh(t,e,r,n){var i=e.current,s=Ar(),a=hs(i);return r=sT(r),e.context===null?e.context=r:e.pendingContext=r,e=_i(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=cs(i,e,a),t!==null&&(On(t,i,a,s),df(t,i,a)),a}function Zf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function d_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function cg(t,e){d_(t,e),(t=t.alternate)&&d_(t,e)}function kR(){return null}var oT=typeof reportError=="function"?reportError:function(t){console.error(t)};function fg(t){this._internalRoot=t}Qh.prototype.render=fg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));Yh(t,e,null,null)};Qh.prototype.unmount=fg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;pa(function(){Yh(null,t,null,null)}),e[Si]=null}};function Qh(t){this._internalRoot=t}Qh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Vw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Yi.length&&e!==0&&e<Yi[r].priority;r++);Yi.splice(r,0,t),r===0&&Bw(t)}};function hg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function p_(){}function PR(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Zf(a);s.call(u)}}var a=aT(e,n,t,0,null,!1,!1,"",p_);return t._reactRootContainer=a,t[Si]=a.current,_u(t.nodeType===8?t.parentNode:t),pa(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=Zf(l);o.call(u)}}var l=ug(t,0,!1,null,null,!1,!1,"",p_);return t._reactRootContainer=l,t[Si]=l.current,_u(t.nodeType===8?t.parentNode:t),pa(function(){Yh(e,l,r,n)}),l}function Zh(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Zf(a);o.call(l)}}Yh(e,a,t,i)}else a=PR(r,e,t,i,n);return Zf(a)}bw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Dl(e.pendingLanes);r!==0&&(Nm(e,r|1),Mr(e,kt()),!(He&6)&&(Uo=kt()+500,Os()))}break;case 13:pa(function(){var n=Ai(t,1);if(n!==null){var i=Ar();On(n,t,1,i)}}),cg(t,1)}};Dm=function(t){if(t.tag===13){var e=Ai(t,134217728);if(e!==null){var r=Ar();On(e,t,134217728,r)}cg(t,134217728)}};Mw=function(t){if(t.tag===13){var e=hs(t),r=Ai(t,e);if(r!==null){var n=Ar();On(r,t,e,n)}cg(t,e)}};Vw=function(){return et};Uw=function(t,e){var r=et;try{return et=t,e()}finally{et=r}};op=function(t,e,r){switch(e){case"input":if(ep(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Wh(n);if(!i)throw Error(fe(90));gw(n),ep(n,i)}}}break;case"textarea":_w(t,r);break;case"select":e=r.value,e!=null&&_o(t,!!r.multiple,e,!1)}};Aw=sg;Iw=pa;var NR={usingClientEntryPoint:!1,Events:[Gu,uo,Wh,Tw,Sw,sg]},Cl={findFiberByHostInstance:Zs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DR={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=kw(t),t===null?null:t.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||kR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zc.isDisabled&&zc.supportsFiber)try{Uh=zc.inject(DR),Xn=zc}catch{}}en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NR;en.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hg(e))throw Error(fe(200));return RR(t,e,null,r)};en.createRoot=function(t,e){if(!hg(t))throw Error(fe(299));var r=!1,n="",i=oT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ug(t,1,!1,null,null,r,!1,n,i),t[Si]=e.current,_u(t.nodeType===8?t.parentNode:t),new fg(e)};en.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=kw(e),t=t===null?null:t.stateNode,t};en.flushSync=function(t){return pa(t)};en.hydrate=function(t,e,r){if(!Jh(e))throw Error(fe(200));return Zh(null,t,e,!0,r)};en.hydrateRoot=function(t,e,r){if(!hg(t))throw Error(fe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=oT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=aT(e,null,t,1,r??null,i,!1,s,a),t[Si]=e.current,_u(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Qh(e)};en.render=function(t,e,r){if(!Jh(e))throw Error(fe(200));return Zh(null,t,e,!1,r)};en.unmountComponentAtNode=function(t){if(!Jh(t))throw Error(fe(40));return t._reactRootContainer?(pa(function(){Zh(null,null,t,!1,function(){t._reactRootContainer=null,t[Si]=null})}),!0):!1};en.unstable_batchedUpdates=sg;en.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Jh(r))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return Zh(t,e,r,!1,n)};en.version="18.3.1-next-f1338f8080-20240426";function lT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lT)}catch(t){console.error(t)}}lT(),lw.exports=en;var OR=lw.exports,m_=OR;K0.createRoot=m_.createRoot,K0.hydrateRoot=m_.hydrateRoot;const FR=()=>{};var g_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},LR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},cT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(uT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||h==null)throw new bR;const d=s<<2|o>>4;if(n.push(d),u!==64){const m=o<<4&240|u>>2;if(n.push(m),h!==64){const y=u<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MR=function(t){const e=uT(t);return cT.encodeByteArray(e,!0)},eh=function(t){return MR(t).replace(/\./g,"")},fT=function(t){try{return cT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR=()=>VR().__FIREBASE_DEFAULTS__,BR=()=>{if(typeof process>"u"||typeof g_>"u")return;const t=g_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},jR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&fT(t[1]);return e&&JSON.parse(e)},ed=()=>{try{return FR()||UR()||BR()||jR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hT=t=>{var e,r;return(r=(e=ed())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},dT=t=>{const e=hT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},pT=()=>{var t;return(t=ed())==null?void 0:t.config},mT=t=>{var e;return(e=ed())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dg(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[eh(JSON.stringify(r)),eh(JSON.stringify(a)),""].join(".")}const Yl={};function WR(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yl))Yl[e]?t.emulator.push(e):t.prod.push(e);return t}function HR(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let v_=!1;function pg(t,e){if(typeof window>"u"||typeof document>"u"||!Ia(window.location.host)||Yl[t]===e||Yl[t]||v_)return;Yl[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",s=WR().prod.length>0;function a(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function u(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{v_=!0,a()},d}function f(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=HR(n),m=r("text"),y=document.getElementById(m)||document.createElement("span"),g=r("learnmore"),A=document.getElementById(g)||document.createElement("a"),w=r("preprendIcon"),x=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const I=d.element;o(I),f(A,g);const L=u();l(x,w),I.append(x,y,A,L),document.body.appendChild(I)}s?(y.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $R(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wr())}function GR(){var e;const t=(e=ed())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function KR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XR(){const t=wr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function YR(){return!GR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _T(){try{return typeof indexedDB=="object"}catch{return!1}}function yT(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(r){e(r)}})}function QR(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR="FirebaseError";class mn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=JR,Object.setPrototypeOf(this,mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ca.prototype.create)}}class Ca{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?ZR(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new mn(i,o,n)}}function ZR(t,e){return t.replace(ek,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const ek=/\{\$([^}]+)}/g;function tk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ws(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(__(s)&&__(a)){if(!ws(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function __(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Fl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ll(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function rk(t,e){const r=new nk(t,e);return r.subscribe.bind(r)}class nk{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");ik(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=_0),i.error===void 0&&(i.error=_0),i.complete===void 0&&(i.complete=_0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ik(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function _0(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk=1e3,ak=2,ok=4*60*60*1e3,lk=.5;function y_(t,e=sk,r=ak){const n=e*Math.pow(r,t),i=Math.round(lk*n*(Math.random()-.5)*2);return Math.min(ok,n+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(t){return t&&t._delegate?t._delegate:t}class dn{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new zR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fk(e))try{this.getOrInitializeService({instanceIdentifier:Qs})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Qs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qs){return this.instances.has(e)}getOptions(e=Qs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ck(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Qs){return this.component?this.component.multipleInstances?e:Qs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ck(t){return t===Qs?void 0:t}function fk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new uk(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Be||(Be={}));const dk={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},pk=Be.INFO,mk={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},gk=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=mk[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class td{constructor(e){this.name=e,this._logLevel=pk,this._logHandler=gk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const vk=(t,e)=>e.some(r=>t instanceof r);let x_,w_;function _k(){return x_||(x_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yk(){return w_||(w_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xT=new WeakMap,Bp=new WeakMap,wT=new WeakMap,y0=new WeakMap,mg=new WeakMap;function xk(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(ps(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&xT.set(r,t)}).catch(()=>{}),mg.set(e,t),e}function wk(t){if(Bp.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Bp.set(t,e)}let jp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Bp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||wT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ps(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ek(t){jp=t(jp)}function Tk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(x0(this),e,...r);return wT.set(n,e.sort?e.sort():[e]),ps(n)}:yk().includes(t)?function(...e){return t.apply(x0(this),e),ps(xT.get(this))}:function(...e){return ps(t.apply(x0(this),e))}}function Sk(t){return typeof t=="function"?Tk(t):(t instanceof IDBTransaction&&wk(t),vk(t,_k())?new Proxy(t,jp):t)}function ps(t){if(t instanceof IDBRequest)return xk(t);if(y0.has(t))return y0.get(t);const e=Sk(t);return e!==t&&(y0.set(t,e),mg.set(e,t)),e}const x0=t=>mg.get(t);function ET(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=ps(a);return n&&a.addEventListener("upgradeneeded",l=>{n(ps(a.result),l.oldVersion,l.newVersion,ps(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const Ak=["get","getKey","getAll","getAllKeys","count"],Ik=["put","add","delete","clear"],w0=new Map;function E_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(w0.get(e))return w0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Ik.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Ak.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return w0.set(e,s),s}Ek(t=>({...t,get:(e,r,n)=>E_(e,r)||t.get(e,r,n),has:(e,r)=>!!E_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Rk(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Rk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const zp="@firebase/app",T_="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci=new td("@firebase/app"),kk="@firebase/app-compat",Pk="@firebase/analytics-compat",Nk="@firebase/analytics",Dk="@firebase/app-check-compat",Ok="@firebase/app-check",Fk="@firebase/auth",Lk="@firebase/auth-compat",bk="@firebase/database",Mk="@firebase/data-connect",Vk="@firebase/database-compat",Uk="@firebase/functions",Bk="@firebase/functions-compat",jk="@firebase/installations",zk="@firebase/installations-compat",Wk="@firebase/messaging",Hk="@firebase/messaging-compat",$k="@firebase/performance",Gk="@firebase/performance-compat",Kk="@firebase/remote-config",qk="@firebase/remote-config-compat",Xk="@firebase/storage",Yk="@firebase/storage-compat",Qk="@firebase/firestore",Jk="@firebase/ai",Zk="@firebase/firestore-compat",eP="firebase",tP="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="[DEFAULT]",rP={[zp]:"fire-core",[kk]:"fire-core-compat",[Nk]:"fire-analytics",[Pk]:"fire-analytics-compat",[Ok]:"fire-app-check",[Dk]:"fire-app-check-compat",[Fk]:"fire-auth",[Lk]:"fire-auth-compat",[bk]:"fire-rtdb",[Mk]:"fire-data-connect",[Vk]:"fire-rtdb-compat",[Uk]:"fire-fn",[Bk]:"fire-fn-compat",[jk]:"fire-iid",[zk]:"fire-iid-compat",[Wk]:"fire-fcm",[Hk]:"fire-fcm-compat",[$k]:"fire-perf",[Gk]:"fire-perf-compat",[Kk]:"fire-rc",[qk]:"fire-rc-compat",[Xk]:"fire-gcs",[Yk]:"fire-gcs-compat",[Qk]:"fire-fst",[Zk]:"fire-fst-compat",[Jk]:"fire-vertex","fire-js":"fire-js",[eP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=new Map,nP=new Map,Hp=new Map;function S_(t,e){try{t.container.addComponent(e)}catch(r){Ci.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Mn(t){const e=t.name;if(Hp.has(e))return Ci.debug(`There were multiple attempts to register component ${e}.`),!1;Hp.set(e,t);for(const r of th.values())S_(r,t);for(const r of nP.values())S_(r,t);return!0}function Fs(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Dr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new Ca("app","Firebase",iP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new dn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=tP;function TT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Wp,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw ms.create("bad-app-name",{appName:String(i)});if(r||(r=pT()),!r)throw ms.create("no-options");const s=th.get(i);if(s){if(ws(r,s.options)&&ws(n,s.config))return s;throw ms.create("duplicate-app",{appName:i})}const a=new hk(i);for(const l of Hp.values())a.addComponent(l);const o=new sP(r,n,a);return th.set(i,o),o}function rd(t=Wp){const e=th.get(t);if(!e&&t===Wp&&pT())return TT();if(!e)throw ms.create("no-app",{appName:t});return e}function Vr(t,e,r){let n=rP[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ci.warn(a.join(" "));return}Mn(new dn(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP="firebase-heartbeat-database",oP=1,Cu="firebase-heartbeat-store";let E0=null;function ST(){return E0||(E0=ET(aP,oP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Cu)}catch(r){console.warn(r)}}}}).catch(t=>{throw ms.create("idb-open",{originalErrorMessage:t.message})})),E0}async function lP(t){try{const r=(await ST()).transaction(Cu),n=await r.objectStore(Cu).get(AT(t));return await r.done,n}catch(e){if(e instanceof mn)Ci.warn(e.message);else{const r=ms.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ci.warn(r.message)}}}async function A_(t,e){try{const n=(await ST()).transaction(Cu,"readwrite");await n.objectStore(Cu).put(e,AT(t)),await n.done}catch(r){if(r instanceof mn)Ci.warn(r.message);else{const n=ms.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ci.warn(n.message)}}}function AT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP=1024,cP=30;class fP{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new dP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=I_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>cP){const a=pP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ci.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=I_(),{heartbeatsToSend:n,unsentEntries:i}=hP(this._heartbeatsCache.heartbeats),s=eh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Ci.warn(r),""}}}function I_(){return new Date().toISOString().substring(0,10)}function hP(t,e=uP){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),C_(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),C_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class dP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _T()?yT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await lP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return A_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return A_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function C_(t){return eh(JSON.stringify({version:2,heartbeats:t})).length}function pP(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t){Mn(new dn("platform-logger",e=>new Ck(e),"PRIVATE")),Mn(new dn("heartbeat",e=>new fP(e),"PRIVATE")),Vr(zp,T_,t),Vr(zp,T_,"esm2020"),Vr("fire-js","")}mP("");var gP="firebase",vP="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vr(gP,vP,"app");const IT="@firebase/installations",gg="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=1e4,RT=`w:${gg}`,kT="FIS_v2",_P="https://firebaseinstallations.googleapis.com/v1",yP=60*60*1e3,xP="installations",wP="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ma=new Ca(xP,wP,EP);function PT(t){return t instanceof mn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT({projectId:t}){return`${_P}/projects/${t}/installations`}function DT(t){return{token:t.token,requestStatus:2,expiresIn:SP(t.expiresIn),creationTime:Date.now()}}async function OT(t,e){const n=(await e.json()).error;return ma.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function FT({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function TP(t,{refreshToken:e}){const r=FT(t);return r.append("Authorization",AP(e)),r}async function LT(t){const e=await t();return e.status>=500&&e.status<600?t():e}function SP(t){return Number(t.replace("s","000"))}function AP(t){return`${kT} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IP({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=NT(t),i=FT(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const a={fid:r,authVersion:kT,appId:t.appId,sdkVersion:RT},o={method:"POST",headers:i,body:JSON.stringify(a)},l=await LT(()=>fetch(n,o));if(l.ok){const u=await l.json();return{fid:u.fid||r,registrationStatus:2,refreshToken:u.refreshToken,authToken:DT(u.authToken)}}else throw await OT("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=/^[cdef][\w-]{21}$/,$p="";function kP(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=PP(t);return RP.test(r)?r:$p}catch{return $p}}function PP(t){return CP(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=new Map;function VT(t,e){const r=nd(t);UT(r,e),NP(r,e)}function UT(t,e){const r=MT.get(t);if(r)for(const n of r)n(e)}function NP(t,e){const r=DP();r&&r.postMessage({key:t,fid:e}),OP()}let ra=null;function DP(){return!ra&&"BroadcastChannel"in self&&(ra=new BroadcastChannel("[Firebase] FID Change"),ra.onmessage=t=>{UT(t.data.key,t.data.fid)}),ra}function OP(){MT.size===0&&ra&&(ra.close(),ra=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP="firebase-installations-database",LP=1,ga="firebase-installations-store";let T0=null;function vg(){return T0||(T0=ET(FP,LP,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ga)}}})),T0}async function rh(t,e){const r=nd(t),i=(await vg()).transaction(ga,"readwrite"),s=i.objectStore(ga),a=await s.get(r);return await s.put(e,r),await i.done,(!a||a.fid!==e.fid)&&VT(t,e.fid),e}async function BT(t){const e=nd(t),n=(await vg()).transaction(ga,"readwrite");await n.objectStore(ga).delete(e),await n.done}async function id(t,e){const r=nd(t),i=(await vg()).transaction(ga,"readwrite"),s=i.objectStore(ga),a=await s.get(r),o=e(a);return o===void 0?await s.delete(r):await s.put(o,r),await i.done,o&&(!a||a.fid!==o.fid)&&VT(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _g(t){let e;const r=await id(t.appConfig,n=>{const i=bP(n),s=MP(t,i);return e=s.registrationPromise,s.installationEntry});return r.fid===$p?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function bP(t){const e=t||{fid:kP(),registrationStatus:0};return jT(e)}function MP(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(ma.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=VP(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:UP(t)}:{installationEntry:e}}async function VP(t,e){try{const r=await IP(t,e);return rh(t.appConfig,r)}catch(r){throw PT(r)&&r.customData.serverCode===409?await BT(t.appConfig):await rh(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function UP(t){let e=await R_(t.appConfig);for(;e.registrationStatus===1;)await bT(100),e=await R_(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await _g(t);return n||r}return e}function R_(t){return id(t,e=>{if(!e)throw ma.create("installation-not-found");return jT(e)})}function jT(t){return BP(t)?{fid:t.fid,registrationStatus:0}:t}function BP(t){return t.registrationStatus===1&&t.registrationTime+CT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jP({appConfig:t,heartbeatServiceProvider:e},r){const n=zP(t,r),i=TP(t,r),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const a={installation:{sdkVersion:RT,appId:t.appId}},o={method:"POST",headers:i,body:JSON.stringify(a)},l=await LT(()=>fetch(n,o));if(l.ok){const u=await l.json();return DT(u)}else throw await OT("Generate Auth Token",l)}function zP(t,{fid:e}){return`${NT(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yg(t,e=!1){let r;const n=await id(t.appConfig,s=>{if(!zT(s))throw ma.create("not-registered");const a=s.authToken;if(!e&&$P(a))return s;if(a.requestStatus===1)return r=WP(t,e),s;{if(!navigator.onLine)throw ma.create("app-offline");const o=KP(s);return r=HP(t,o),o}});return r?await r:n.authToken}async function WP(t,e){let r=await k_(t.appConfig);for(;r.authToken.requestStatus===1;)await bT(100),r=await k_(t.appConfig);const n=r.authToken;return n.requestStatus===0?yg(t,e):n}function k_(t){return id(t,e=>{if(!zT(e))throw ma.create("not-registered");const r=e.authToken;return qP(r)?{...e,authToken:{requestStatus:0}}:e})}async function HP(t,e){try{const r=await jP(t,e),n={...e,authToken:r};return await rh(t.appConfig,n),r}catch(r){if(PT(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await BT(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await rh(t.appConfig,n)}throw r}}function zT(t){return t!==void 0&&t.registrationStatus===2}function $P(t){return t.requestStatus===2&&!GP(t)}function GP(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+yP}function KP(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function qP(t){return t.requestStatus===1&&t.requestTime+CT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XP(t){const e=t,{installationEntry:r,registrationPromise:n}=await _g(e);return n?n.catch(console.error):yg(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YP(t,e=!1){const r=t;return await QP(r),(await yg(r,e)).token}async function QP(t){const{registrationPromise:e}=await _g(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(t){if(!t||!t.options)throw S0("App Configuration");if(!t.name)throw S0("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw S0(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function S0(t){return ma.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="installations",ZP="installations-internal",eN=t=>{const e=t.getProvider("app").getImmediate(),r=JP(e),n=Fs(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},tN=t=>{const e=t.getProvider("app").getImmediate(),r=Fs(e,WT).getImmediate();return{getId:()=>XP(r),getToken:i=>YP(r,i)}};function rN(){Mn(new dn(WT,eN,"PUBLIC")),Mn(new dn(ZP,tN,"PRIVATE"))}rN();Vr(IT,gg);Vr(IT,gg,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nh="analytics",nN="firebase_id",iN="origin",sN=60*1e3,aN="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",xg="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new td("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Qr=new Ca("analytics","Analytics",oN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(t){if(!t.startsWith(xg)){const e=Qr.create("invalid-gtag-resource",{gtagURL:t});return Ir.warn(e.message),""}return t}function HT(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function uN(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function cN(t,e){const r=uN("firebase-js-sdk-policy",{createScriptURL:lN}),n=document.createElement("script"),i=`${xg}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function fN(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function hN(t,e,r,n,i,s){const a=n[i];try{if(a)await e[a];else{const l=(await HT(r)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(o){Ir.error(o)}t("config",i,s)}async function dN(t,e,r,n,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const o=await HT(r);for(const l of a){const u=o.find(h=>h.measurementId===l),f=u&&e[u.appId];if(f)s.push(f);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",n,i||{})}catch(s){Ir.error(s)}}function pN(t,e,r,n){async function i(s,...a){try{if(s==="event"){const[o,l]=a;await dN(t,e,r,o,l)}else if(s==="config"){const[o,l]=a;await hN(t,e,r,n,o,l)}else if(s==="consent"){const[o,l]=a;t("consent",o,l)}else if(s==="get"){const[o,l,u]=a;t("get",o,l,u)}else if(s==="set"){const[o]=a;t("set",o)}else t(s,...a)}catch(o){Ir.error(o)}}return i}function mN(t,e,r,n,i){let s=function(...a){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=pN(s,t,e,r),{gtagCore:s,wrappedGtag:window[i]}}function gN(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(xg)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=30,_N=1e3;class yN{constructor(e={},r=_N){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const $T=new yN;function xN(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function wN(t){var a;const{appId:e,apiKey:r}=t,n={method:"GET",headers:xN(r)},i=aN.replace("{app-id}",e),s=await fetch(i,n);if(s.status!==200&&s.status!==304){let o="";try{const l=await s.json();(a=l.error)!=null&&a.message&&(o=l.error.message)}catch{}throw Qr.create("config-fetch-failed",{httpStatus:s.status,responseMessage:o})}return s.json()}async function EN(t,e=$T,r){const{appId:n,apiKey:i,measurementId:s}=t.options;if(!n)throw Qr.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Qr.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new AN;return setTimeout(async()=>{o.abort()},sN),GT({appId:n,apiKey:i,measurementId:s},a,o,e)}async function GT(t,{throttleEndTimeMillis:e,backoffCount:r},n,i=$T){var o;const{appId:s,measurementId:a}=t;try{await TN(n,e)}catch(l){if(a)return Ir.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:a};throw l}try{const l=await wN(t);return i.deleteThrottleMetadata(s),l}catch(l){const u=l;if(!SN(u)){if(i.deleteThrottleMetadata(s),a)return Ir.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:a};throw l}const f=Number((o=u==null?void 0:u.customData)==null?void 0:o.httpStatus)===503?y_(r,i.intervalMillis,vN):y_(r,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return i.setThrottleMetadata(s,h),Ir.debug(`Calling attemptFetch again in ${f} millis`),GT(t,h,n,i)}}function TN(t,e){return new Promise((r,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(r,i);t.addEventListener(()=>{clearTimeout(s),n(Qr.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function SN(t){if(!(t instanceof mn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class AN{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function IN(t,e,r,n,i){if(i&&i.global){t("event",r,n);return}else{const s=await e,a={...n,send_to:s};t("event",r,a)}}async function CN(t,e,r,n){if(n&&n.global){const i={};for(const s of Object.keys(r))i[`user_properties.${s}`]=r[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RN(){if(_T())try{await yT()}catch(t){return Ir.warn(Qr.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Ir.warn(Qr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function kN(t,e,r,n,i,s,a){const o=EN(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&Ir.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>Ir.error(d)),e.push(o);const l=RN().then(d=>{if(d)return n.getId()}),[u,f]=await Promise.all([o,l]);gN(s)||cN(s,u.measurementId),i("js",new Date);const h=(a==null?void 0:a.config)??{};return h[iN]="firebase",h.update=!0,f!=null&&(h[nN]=f),i("config",u.measurementId,h),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.app=e}_delete(){return delete So[this.app.options.appId],Promise.resolve()}}let So={},P_=[];const N_={};let A0="dataLayer",NN="gtag",D_,wg,O_=!1;function DN(){const t=[];if(vT()&&t.push("This is a browser extension environment."),QR()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,i)=>`(${i+1}) ${n}`).join(" "),r=Qr.create("invalid-analytics-context",{errorInfo:e});Ir.warn(r.message)}}function ON(t,e,r){DN();const n=t.options.appId;if(!n)throw Qr.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Ir.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Qr.create("no-api-key");if(So[n]!=null)throw Qr.create("already-exists",{id:n});if(!O_){fN(A0);const{wrappedGtag:s,gtagCore:a}=mN(So,P_,N_,A0,NN);wg=s,D_=a,O_=!0}return So[n]=kN(t,P_,N_,e,D_,A0,r),new PN(t)}function FN(t=rd()){t=vt(t);const e=Fs(t,nh);return e.isInitialized()?e.getImmediate():LN(t)}function LN(t,e={}){const r=Fs(t,nh);if(r.isInitialized()){const i=r.getImmediate();if(ws(e,r.getOptions()))return i;throw Qr.create("already-initialized")}return r.initialize({options:e})}function bN(t,e,r){t=vt(t),CN(wg,So[t.app.options.appId],e,r).catch(n=>Ir.error(n))}function MN(t,e,r,n){t=vt(t),IN(wg,So[t.app.options.appId],e,r,n).catch(i=>Ir.error(i))}const F_="@firebase/analytics",L_="0.10.19";function VN(){Mn(new dn(nh,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return ON(n,i,r)},"PUBLIC")),Mn(new dn("analytics-internal",t,"PRIVATE")),Vr(F_,L_),Vr(F_,L_,"esm2020");function t(e){try{const r=e.getProvider(nh).getImmediate();return{logEvent:(n,i,s)=>MN(r,n,i,s),setUserProperties:(n,i)=>bN(r,n,i)}}catch(r){throw Qr.create("interop-component-reg-failed",{reason:r})}}}VN();var b_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gs,KT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,T){function S(){}S.prototype=T.prototype,E.F=T.prototype,E.prototype=new S,E.prototype.constructor=E,E.D=function(R,N,M){for(var D=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)D[Re-2]=arguments[Re];return T.prototype[N].apply(R,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,T,S){S||(S=0);const R=Array(16);if(typeof T=="string")for(var N=0;N<16;++N)R[N]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(N=0;N<16;++N)R[N]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=E.g[0],S=E.g[1],N=E.g[2];let M=E.g[3],D;D=T+(M^S&(N^M))+R[0]+3614090360&4294967295,T=S+(D<<7&4294967295|D>>>25),D=M+(N^T&(S^N))+R[1]+3905402710&4294967295,M=T+(D<<12&4294967295|D>>>20),D=N+(S^M&(T^S))+R[2]+606105819&4294967295,N=M+(D<<17&4294967295|D>>>15),D=S+(T^N&(M^T))+R[3]+3250441966&4294967295,S=N+(D<<22&4294967295|D>>>10),D=T+(M^S&(N^M))+R[4]+4118548399&4294967295,T=S+(D<<7&4294967295|D>>>25),D=M+(N^T&(S^N))+R[5]+1200080426&4294967295,M=T+(D<<12&4294967295|D>>>20),D=N+(S^M&(T^S))+R[6]+2821735955&4294967295,N=M+(D<<17&4294967295|D>>>15),D=S+(T^N&(M^T))+R[7]+4249261313&4294967295,S=N+(D<<22&4294967295|D>>>10),D=T+(M^S&(N^M))+R[8]+1770035416&4294967295,T=S+(D<<7&4294967295|D>>>25),D=M+(N^T&(S^N))+R[9]+2336552879&4294967295,M=T+(D<<12&4294967295|D>>>20),D=N+(S^M&(T^S))+R[10]+4294925233&4294967295,N=M+(D<<17&4294967295|D>>>15),D=S+(T^N&(M^T))+R[11]+2304563134&4294967295,S=N+(D<<22&4294967295|D>>>10),D=T+(M^S&(N^M))+R[12]+1804603682&4294967295,T=S+(D<<7&4294967295|D>>>25),D=M+(N^T&(S^N))+R[13]+4254626195&4294967295,M=T+(D<<12&4294967295|D>>>20),D=N+(S^M&(T^S))+R[14]+2792965006&4294967295,N=M+(D<<17&4294967295|D>>>15),D=S+(T^N&(M^T))+R[15]+1236535329&4294967295,S=N+(D<<22&4294967295|D>>>10),D=T+(N^M&(S^N))+R[1]+4129170786&4294967295,T=S+(D<<5&4294967295|D>>>27),D=M+(S^N&(T^S))+R[6]+3225465664&4294967295,M=T+(D<<9&4294967295|D>>>23),D=N+(T^S&(M^T))+R[11]+643717713&4294967295,N=M+(D<<14&4294967295|D>>>18),D=S+(M^T&(N^M))+R[0]+3921069994&4294967295,S=N+(D<<20&4294967295|D>>>12),D=T+(N^M&(S^N))+R[5]+3593408605&4294967295,T=S+(D<<5&4294967295|D>>>27),D=M+(S^N&(T^S))+R[10]+38016083&4294967295,M=T+(D<<9&4294967295|D>>>23),D=N+(T^S&(M^T))+R[15]+3634488961&4294967295,N=M+(D<<14&4294967295|D>>>18),D=S+(M^T&(N^M))+R[4]+3889429448&4294967295,S=N+(D<<20&4294967295|D>>>12),D=T+(N^M&(S^N))+R[9]+568446438&4294967295,T=S+(D<<5&4294967295|D>>>27),D=M+(S^N&(T^S))+R[14]+3275163606&4294967295,M=T+(D<<9&4294967295|D>>>23),D=N+(T^S&(M^T))+R[3]+4107603335&4294967295,N=M+(D<<14&4294967295|D>>>18),D=S+(M^T&(N^M))+R[8]+1163531501&4294967295,S=N+(D<<20&4294967295|D>>>12),D=T+(N^M&(S^N))+R[13]+2850285829&4294967295,T=S+(D<<5&4294967295|D>>>27),D=M+(S^N&(T^S))+R[2]+4243563512&4294967295,M=T+(D<<9&4294967295|D>>>23),D=N+(T^S&(M^T))+R[7]+1735328473&4294967295,N=M+(D<<14&4294967295|D>>>18),D=S+(M^T&(N^M))+R[12]+2368359562&4294967295,S=N+(D<<20&4294967295|D>>>12),D=T+(S^N^M)+R[5]+4294588738&4294967295,T=S+(D<<4&4294967295|D>>>28),D=M+(T^S^N)+R[8]+2272392833&4294967295,M=T+(D<<11&4294967295|D>>>21),D=N+(M^T^S)+R[11]+1839030562&4294967295,N=M+(D<<16&4294967295|D>>>16),D=S+(N^M^T)+R[14]+4259657740&4294967295,S=N+(D<<23&4294967295|D>>>9),D=T+(S^N^M)+R[1]+2763975236&4294967295,T=S+(D<<4&4294967295|D>>>28),D=M+(T^S^N)+R[4]+1272893353&4294967295,M=T+(D<<11&4294967295|D>>>21),D=N+(M^T^S)+R[7]+4139469664&4294967295,N=M+(D<<16&4294967295|D>>>16),D=S+(N^M^T)+R[10]+3200236656&4294967295,S=N+(D<<23&4294967295|D>>>9),D=T+(S^N^M)+R[13]+681279174&4294967295,T=S+(D<<4&4294967295|D>>>28),D=M+(T^S^N)+R[0]+3936430074&4294967295,M=T+(D<<11&4294967295|D>>>21),D=N+(M^T^S)+R[3]+3572445317&4294967295,N=M+(D<<16&4294967295|D>>>16),D=S+(N^M^T)+R[6]+76029189&4294967295,S=N+(D<<23&4294967295|D>>>9),D=T+(S^N^M)+R[9]+3654602809&4294967295,T=S+(D<<4&4294967295|D>>>28),D=M+(T^S^N)+R[12]+3873151461&4294967295,M=T+(D<<11&4294967295|D>>>21),D=N+(M^T^S)+R[15]+530742520&4294967295,N=M+(D<<16&4294967295|D>>>16),D=S+(N^M^T)+R[2]+3299628645&4294967295,S=N+(D<<23&4294967295|D>>>9),D=T+(N^(S|~M))+R[0]+4096336452&4294967295,T=S+(D<<6&4294967295|D>>>26),D=M+(S^(T|~N))+R[7]+1126891415&4294967295,M=T+(D<<10&4294967295|D>>>22),D=N+(T^(M|~S))+R[14]+2878612391&4294967295,N=M+(D<<15&4294967295|D>>>17),D=S+(M^(N|~T))+R[5]+4237533241&4294967295,S=N+(D<<21&4294967295|D>>>11),D=T+(N^(S|~M))+R[12]+1700485571&4294967295,T=S+(D<<6&4294967295|D>>>26),D=M+(S^(T|~N))+R[3]+2399980690&4294967295,M=T+(D<<10&4294967295|D>>>22),D=N+(T^(M|~S))+R[10]+4293915773&4294967295,N=M+(D<<15&4294967295|D>>>17),D=S+(M^(N|~T))+R[1]+2240044497&4294967295,S=N+(D<<21&4294967295|D>>>11),D=T+(N^(S|~M))+R[8]+1873313359&4294967295,T=S+(D<<6&4294967295|D>>>26),D=M+(S^(T|~N))+R[15]+4264355552&4294967295,M=T+(D<<10&4294967295|D>>>22),D=N+(T^(M|~S))+R[6]+2734768916&4294967295,N=M+(D<<15&4294967295|D>>>17),D=S+(M^(N|~T))+R[13]+1309151649&4294967295,S=N+(D<<21&4294967295|D>>>11),D=T+(N^(S|~M))+R[4]+4149444226&4294967295,T=S+(D<<6&4294967295|D>>>26),D=M+(S^(T|~N))+R[11]+3174756917&4294967295,M=T+(D<<10&4294967295|D>>>22),D=N+(T^(M|~S))+R[2]+718787259&4294967295,N=M+(D<<15&4294967295|D>>>17),D=S+(M^(N|~T))+R[9]+3951481745&4294967295,E.g[0]=E.g[0]+T&4294967295,E.g[1]=E.g[1]+(N+(D<<21&4294967295|D>>>11))&4294967295,E.g[2]=E.g[2]+N&4294967295,E.g[3]=E.g[3]+M&4294967295}n.prototype.v=function(E,T){T===void 0&&(T=E.length);const S=T-this.blockSize,R=this.C;let N=this.h,M=0;for(;M<T;){if(N==0)for(;M<=S;)i(this,E,M),M+=this.blockSize;if(typeof E=="string"){for(;M<T;)if(R[N++]=E.charCodeAt(M++),N==this.blockSize){i(this,R),N=0;break}}else for(;M<T;)if(R[N++]=E[M++],N==this.blockSize){i(this,R),N=0;break}}this.h=N,this.o+=T},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var T=1;T<E.length-8;++T)E[T]=0;T=this.o*8;for(var S=E.length-8;S<E.length;++S)E[S]=T&255,T/=256;for(this.v(E),E=Array(16),T=0,S=0;S<4;++S)for(let R=0;R<32;R+=8)E[T++]=this.g[S]>>>R&255;return E};function s(E,T){var S=o;return Object.prototype.hasOwnProperty.call(S,E)?S[E]:S[E]=T(E)}function a(E,T){this.h=T;const S=[];let R=!0;for(let N=E.length-1;N>=0;N--){const M=E[N]|0;R&&M==T||(S[N]=M,R=!1)}this.g=S}var o={};function l(E){return-128<=E&&E<128?s(E,function(T){return new a([T|0],T<0?-1:0)}):new a([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return h;if(E<0)return A(u(-E));const T=[];let S=1;for(let R=0;E>=S;R++)T[R]=E/S|0,S*=4294967296;return new a(T,0)}function f(E,T){if(E.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(E.charAt(0)=="-")return A(f(E.substring(1),T));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=u(Math.pow(T,8));let R=h;for(let M=0;M<E.length;M+=8){var N=Math.min(8,E.length-M);const D=parseInt(E.substring(M,M+N),T);N<8?(N=u(Math.pow(T,N)),R=R.j(N).add(u(D))):(R=R.j(S),R=R.add(u(D)))}return R}var h=l(0),d=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-A(this).m();let E=0,T=1;for(let S=0;S<this.g.length;S++){const R=this.i(S);E+=(R>=0?R:4294967296+R)*T,T*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(y(this))return"0";if(g(this))return"-"+A(this).toString(E);const T=u(Math.pow(E,6));var S=this;let R="";for(;;){const N=L(S,T).g;S=w(S,N.j(T));let M=((S.g.length>0?S.g[0]:S.h)>>>0).toString(E);if(S=N,y(S))return M+R;for(;M.length<6;)M="0"+M;R=M+R}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function y(E){if(E.h!=0)return!1;for(let T=0;T<E.g.length;T++)if(E.g[T]!=0)return!1;return!0}function g(E){return E.h==-1}t.l=function(E){return E=w(this,E),g(E)?-1:y(E)?0:1};function A(E){const T=E.g.length,S=[];for(let R=0;R<T;R++)S[R]=~E.g[R];return new a(S,~E.h).add(d)}t.abs=function(){return g(this)?A(this):this},t.add=function(E){const T=Math.max(this.g.length,E.g.length),S=[];let R=0;for(let N=0;N<=T;N++){let M=R+(this.i(N)&65535)+(E.i(N)&65535),D=(M>>>16)+(this.i(N)>>>16)+(E.i(N)>>>16);R=D>>>16,M&=65535,D&=65535,S[N]=D<<16|M}return new a(S,S[S.length-1]&-2147483648?-1:0)};function w(E,T){return E.add(A(T))}t.j=function(E){if(y(this)||y(E))return h;if(g(this))return g(E)?A(this).j(A(E)):A(A(this).j(E));if(g(E))return A(this.j(A(E)));if(this.l(m)<0&&E.l(m)<0)return u(this.m()*E.m());const T=this.g.length+E.g.length,S=[];for(var R=0;R<2*T;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(let N=0;N<E.g.length;N++){const M=this.i(R)>>>16,D=this.i(R)&65535,Re=E.i(N)>>>16,Ie=E.i(N)&65535;S[2*R+2*N]+=D*Ie,x(S,2*R+2*N),S[2*R+2*N+1]+=M*Ie,x(S,2*R+2*N+1),S[2*R+2*N+1]+=D*Re,x(S,2*R+2*N+1),S[2*R+2*N+2]+=M*Re,x(S,2*R+2*N+2)}for(E=0;E<T;E++)S[E]=S[2*E+1]<<16|S[2*E];for(E=T;E<2*T;E++)S[E]=0;return new a(S,0)};function x(E,T){for(;(E[T]&65535)!=E[T];)E[T+1]+=E[T]>>>16,E[T]&=65535,T++}function I(E,T){this.g=E,this.h=T}function L(E,T){if(y(T))throw Error("division by zero");if(y(E))return new I(h,h);if(g(E))return T=L(A(E),T),new I(A(T.g),A(T.h));if(g(T))return T=L(E,A(T)),new I(A(T.g),T.h);if(E.g.length>30){if(g(E)||g(T))throw Error("slowDivide_ only works with positive integers.");for(var S=d,R=T;R.l(E)<=0;)S=W(S),R=W(R);var N=G(S,1),M=G(R,1);for(R=G(R,2),S=G(S,2);!y(R);){var D=M.add(R);D.l(E)<=0&&(N=N.add(S),M=D),R=G(R,1),S=G(S,1)}return T=w(E,N.j(T)),new I(N,T)}for(N=h;E.l(T)>=0;){for(S=Math.max(1,Math.floor(E.m()/T.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),M=u(S),D=M.j(T);g(D)||D.l(E)>0;)S-=R,M=u(S),D=M.j(T);y(M)&&(M=d),N=N.add(M),E=w(E,D)}return new I(N,E)}t.B=function(E){return L(this,E).h},t.and=function(E){const T=Math.max(this.g.length,E.g.length),S=[];for(let R=0;R<T;R++)S[R]=this.i(R)&E.i(R);return new a(S,this.h&E.h)},t.or=function(E){const T=Math.max(this.g.length,E.g.length),S=[];for(let R=0;R<T;R++)S[R]=this.i(R)|E.i(R);return new a(S,this.h|E.h)},t.xor=function(E){const T=Math.max(this.g.length,E.g.length),S=[];for(let R=0;R<T;R++)S[R]=this.i(R)^E.i(R);return new a(S,this.h^E.h)};function W(E){const T=E.g.length+1,S=[];for(let R=0;R<T;R++)S[R]=E.i(R)<<1|E.i(R-1)>>>31;return new a(S,E.h)}function G(E,T){const S=T>>5;T%=32;const R=E.g.length-S,N=[];for(let M=0;M<R;M++)N[M]=T>0?E.i(M+S)>>>T|E.i(M+S+1)<<32-T:E.i(M+S);return new a(N,E.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,KT=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,gs=a}).apply(typeof b_<"u"?b_:typeof self<"u"?self:typeof window<"u"?window:{});var Wc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qT,bl,XT,xf,Gp,YT,QT,JT;(function(){var t,e=Object.defineProperty;function r(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wc=="object"&&Wc];for(var p=0;p<c.length;++p){var _=c[p];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var n=r(this);function i(c,p){if(p)e:{var _=n;c=c.split(".");for(var k=0;k<c.length-1;k++){var H=c[k];if(!(H in _))break e;_=_[H]}c=c[c.length-1],k=_[c],p=p(k),p!=k&&p!=null&&e(_,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var _=[],k;for(k in p)Object.prototype.hasOwnProperty.call(p,k)&&_.push([k,p[k]]);return _}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function o(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,_){return c.call.apply(c.bind,arguments)}function u(c,p,_){return u=l,u.apply(null,arguments)}function f(c,p){var _=Array.prototype.slice.call(arguments,1);return function(){var k=_.slice();return k.push.apply(k,arguments),c.apply(this,k)}}function h(c,p){function _(){}_.prototype=p.prototype,c.Z=p.prototype,c.prototype=new _,c.prototype.constructor=c,c.Ob=function(k,H,Q){for(var ge=Array(arguments.length-2),be=2;be<arguments.length;be++)ge[be-2]=arguments[be];return p.prototype[H].apply(k,ge)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function m(c){const p=c.length;if(p>0){const _=Array(p);for(let k=0;k<p;k++)_[k]=c[k];return _}return[]}function y(c,p){for(let k=1;k<arguments.length;k++){const H=arguments[k];var _=typeof H;if(_=_!="object"?_:H?Array.isArray(H)?"array":_:"null",_=="array"||_=="object"&&typeof H.length=="number"){_=c.length||0;const Q=H.length||0;c.length=_+Q;for(let ge=0;ge<Q;ge++)c[_+ge]=H[ge]}else c.push(H)}}class g{constructor(p,_){this.i=p,this.j=_,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function A(c){a.setTimeout(()=>{throw c},0)}function w(){var c=E;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class x{constructor(){this.h=this.g=null}add(p,_){const k=I.get();k.set(p,_),this.h?this.h.next=k:this.g=k,this.h=k}}var I=new g(()=>new L,c=>c.reset());class L{constructor(){this.next=this.g=this.h=null}set(p,_){this.h=p,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let W,G=!1,E=new x,T=()=>{const c=Promise.resolve(void 0);W=()=>{c.then(S)}};function S(){for(var c;c=w();){try{c.h.call(c.g)}catch(_){A(_)}var p=I;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}G=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const _=()=>{};a.addEventListener("test",_,p),a.removeEventListener("test",_,p)}catch{}return c}();function D(c){return/^[\s\xa0]*$/.test(c)}function Re(c,p){N.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}h(Re,N),Re.prototype.init=function(c,p){const _=this.type=c.type,k=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(_=="mouseover"?p=c.fromElement:_=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Re.Z.h.call(this)},Re.prototype.h=function(){Re.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ie="closure_listenable_"+(Math.random()*1e6|0),nt=0;function Ke(c,p,_,k,H){this.listener=c,this.proxy=null,this.src=p,this.type=_,this.capture=!!k,this.ha=H,this.key=++nt,this.da=this.fa=!1}function he(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function J(c,p,_){for(const k in c)p.call(_,c[k],k,c)}function te(c,p){for(const _ in c)p.call(void 0,c[_],_,c)}function ce(c){const p={};for(const _ in c)p[_]=c[_];return p}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(c,p){let _,k;for(let H=1;H<arguments.length;H++){k=arguments[H];for(_ in k)c[_]=k[_];for(let Q=0;Q<V.length;Q++)_=V[Q],Object.prototype.hasOwnProperty.call(k,_)&&(c[_]=k[_])}}function B(c){this.src=c,this.g={},this.h=0}B.prototype.add=function(c,p,_,k,H){const Q=c.toString();c=this.g[Q],c||(c=this.g[Q]=[],this.h++);const ge=re(c,p,k,H);return ge>-1?(p=c[ge],_||(p.fa=!1)):(p=new Ke(p,this.src,Q,!!k,H),p.fa=_,c.push(p)),p};function j(c,p){const _=p.type;if(_ in c.g){var k=c.g[_],H=Array.prototype.indexOf.call(k,p,void 0),Q;(Q=H>=0)&&Array.prototype.splice.call(k,H,1),Q&&(he(p),c.g[_].length==0&&(delete c.g[_],c.h--))}}function re(c,p,_,k){for(let H=0;H<c.length;++H){const Q=c[H];if(!Q.da&&Q.listener==p&&Q.capture==!!_&&Q.ha==k)return H}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),Ae={};function Te(c,p,_,k,H){if(Array.isArray(p)){for(let Q=0;Q<p.length;Q++)Te(c,p[Q],_,k,H);return null}return _=$t(_),c&&c[Ie]?c.J(p,_,o(k)?!!k.capture:!1,H):ve(c,p,_,!1,k,H)}function ve(c,p,_,k,H,Q){if(!p)throw Error("Invalid event type");const ge=o(H)?!!H.capture:!!H;let be=Ye(c);if(be||(c[ye]=be=new B(c)),_=be.add(p,_,k,ge,Q),_.proxy)return _;if(k=$e(),_.proxy=k,k.src=c,k.listener=_,c.addEventListener)M||(H=ge),H===void 0&&(H=!1),c.addEventListener(p.toString(),k,H);else if(c.attachEvent)c.attachEvent(Ve(p.toString()),k);else if(c.addListener&&c.removeListener)c.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return _}function $e(){function c(_){return p.call(c.src,c.listener,_)}const p=Nt;return c}function ue(c,p,_,k,H){if(Array.isArray(p))for(var Q=0;Q<p.length;Q++)ue(c,p[Q],_,k,H);else k=o(k)?!!k.capture:!!k,_=$t(_),c&&c[Ie]?(c=c.i,Q=String(p).toString(),Q in c.g&&(p=c.g[Q],_=re(p,_,k,H),_>-1&&(he(p[_]),Array.prototype.splice.call(p,_,1),p.length==0&&(delete c.g[Q],c.h--)))):c&&(c=Ye(c))&&(p=c.g[p.toString()],c=-1,p&&(c=re(p,_,k,H)),(_=c>-1?p[c]:null)&&it(_))}function it(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ie])j(p.i,c);else{var _=c.type,k=c.proxy;p.removeEventListener?p.removeEventListener(_,k,c.capture):p.detachEvent?p.detachEvent(Ve(_),k):p.addListener&&p.removeListener&&p.removeListener(k),(_=Ye(p))?(j(_,c),_.h==0&&(_.src=null,p[ye]=null)):he(c)}}}function Ve(c){return c in Ae?Ae[c]:Ae[c]="on"+c}function Nt(c,p){if(c.da)c=!0;else{p=new Re(p,this);const _=c.listener,k=c.ha||c.src;c.fa&&it(c),c=_.call(k,p)}return c}function Ye(c){return c=c[ye],c instanceof B?c:null}var se="__closure_events_fn_"+(Math.random()*1e9>>>0);function $t(c){return typeof c=="function"?c:(c[se]||(c[se]=function(p){return c.handleEvent(p)}),c[se])}function De(){R.call(this),this.i=new B(this),this.M=this,this.G=null}h(De,R),De.prototype[Ie]=!0,De.prototype.removeEventListener=function(c,p,_,k){ue(this,c,p,_,k)};function at(c,p){var _,k=c.G;if(k)for(_=[];k;k=k.G)_.push(k);if(c=c.M,k=p.type||p,typeof p=="string")p=new N(p,c);else if(p instanceof N)p.target=p.target||c;else{var H=p;p=new N(k,c),z(p,H)}H=!0;let Q,ge;if(_)for(ge=_.length-1;ge>=0;ge--)Q=p.g=_[ge],H=vn(Q,k,!0,p)&&H;if(Q=p.g=c,H=vn(Q,k,!0,p)&&H,H=vn(Q,k,!1,p)&&H,_)for(ge=0;ge<_.length;ge++)Q=p.g=_[ge],H=vn(Q,k,!1,p)&&H}De.prototype.N=function(){if(De.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const _=c.g[p];for(let k=0;k<_.length;k++)he(_[k]);delete c.g[p],c.h--}}this.G=null},De.prototype.J=function(c,p,_,k){return this.i.add(String(c),p,!1,_,k)},De.prototype.K=function(c,p,_,k){return this.i.add(String(c),p,!0,_,k)};function vn(c,p,_,k){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let H=!0;for(let Q=0;Q<p.length;++Q){const ge=p[Q];if(ge&&!ge.da&&ge.capture==_){const be=ge.listener,Bt=ge.ha||ge.src;ge.fa&&j(c.i,ge),H=be.call(Bt,k)!==!1&&H}}return H&&!k.defaultPrevented}function dc(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:a.setTimeout(c,p||0)}function Ma(c){c.g=dc(()=>{c.g=null,c.i&&(c.i=!1,Ma(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class rn extends R{constructor(p,_){super(),this.m=p,this.l=_,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Ma(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Un(c){R.call(this),this.h=c,this.g={}}h(Un,R);var Va=[];function Ua(c){J(c.g,function(p,_){this.g.hasOwnProperty(_)&&it(p)},c),c.g={}}Un.prototype.N=function(){Un.Z.N.call(this),Ua(this)},Un.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _n=a.JSON.stringify,Fd=a.JSON.parse,pc=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function ol(){}function ll(){}var bi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ba(){N.call(this,"d")}h(Ba,N);function ja(){N.call(this,"c")}h(ja,N);var li={},mc=null;function Bs(){return mc=mc||new De}li.Ia="serverreachability";function ul(c){N.call(this,li.Ia,c)}h(ul,N);function Mi(c){const p=Bs();at(p,new ul(p))}li.STAT_EVENT="statevent";function gc(c,p){N.call(this,li.STAT_EVENT,c),this.stat=p}h(gc,N);function Zt(c){const p=Bs();at(p,new gc(p,c))}li.Ja="timingevent";function js(c,p){N.call(this,li.Ja,c),this.size=p}h(js,N);function zs(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},p)}function Ws(){this.g=!0}Ws.prototype.ua=function(){this.g=!1};function Ld(c,p,_,k,H,Q){c.info(function(){if(c.g)if(Q){var ge="",be=Q.split("&");for(let st=0;st<be.length;st++){var Bt=be[st].split("=");if(Bt.length>1){const Gt=Bt[0];Bt=Bt[1];const zn=Gt.split("_");ge=zn.length>=2&&zn[1]=="type"?ge+(Gt+"="+Bt+"&"):ge+(Gt+"=redacted&")}}}else ge=null;else ge=Q;return"XMLHTTP REQ ("+k+") [attempt "+H+"]: "+p+`
`+_+`
`+ge})}function bd(c,p,_,k,H,Q,ge){c.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+H+"]: "+p+`
`+_+`
`+Q+" "+ge})}function Vi(c,p,_,k){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Vd(c,_)+(k?" "+k:"")})}function Md(c,p){c.info(function(){return"TIMEOUT: "+p})}Ws.prototype.info=function(){};function Vd(c,p){if(!c.g)return p;if(!p)return null;try{const Q=JSON.parse(p);if(Q){for(c=0;c<Q.length;c++)if(Array.isArray(Q[c])){var _=Q[c];if(!(_.length<2)){var k=_[1];if(Array.isArray(k)&&!(k.length<1)){var H=k[0];if(H!="noop"&&H!="stop"&&H!="close")for(let ge=1;ge<k.length;ge++)k[ge]=""}}}}return _n(Q)}catch{return p}}var za={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Wa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vc;function cl(){}h(cl,ol),cl.prototype.g=function(){return new XMLHttpRequest},vc=new cl;function Hs(c){return encodeURIComponent(String(c))}function C(c){var p=1;c=c.split(":");const _=[];for(;p>0&&c.length;)_.push(c.shift()),p--;return c.length&&_.push(c.join(":")),_}function F(c,p,_,k){this.j=c,this.i=p,this.l=_,this.S=k||1,this.V=new Un(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new P}function P(){this.i=null,this.g="",this.h=!1}var O={},b={};function U(c,p,_){c.M=1,c.A=_c(jn(p)),c.u=_,c.R=!0,q(c,null)}function q(c,p){c.F=Date.now(),Y(c),c.B=jn(c.A);var _=c.B,k=c.S;Array.isArray(k)||(k=[String(k)]),U1(_.i,"t",k),c.C=0,_=c.j.L,c.h=new P,c.g=nv(c.j,_?p:null,!c.u),c.P>0&&(c.O=new rn(u(c.Y,c,c.g),c.P)),p=c.V,_=c.g,k=c.ba;var H="readystatechange";Array.isArray(H)||(H&&(Va[0]=H.toString()),H=Va);for(let Q=0;Q<H.length;Q++){const ge=Te(_,H[Q],k||p.handleEvent,!1,p.h||p);if(!ge)break;p.g[ge.key]=ge}p=c.J?ce(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),Mi(),Ld(c.i,c.v,c.B,c.l,c.S,c.u)}F.prototype.ba=function(c){c=c.target;const p=this.O;p&&zi(c)==3?p.j():this.Y(c)},F.prototype.Y=function(c){try{if(c==this.g)e:{const be=zi(this.g),Bt=this.g.ya(),st=this.g.ca();if(!(be<3)&&(be!=3||this.g&&(this.h.h||this.g.la()||G1(this.g)))){this.K||be!=4||Bt==7||(Bt==8||st<=0?Mi(3):Mi(2)),me(this);var p=this.g.ca();this.X=p;var _=ee(this);if(this.o=p==200,bd(this.i,this.v,this.B,this.l,this.S,be,p),this.o){if(this.U&&!this.L){t:{if(this.g){var k,H=this.g;if((k=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(k)){var Q=k;break t}}Q=null}if(c=Q)Vi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_e(this,c);else{this.o=!1,this.m=3,Zt(12),le(this),xe(this);break e}}if(this.R){c=!0;let Gt;for(;!this.K&&this.C<_.length;)if(Gt=X(this,_),Gt==b){be==4&&(this.m=4,Zt(14),c=!1),Vi(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==O){this.m=4,Zt(15),Vi(this.i,this.l,_,"[Invalid Chunk]"),c=!1;break}else Vi(this.i,this.l,Gt,null),_e(this,Gt);if(K(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||_.length!=0||this.h.h||(this.m=1,Zt(16),c=!1),this.o=this.o&&c,!c)Vi(this.i,this.l,_,"[Invalid Chunked Response]"),le(this),xe(this);else if(_.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),Hd(ge),ge.P=!0,Zt(11))}}else Vi(this.i,this.l,_,null),_e(this,_);be==4&&le(this),this.o&&!this.K&&(be==4?Z1(this.j,this):(this.o=!1,Y(this)))}else iC(this.g),p==400&&_.indexOf("Unknown SID")>0?(this.m=3,Zt(12)):(this.m=0,Zt(13)),le(this),xe(this)}}}catch{}finally{}};function ee(c){if(!K(c))return c.g.la();const p=G1(c.g);if(p==="")return"";let _="";const k=p.length,H=zi(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return le(c),xe(c),"";c.h.i=new a.TextDecoder}for(let Q=0;Q<k;Q++)c.h.h=!0,_+=c.h.i.decode(p[Q],{stream:!(H&&Q==k-1)});return p.length=0,c.h.g+=_,c.C=0,c.h.g}function K(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function X(c,p){var _=c.C,k=p.indexOf(`
`,_);return k==-1?b:(_=Number(p.substring(_,k)),isNaN(_)?O:(k+=1,k+_>p.length?b:(p=p.slice(k,k+_),c.C=k+_,p)))}F.prototype.cancel=function(){this.K=!0,le(this)};function Y(c){c.T=Date.now()+c.H,oe(c,c.H)}function oe(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=zs(u(c.aa,c),p)}function me(c){c.D&&(a.clearTimeout(c.D),c.D=null)}F.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Md(this.i,this.B),this.M!=2&&(Mi(),Zt(17)),le(this),this.m=2,xe(this)):oe(this,this.T-c)};function xe(c){c.j.I==0||c.K||Z1(c.j,c)}function le(c){me(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Ua(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function _e(c,p){try{var _=c.j;if(_.I!=0&&(_.g==c||ui(_.h,c))){if(!c.L&&ui(_.h,c)&&_.I==3){try{var k=_.Ba.g.parse(p)}catch{k=null}if(Array.isArray(k)&&k.length==3){var H=k;if(H[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<c.F)Tc(_),wc(_);else break e;Wd(_),Zt(18)}}else _.xa=H[1],0<_.xa-_.K&&H[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=zs(u(_.Va,_),6e3));Ut(_.h)<=1&&_.ta&&(_.ta=void 0)}else Gs(_,11)}else if((c.L||_.g==c)&&Tc(_),!D(p))for(H=_.Ba.g.parse(p),p=0;p<H.length;p++){let st=H[p];const Gt=st[0];if(!(Gt<=_.K))if(_.K=Gt,st=st[1],_.I==2)if(st[0]=="c"){_.M=st[1],_.ba=st[2];const zn=st[3];zn!=null&&(_.ka=zn,_.j.info("VER="+_.ka));const Ks=st[4];Ks!=null&&(_.za=Ks,_.j.info("SVER="+_.za));const Wi=st[5];Wi!=null&&typeof Wi=="number"&&Wi>0&&(k=1.5*Wi,_.O=k,_.j.info("backChannelRequestTimeoutMs_="+k)),k=_;const Hi=c.g;if(Hi){const Ac=Hi.g?Hi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ac){var Q=k.h;Q.g||Ac.indexOf("spdy")==-1&&Ac.indexOf("quic")==-1&&Ac.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(ci(Q,Q.h),Q.h=null))}if(k.G){const $d=Hi.g?Hi.g.getResponseHeader("X-HTTP-Session-Id"):null;$d&&(k.wa=$d,ht(k.J,k.G,$d))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-c.F,_.j.info("Handshake RTT: "+_.T+"ms")),k=_;var ge=c;if(k.na=rv(k,k.L?k.ba:null,k.W),ge.L){Ui(k.h,ge);var be=ge,Bt=k.O;Bt&&(be.H=Bt),be.D&&(me(be),Y(be)),k.g=ge}else Q1(k);_.i.length>0&&Ec(_)}else st[0]!="stop"&&st[0]!="close"||Gs(_,7);else _.I==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?Gs(_,7):zd(_):st[0]!="noop"&&_.l&&_.l.qa(st),_.A=0)}}Mi(4)}catch{}}var Oe=class{constructor(c,p){this.g=c,this.map=p}};function ot(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function lt(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ut(c){return c.h?1:c.g?c.g.size:0}function ui(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function ci(c,p){c.g?c.g.add(p):c.h=p}function Ui(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}ot.prototype.cancel=function(){if(this.i=Bn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Bn(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const _ of c.g.values())p=p.concat(_.G);return p}return m(c.i)}var Ha=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yn(c,p){if(c){c=c.split("&");for(let _=0;_<c.length;_++){const k=c[_].indexOf("=");let H,Q=null;k>=0?(H=c[_].substring(0,k),Q=c[_].substring(k+1)):H=c[_],p(H,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function Bi(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof Bi?(this.l=c.l,fl(this,c.j),this.o=c.o,this.g=c.g,hl(this,c.u),this.h=c.h,Ud(this,B1(c.i)),this.m=c.m):c&&(p=String(c).match(Ha))?(this.l=!1,fl(this,p[1]||"",!0),this.o=dl(p[2]||""),this.g=dl(p[3]||"",!0),hl(this,p[4]),this.h=dl(p[5]||"",!0),Ud(this,p[6]||"",!0),this.m=dl(p[7]||"")):(this.l=!1,this.i=new ml(null,this.l))}Bi.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(pl(p,L1,!0),":");var _=this.g;return(_||p=="file")&&(c.push("//"),(p=this.o)&&c.push(pl(p,L1,!0),"@"),c.push(Hs(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&c.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&c.push("/"),c.push(pl(_,_.charAt(0)=="/"?XI:qI,!0))),(_=this.i.toString())&&c.push("?",_),(_=this.m)&&c.push("#",pl(_,QI)),c.join("")},Bi.prototype.resolve=function(c){const p=jn(this);let _=!!c.j;_?fl(p,c.j):_=!!c.o,_?p.o=c.o:_=!!c.g,_?p.g=c.g:_=c.u!=null;var k=c.h;if(_)hl(p,c.u);else if(_=!!c.h){if(k.charAt(0)!="/")if(this.g&&!this.h)k="/"+k;else{var H=p.h.lastIndexOf("/");H!=-1&&(k=p.h.slice(0,H+1)+k)}if(H=k,H==".."||H==".")k="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){k=H.lastIndexOf("/",0)==0,H=H.split("/");const Q=[];for(let ge=0;ge<H.length;){const be=H[ge++];be=="."?k&&ge==H.length&&Q.push(""):be==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),k&&ge==H.length&&Q.push("")):(Q.push(be),k=!0)}k=Q.join("/")}else k=H}return _?p.h=k:_=c.i.toString()!=="",_?Ud(p,B1(c.i)):_=!!c.m,_&&(p.m=c.m),p};function jn(c){return new Bi(c)}function fl(c,p,_){c.j=_?dl(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function hl(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Ud(c,p,_){p instanceof ml?(c.i=p,JI(c.i,c.l)):(_||(p=pl(p,YI)),c.i=new ml(p,c.l))}function ht(c,p,_){c.i.set(p,_)}function _c(c){return ht(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function dl(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function pl(c,p,_){return typeof c=="string"?(c=encodeURI(c).replace(p,KI),_&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function KI(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var L1=/[#\/\?@]/g,qI=/[#\?:]/g,XI=/[#\?]/g,YI=/[#\?@]/g,QI=/#/g;function ml(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function $s(c){c.g||(c.g=new Map,c.h=0,c.i&&yn(c.i,function(p,_){c.add(decodeURIComponent(p.replace(/\+/g," ")),_)}))}t=ml.prototype,t.add=function(c,p){$s(this),this.i=null,c=$a(this,c);let _=this.g.get(c);return _||this.g.set(c,_=[]),_.push(p),this.h+=1,this};function b1(c,p){$s(c),p=$a(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function M1(c,p){return $s(c),p=$a(c,p),c.g.has(p)}t.forEach=function(c,p){$s(this),this.g.forEach(function(_,k){_.forEach(function(H){c.call(p,H,k,this)},this)},this)};function V1(c,p){$s(c);let _=[];if(typeof p=="string")M1(c,p)&&(_=_.concat(c.g.get($a(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)_=_.concat(c[p]);return _}t.set=function(c,p){return $s(this),this.i=null,c=$a(this,c),M1(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=V1(this,c),c.length>0?String(c[0]):p):p};function U1(c,p,_){b1(c,p),_.length>0&&(c.i=null,c.g.set($a(c,p),m(_)),c.h+=_.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let k=0;k<p.length;k++){var _=p[k];const H=Hs(_);_=V1(this,_);for(let Q=0;Q<_.length;Q++){let ge=H;_[Q]!==""&&(ge+="="+Hs(_[Q])),c.push(ge)}}return this.i=c.join("&")};function B1(c){const p=new ml;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function $a(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function JI(c,p){p&&!c.j&&($s(c),c.i=null,c.g.forEach(function(_,k){const H=k.toLowerCase();k!=H&&(b1(this,k),U1(this,H,_))},c)),c.j=p}function ZI(c,p){const _=new Ws;if(a.Image){const k=new Image;k.onload=f(ji,_,"TestLoadImage: loaded",!0,p,k),k.onerror=f(ji,_,"TestLoadImage: error",!1,p,k),k.onabort=f(ji,_,"TestLoadImage: abort",!1,p,k),k.ontimeout=f(ji,_,"TestLoadImage: timeout",!1,p,k),a.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=c}else p(!1)}function eC(c,p){const _=new Ws,k=new AbortController,H=setTimeout(()=>{k.abort(),ji(_,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:k.signal}).then(Q=>{clearTimeout(H),Q.ok?ji(_,"TestPingServer: ok",!0,p):ji(_,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(H),ji(_,"TestPingServer: error",!1,p)})}function ji(c,p,_,k,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),k(_)}catch{}}function tC(){this.g=new pc}function Bd(c){this.i=c.Sb||null,this.h=c.ab||!1}h(Bd,ol),Bd.prototype.g=function(){return new yc(this.i,this.h)};function yc(c,p){De.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(yc,De),t=yc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,vl(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||a).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,gl(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,vl(this)),this.g&&(this.readyState=3,vl(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;j1(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function j1(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?gl(this):vl(this),this.readyState==3&&j1(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,gl(this))},t.Na=function(c){this.g&&(this.response=c,gl(this))},t.ga=function(){this.g&&gl(this)};function gl(c){c.readyState=4,c.l=null,c.j=null,c.B=null,vl(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var _=p.next();!_.done;)_=_.value,c.push(_[0]+": "+_[1]),_=p.next();return c.join(`\r
`)};function vl(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(yc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function z1(c){let p="";return J(c,function(_,k){p+=k,p+=":",p+=_,p+=`\r
`}),p}function jd(c,p,_){e:{for(k in _){var k=!1;break e}k=!0}k||(_=z1(_),typeof c=="string"?_!=null&&Hs(_):ht(c,p,_))}function Et(c){De.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Et,De);var rC=/^https?$/i,nC=["POST","PUT"];t=Et.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,_,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vc.g(),this.g.onreadystatechange=d(u(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(Q){W1(this,Q);return}if(c=_||"",_=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var H in k)_.set(H,k[H]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const Q of k.keys())_.set(Q,k.get(Q));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(_.keys()).find(Q=>Q.toLowerCase()=="content-type"),H=a.FormData&&c instanceof a.FormData,!(Array.prototype.indexOf.call(nC,p,void 0)>=0)||k||H||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,ge]of _)this.g.setRequestHeader(Q,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(Q){W1(this,Q)}};function W1(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,H1(c),xc(c)}function H1(c){c.A||(c.A=!0,at(c,"complete"),at(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,at(this,"complete"),at(this,"abort"),xc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xc(this,!0)),Et.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?$1(this):this.Xa())},t.Xa=function(){$1(this)};function $1(c){if(c.h&&typeof s<"u"){if(c.v&&zi(c)==4)setTimeout(c.Ca.bind(c),0);else if(at(c,"readystatechange"),zi(c)==4){c.h=!1;try{const Q=c.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var _;if(!(_=p)){var k;if(k=Q===0){let ge=String(c.D).match(Ha)[1]||null;!ge&&a.self&&a.self.location&&(ge=a.self.location.protocol.slice(0,-1)),k=!rC.test(ge?ge.toLowerCase():"")}_=k}if(_)at(c,"complete"),at(c,"success");else{c.o=6;try{var H=zi(c)>2?c.g.statusText:""}catch{H=""}c.l=H+" ["+c.ca()+"]",H1(c)}}finally{xc(c)}}}}function xc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const _=c.g;c.g=null,p||at(c,"ready");try{_.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function zi(c){return c.g?c.g.readyState:0}t.ca=function(){try{return zi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Fd(p)}};function G1(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function iC(c){const p={};c=(c.g&&zi(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<c.length;k++){if(D(c[k]))continue;var _=C(c[k]);const H=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const Q=p[H]||[];p[H]=Q,Q.push(_)}te(p,function(k){return k.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _l(c,p,_){return _&&_.internalChannelParams&&_.internalChannelParams[c]||p}function K1(c){this.za=0,this.i=[],this.j=new Ws,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_l("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_l("baseRetryDelayMs",5e3,c),this.Za=_l("retryDelaySeedMs",1e4,c),this.Ta=_l("forwardChannelMaxRetries",2,c),this.va=_l("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new ot(c&&c.concurrentRequestLimit),this.Ba=new tC,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=K1.prototype,t.ka=8,t.I=1,t.connect=function(c,p,_,k){Zt(0),this.W=c,this.H=p||{},_&&k!==void 0&&(this.H.OSID=_,this.H.OAID=k),this.F=this.X,this.J=rv(this,null,this.W),Ec(this)};function zd(c){if(q1(c),c.I==3){var p=c.V++,_=jn(c.J);if(ht(_,"SID",c.M),ht(_,"RID",p),ht(_,"TYPE","terminate"),yl(c,_),p=new F(c,c.j,p),p.M=2,p.A=_c(jn(_)),_=!1,a.navigator&&a.navigator.sendBeacon)try{_=a.navigator.sendBeacon(p.A.toString(),"")}catch{}!_&&a.Image&&(new Image().src=p.A,_=!0),_||(p.g=nv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Y(p)}tv(c)}function wc(c){c.g&&(Hd(c),c.g.cancel(),c.g=null)}function q1(c){wc(c),c.v&&(a.clearTimeout(c.v),c.v=null),Tc(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&a.clearTimeout(c.m),c.m=null)}function Ec(c){if(!lt(c.h)&&!c.m){c.m=!0;var p=c.Ea;W||T(),G||(W(),G=!0),E.add(p,c),c.D=0}}function sC(c,p){return Ut(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=zs(u(c.Ea,c,p),ev(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const H=new F(this,this.j,c);let Q=this.o;if(this.U&&(Q?(Q=ce(Q),z(Q,this.U)):Q=this.U),this.u!==null||this.R||(H.J=Q,Q=null),this.S)e:{for(var p=0,_=0;_<this.i.length;_++){t:{var k=this.i[_];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(p+=k,p>4096){p=_;break e}if(p===4096||_===this.i.length-1){p=_+1;break e}}p=1e3}else p=1e3;p=Y1(this,H,p),_=jn(this.J),ht(_,"RID",c),ht(_,"CVER",22),this.G&&ht(_,"X-HTTP-Session-Id",this.G),yl(this,_),Q&&(this.R?p="headers="+Hs(z1(Q))+"&"+p:this.u&&jd(_,this.u,Q)),ci(this.h,H),this.Ra&&ht(_,"TYPE","init"),this.S?(ht(_,"$req",p),ht(_,"SID","null"),H.U=!0,U(H,_,null)):U(H,_,p),this.I=2}}else this.I==3&&(c?X1(this,c):this.i.length==0||lt(this.h)||X1(this))};function X1(c,p){var _;p?_=p.l:_=c.V++;const k=jn(c.J);ht(k,"SID",c.M),ht(k,"RID",_),ht(k,"AID",c.K),yl(c,k),c.u&&c.o&&jd(k,c.u,c.o),_=new F(c,c.j,_,c.D+1),c.u===null&&(_.J=c.o),p&&(c.i=p.G.concat(c.i)),p=Y1(c,_,1e3),_.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),ci(c.h,_),U(_,k,p)}function yl(c,p){c.H&&J(c.H,function(_,k){ht(p,k,_)}),c.l&&J({},function(_,k){ht(p,k,_)})}function Y1(c,p,_){_=Math.min(c.i.length,_);const k=c.l?u(c.l.Ka,c.l,c):null;e:{var H=c.i;let be=-1;for(;;){const Bt=["count="+_];be==-1?_>0?(be=H[0].g,Bt.push("ofs="+be)):be=0:Bt.push("ofs="+be);let st=!0;for(let Gt=0;Gt<_;Gt++){var Q=H[Gt].g;const zn=H[Gt].map;if(Q-=be,Q<0)be=Math.max(0,H[Gt].g-100),st=!1;else try{Q="req"+Q+"_"||"";try{var ge=zn instanceof Map?zn:Object.entries(zn);for(const[Ks,Wi]of ge){let Hi=Wi;o(Wi)&&(Hi=_n(Wi)),Bt.push(Q+Ks+"="+encodeURIComponent(Hi))}}catch(Ks){throw Bt.push(Q+"type="+encodeURIComponent("_badmap")),Ks}}catch{k&&k(zn)}}if(st){ge=Bt.join("&");break e}}ge=void 0}return c=c.i.splice(0,_),p.G=c,ge}function Q1(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;W||T(),G||(W(),G=!0),E.add(p,c),c.A=0}}function Wd(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=zs(u(c.Da,c),ev(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,J1(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=zs(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Zt(10),wc(this),J1(this))};function Hd(c){c.B!=null&&(a.clearTimeout(c.B),c.B=null)}function J1(c){c.g=new F(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=jn(c.na);ht(p,"RID","rpc"),ht(p,"SID",c.M),ht(p,"AID",c.K),ht(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ht(p,"TO",c.ia),ht(p,"TYPE","xmlhttp"),yl(c,p),c.u&&c.o&&jd(p,c.u,c.o),c.O&&(c.g.H=c.O);var _=c.g;c=c.ba,_.M=1,_.A=_c(jn(p)),_.u=null,_.R=!0,q(_,c)}t.Va=function(){this.C!=null&&(this.C=null,wc(this),Wd(this),Zt(19))};function Tc(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Z1(c,p){var _=null;if(c.g==p){Tc(c),Hd(c),c.g=null;var k=2}else if(ui(c.h,p))_=p.G,Ui(c.h,p),k=1;else return;if(c.I!=0){if(p.o)if(k==1){_=p.u?p.u.length:0,p=Date.now()-p.F;var H=c.D;k=Bs(),at(k,new js(k,_)),Ec(c)}else Q1(c);else if(H=p.m,H==3||H==0&&p.X>0||!(k==1&&sC(c,p)||k==2&&Wd(c)))switch(_&&_.length>0&&(p=c.h,p.i=p.i.concat(_)),H){case 1:Gs(c,5);break;case 4:Gs(c,10);break;case 3:Gs(c,6);break;default:Gs(c,2)}}}function ev(c,p){let _=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(_*=2),_*p}function Gs(c,p){if(c.j.info("Error code "+p),p==2){var _=u(c.bb,c),k=c.Ua;const H=!k;k=new Bi(k||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||fl(k,"https"),_c(k),H?ZI(k.toString(),_):eC(k.toString(),_)}else Zt(2);c.I=0,c.l&&c.l.pa(p),tv(c),q1(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function tv(c){if(c.I=0,c.ja=[],c.l){const p=Bn(c.h);(p.length!=0||c.i.length!=0)&&(y(c.ja,p),y(c.ja,c.i),c.h.i.length=0,m(c.i),c.i.length=0),c.l.oa()}}function rv(c,p,_){var k=_ instanceof Bi?jn(_):new Bi(_);if(k.g!="")p&&(k.g=p+"."+k.g),hl(k,k.u);else{var H=a.location;k=H.protocol,p=p?p+"."+H.hostname:H.hostname,H=+H.port;const Q=new Bi(null);k&&fl(Q,k),p&&(Q.g=p),H&&hl(Q,H),_&&(Q.h=_),k=Q}return _=c.G,p=c.wa,_&&p&&ht(k,_,p),ht(k,"VER",c.ka),yl(c,k),k}function nv(c,p,_){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new Et(new Bd({ab:_})):new Et(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function iv(){}t=iv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Sc(){}Sc.prototype.g=function(c,p){return new zr(c,p)};function zr(c,p){De.call(this),this.g=new K1(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!D(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!D(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Ga(this)}h(zr,De),zr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},zr.prototype.close=function(){zd(this.g)},zr.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var _={};_.__data__=c,c=_}else this.v&&(_={},_.__data__=_n(c),c=_);p.i.push(new Oe(p.Ya++,c)),p.I==3&&Ec(p)},zr.prototype.N=function(){this.g.l=null,delete this.j,zd(this.g),delete this.g,zr.Z.N.call(this)};function sv(c){Ba.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const _ in p){c=_;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}h(sv,Ba);function av(){ja.call(this),this.status=1}h(av,ja);function Ga(c){this.g=c}h(Ga,iv),Ga.prototype.ra=function(){at(this.g,"a")},Ga.prototype.qa=function(c){at(this.g,new sv(c))},Ga.prototype.pa=function(c){at(this.g,new av)},Ga.prototype.oa=function(){at(this.g,"b")},Sc.prototype.createWebChannel=Sc.prototype.g,zr.prototype.send=zr.prototype.o,zr.prototype.open=zr.prototype.m,zr.prototype.close=zr.prototype.close,JT=function(){return new Sc},QT=function(){return Bs()},YT=li,Gp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},za.NO_ERROR=0,za.TIMEOUT=8,za.HTTP_ERROR=6,xf=za,Wa.COMPLETE="complete",XT=Wa,ll.EventType=bi,bi.OPEN="a",bi.CLOSE="b",bi.ERROR="c",bi.MESSAGE="d",De.prototype.listen=De.prototype.J,bl=ll,Et.prototype.listenOnce=Et.prototype.K,Et.prototype.getLastError=Et.prototype.Ha,Et.prototype.getLastErrorCode=Et.prototype.ya,Et.prototype.getStatus=Et.prototype.ca,Et.prototype.getResponseJson=Et.prototype.La,Et.prototype.getResponseText=Et.prototype.la,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Fa,qT=Et}).apply(typeof Wc<"u"?Wc:typeof self<"u"?self:typeof window<"u"?window:{});const M_="@firebase/firestore",V_="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};mr.UNAUTHENTICATED=new mr(null),mr.GOOGLE_CREDENTIALS=new mr("google-credentials-uid"),mr.FIRST_PARTY=new mr("first-party-uid"),mr.MOCK_USER=new mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va=new td("@firebase/firestore");function Za(){return va.logLevel}function Ee(t,...e){if(va.logLevel<=Be.DEBUG){const r=e.map(Eg);va.debug(`Firestore (${Jo}): ${t}`,...r)}}function Ri(t,...e){if(va.logLevel<=Be.ERROR){const r=e.map(Eg);va.error(`Firestore (${Jo}): ${t}`,...r)}}function Bo(t,...e){if(va.logLevel<=Be.WARN){const r=e.map(Eg);va.warn(`Firestore (${Jo}): ${t}`,...r)}}function Eg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,ZT(t,n,r)}function ZT(t,e,r){let n=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ri(n),new Error(n)}function Xe(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||ZT(e,i,n)}function Le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends mn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class UN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(mr.UNAUTHENTICATED))}shutdown(){}}class BN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class jN{constructor(e){this.t=e,this.currentUser=mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xe(this.o===void 0,42304);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new vs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vs,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vs)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xe(typeof n.accessToken=="string",31837,{l:n}),new e2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xe(e===null||typeof e=="string",2055,{h:e}),new mr(e)}}class zN{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=mr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class WN{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new zN(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class U_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HN{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Xe(this.o===void 0,3512);const n=s=>{s.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ee("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new U_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Xe(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new U_(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $N(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=$N(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%62))}return n}}function je(t,e){return t<e?-1:t>e?1:0}function Kp(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),s=e.charAt(n);if(i!==s)return I0(i)===I0(s)?je(i,s):I0(i)?1:-1}return je(t.length,e.length)}const GN=55296,KN=57343;function I0(t){const e=t.charCodeAt(0);return e>=GN&&e<=KN}function jo(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="__name__";class Kn{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ne(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ne(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Kn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Kn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=Kn.compareSegments(e.get(i),r.get(i));if(s!==0)return s}return je(e.length,r.length)}static compareSegments(e,r){const n=Kn.isNumericId(e),i=Kn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Kn.extractNumericId(e).compare(Kn.extractNumericId(r)):Kp(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gs.fromString(e.substring(4,e.length-2))}}class ut extends Kn{construct(e,r,n){return new ut(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new we(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new ut(r)}static emptyPath(){return new ut([])}}const qN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ir extends Kn{construct(e,r,n){return new ir(e,r,n)}static isValidIdentifier(e){return qN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ir.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===B_}static keyField(){return new ir([B_])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new we(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new we(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new we(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new we(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ir(r)}static emptyPath(){return new ir([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.path=e}static fromPath(e){return new Ce(ut.fromString(e))}static fromName(e){return new Ce(ut.fromString(e).popFirst(5))}static empty(){return new Ce(ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ut.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ce(new ut(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t,e,r){if(!r)throw new we(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function XN(t,e,r,n){if(e===!0&&n===!0)throw new we(ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function j_(t){if(!Ce.isDocumentKey(t))throw new we(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function z_(t){if(Ce.isDocumentKey(t))throw new we(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function r2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function sd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ne(12329,{type:typeof t})}function Qn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=sd(t);throw new we(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t,e){const r={typeString:t};return e&&(r.value=e),r}function Xu(t,e){if(!r2(t))throw new we(ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new we(ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_=-62135596800,H_=1e6;class ct{static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*H_);return new ct(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new we(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new we(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<W_)throw new we(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/H_}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ct._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Xu(e,ct._jsonSchema))return new ct(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-W_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ct._jsonSchemaVersion="firestore/timestamp/1.0",ct._jsonSchema={type:bt("string",ct._jsonSchemaVersion),seconds:bt("number"),nanoseconds:bt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{static fromTimestamp(e){return new Fe(e)}static min(){return new Fe(new ct(0,0))}static max(){return new Fe(new ct(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=-1;function YN(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Fe.fromTimestamp(n===1e9?new ct(r+1,0):new ct(r,n));return new Es(i,Ce.empty(),e)}function QN(t){return new Es(t.readTime,t.key,Ru)}class Es{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Es(Fe.min(),Ce.empty(),Ru)}static max(){return new Es(Fe.max(),Ce.empty(),Ru)}}function JN(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ce.comparator(t.documentKey,e.documentKey),r!==0?r:je(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class e3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==ZN)throw t;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ie?r:ie.resolve(r)}catch(r){return ie.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ie.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ie.reject(r)}static resolve(e){return new ie((r,n)=>{r(e)})}static reject(e){return new ie((r,n)=>{n(e)})}static waitFor(e){return new ie((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=ie.resolve(!1);for(const n of e)r=r.next(i=>i?ie.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new ie((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new ie((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function t3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function el(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ad.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sg=-1;function od(t){return t==null}function ih(t){return t===0&&1/t==-1/0}function r3(t){return typeof t=="number"&&Number.isInteger(t)&&!ih(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2="";function n3(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=$_(e)),e=i3(t.get(r),e);return $_(e)}function i3(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const s=t.charAt(i);switch(s){case"\0":r+="";break;case n2:r+="";break;default:r+=s}}return r}function $_(t){return t+n2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ls(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function i2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,r){this.comparator=e,this.root=r||nr.EMPTY}insert(e,r){return new wt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,nr.BLACK,null,null))}remove(e){return new wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hc(this.root,e,this.comparator,!0)}}class Hc{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??nr.RED,this.left=i??nr.EMPTY,this.right=s??nr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new nr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return nr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}nr.EMPTY=null,nr.RED=!0,nr.BLACK=!1;nr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,r,n,i,s){return this}insert(e,r,n){return new nr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new K_(this.data.getIterator())}getIteratorFrom(e){return new K_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ht(this.comparator);return r.data=e,r}}class K_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.fields=e,e.sort(ir.comparator)}static empty(){return new Xr([])}unionWith(e){let r=new Ht(ir.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Xr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return jo(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new s2("Invalid base64 string: "+s):s}}(e);return new cr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new cr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cr.EMPTY_BYTE_STRING=new cr("");const s3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ts(t){if(Xe(!!t,39018),typeof t=="string"){let e=0;const r=s3.exec(t);if(Xe(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Rt(t.seconds),nanos:Rt(t.nanos)}}function Rt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ss(t){return typeof t=="string"?cr.fromBase64String(t):cr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="server_timestamp",o2="__type__",l2="__previous_value__",u2="__local_write_time__";function Ag(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[o2])==null?void 0:n.stringValue)===a2}function ld(t){const e=t.mapValue.fields[l2];return Ag(e)?ld(e):e}function ku(t){const e=Ts(t.mapValue.fields[u2].timestampValue);return new ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,r,n,i,s,a,o,l,u,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const sh="(default)";class Pu{constructor(e,r){this.projectId=e,this.database=r||sh}static empty(){return new Pu("","")}get isDefaultDatabase(){return this.database===sh}isEqual(e){return e instanceof Pu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="__type__",o3="__max__",$c={mapValue:{}},f2="__vector__",ah="value";function As(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ag(t)?4:u3(t)?9007199254740991:l3(t)?10:11:Ne(28295,{value:t})}function ii(t,e){if(t===e)return!0;const r=As(t);if(r!==As(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ku(t).isEqual(ku(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ts(i.timestampValue),o=Ts(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ss(i.bytesValue).isEqual(Ss(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Rt(i.geoPointValue.latitude)===Rt(s.geoPointValue.latitude)&&Rt(i.geoPointValue.longitude)===Rt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Rt(i.integerValue)===Rt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Rt(i.doubleValue),o=Rt(s.doubleValue);return a===o?ih(a)===ih(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return jo(t.arrayValue.values||[],e.arrayValue.values||[],ii);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(G_(a)!==G_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ii(a[l],o[l])))return!1;return!0}(t,e);default:return Ne(52216,{left:t})}}function Nu(t,e){return(t.values||[]).find(r=>ii(r,e))!==void 0}function zo(t,e){if(t===e)return 0;const r=As(t),n=As(e);if(r!==n)return je(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return je(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Rt(s.integerValue||s.doubleValue),l=Rt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return q_(t.timestampValue,e.timestampValue);case 4:return q_(ku(t),ku(e));case 5:return Kp(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Ss(s),l=Ss(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=je(o[u],l[u]);if(f!==0)return f}return je(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=je(Rt(s.latitude),Rt(a.latitude));return o!==0?o:je(Rt(s.longitude),Rt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return X_(t.arrayValue,e.arrayValue);case 10:return function(s,a){var d,m,y,g;const o=s.fields||{},l=a.fields||{},u=(d=o[ah])==null?void 0:d.arrayValue,f=(m=l[ah])==null?void 0:m.arrayValue,h=je(((y=u==null?void 0:u.values)==null?void 0:y.length)||0,((g=f==null?void 0:f.values)==null?void 0:g.length)||0);return h!==0?h:X_(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===$c.mapValue&&a===$c.mapValue)return 0;if(s===$c.mapValue)return 1;if(a===$c.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=Kp(l[h],f[h]);if(d!==0)return d;const m=zo(o[l[h]],u[f[h]]);if(m!==0)return m}return je(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Ne(23264,{he:r})}}function q_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return je(t,e);const r=Ts(t),n=Ts(e),i=je(r.seconds,n.seconds);return i!==0?i:je(r.nanos,n.nanos)}function X_(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=zo(r[i],n[i]);if(s)return s}return je(r.length,n.length)}function Wo(t){return qp(t)}function qp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ts(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ss(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ce.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=qp(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${qp(r.fields[a])}`;return i+"}"}(t.mapValue):Ne(61005,{value:t})}function wf(t){switch(As(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ld(t);return e?16+wf(e):16;case 5:return 2*t.stringValue.length;case 6:return Ss(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+wf(s),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Ls(n.fields,(s,a)=>{i+=s.length+wf(a)}),i}(t.mapValue);default:throw Ne(13486,{value:t})}}function Y_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Xp(t){return!!t&&"integerValue"in t}function Ig(t){return!!t&&"arrayValue"in t}function Q_(t){return!!t&&"nullValue"in t}function J_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ef(t){return!!t&&"mapValue"in t}function l3(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[c2])==null?void 0:n.stringValue)===f2}function Ql(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ls(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ql(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ql(t.arrayValue.values[r]);return e}return{...t}}function u3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===o3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.value=e}static empty(){return new Or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Ef(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ql(r)}setAll(e){let r=ir.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Ql(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Ef(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ii(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Ef(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ls(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Or(Ql(this.value))}}function h2(t){const e=[];return Ls(t.fields,(r,n)=>{const i=new ir([r]);if(Ef(n)){const s=h2(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new vr(e,0,Fe.min(),Fe.min(),Fe.min(),Or.empty(),0)}static newFoundDocument(e,r,n,i){return new vr(e,1,r,Fe.min(),n,i,0)}static newNoDocument(e,r){return new vr(e,2,r,Fe.min(),Fe.min(),Or.empty(),0)}static newUnknownDocument(e,r){return new vr(e,3,r,Fe.min(),Fe.min(),Or.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,r){this.position=e,this.inclusive=r}}function Z_(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Ce.comparator(Ce.fromName(a.referenceValue),r.key):n=zo(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function ey(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ii(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,r="asc"){this.field=e,this.dir=r}}function c3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d2=class{};class Lt extends d2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new h3(e,r,n):r==="array-contains"?new m3(e,n):r==="in"?new g3(e,n):r==="not-in"?new v3(e,n):r==="array-contains-any"?new _3(e,n):new Lt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new d3(e,n):new p3(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(zo(r,this.value)):r!==null&&As(this.value)===As(r)&&this.matchesComparison(zo(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vn extends d2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Vn(e,r)}matches(e){return p2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function p2(t){return t.op==="and"}function m2(t){return f3(t)&&p2(t)}function f3(t){for(const e of t.filters)if(e instanceof Vn)return!1;return!0}function Yp(t){if(t instanceof Lt)return t.field.canonicalString()+t.op.toString()+Wo(t.value);if(m2(t))return t.filters.map(e=>Yp(e)).join(",");{const e=t.filters.map(r=>Yp(r)).join(",");return`${t.op}(${e})`}}function g2(t,e){return t instanceof Lt?function(n,i){return i instanceof Lt&&n.op===i.op&&n.field.isEqual(i.field)&&ii(n.value,i.value)}(t,e):t instanceof Vn?function(n,i){return i instanceof Vn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&g2(a,i.filters[o]),!0):!1}(t,e):void Ne(19439)}function v2(t){return t instanceof Lt?function(r){return`${r.field.canonicalString()} ${r.op} ${Wo(r.value)}`}(t):t instanceof Vn?function(r){return r.op.toString()+" {"+r.getFilters().map(v2).join(" ,")+"}"}(t):"Filter"}class h3 extends Lt{constructor(e,r,n){super(e,r,n),this.key=Ce.fromName(n.referenceValue)}matches(e){const r=Ce.comparator(e.key,this.key);return this.matchesComparison(r)}}class d3 extends Lt{constructor(e,r){super(e,"in",r),this.keys=_2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class p3 extends Lt{constructor(e,r){super(e,"not-in",r),this.keys=_2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function _2(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Ce.fromName(n.referenceValue))}class m3 extends Lt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Ig(r)&&Nu(r.arrayValue,this.value)}}class g3 extends Lt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Nu(this.value.arrayValue,r)}}class v3 extends Lt{constructor(e,r){super(e,"not-in",r)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Nu(this.value.arrayValue,r)}}class _3 extends Lt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Ig(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Nu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function ty(t,e=null,r=[],n=[],i=null,s=null,a=null){return new y3(t,e,r,n,i,s,a)}function Cg(t){const e=Le(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Yp(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),od(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Wo(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Wo(n)).join(",")),e.Te=r}return e.Te}function Rg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!c3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!g2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ey(t.startAt,e.startAt)&&ey(t.endAt,e.endAt)}function Qp(t){return Ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function x3(t,e,r,n,i,s,a,o){return new Yu(t,e,r,n,i,s,a,o)}function kg(t){return new Yu(t)}function ry(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function y2(t){return t.collectionGroup!==null}function Jl(t){const e=Le(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ht(ir.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new lh(s,n))}),r.has(ir.keyField().canonicalString())||e.Ie.push(new lh(ir.keyField(),n))}return e.Ie}function Jn(t){const e=Le(t);return e.Ee||(e.Ee=w3(e,Jl(t))),e.Ee}function w3(t,e){if(t.limitType==="F")return ty(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new lh(i.field,s)});const r=t.endAt?new oh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new oh(t.startAt.position,t.startAt.inclusive):null;return ty(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Jp(t,e){const r=t.filters.concat([e]);return new Yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Zp(t,e,r){return new Yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ud(t,e){return Rg(Jn(t),Jn(e))&&t.limitType===e.limitType}function x2(t){return`${Cg(Jn(t))}|lt:${t.limitType}`}function eo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>v2(i)).join(", ")}]`),od(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Wo(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Wo(i)).join(",")),`Target(${n})`}(Jn(t))}; limitType=${t.limitType})`}function cd(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Ce.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Jl(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=Z_(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Jl(n),i)||n.endAt&&!function(a,o,l){const u=Z_(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Jl(n),i))}(t,e)}function E3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function w2(t){return(e,r)=>{let n=!1;for(const i of Jl(t)){const s=T3(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function T3(t,e,r){const n=t.field.isKeyField()?Ce.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?zo(l,u):Ne(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ne(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ls(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return i2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=new wt(Ce.comparator);function ki(){return S3}const E2=new wt(Ce.comparator);function Ml(...t){let e=E2;for(const r of t)e=e.insert(r.key,r);return e}function T2(t){let e=E2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function na(){return Zl()}function S2(){return Zl()}function Zl(){return new ka(t=>t.toString(),(t,e)=>t.isEqual(e))}const A3=new wt(Ce.comparator),I3=new Ht(Ce.comparator);function ze(...t){let e=I3;for(const r of t)e=e.add(r);return e}const C3=new Ht(je);function R3(){return C3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ih(e)?"-0":e}}function A2(t){return{integerValue:""+t}}function k3(t,e){return r3(e)?A2(e):Pg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(){this._=void 0}}function P3(t,e,r){return t instanceof Du?function(i,s){const a={fields:{[o2]:{stringValue:a2},[u2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ag(s)&&(s=ld(s)),s&&(a.fields[l2]=s),{mapValue:a}}(r,e):t instanceof Ou?C2(t,e):t instanceof Fu?R2(t,e):function(i,s){const a=I2(i,s),o=ny(a)+ny(i.Ae);return Xp(a)&&Xp(i.Ae)?A2(o):Pg(i.serializer,o)}(t,e)}function N3(t,e,r){return t instanceof Ou?C2(t,e):t instanceof Fu?R2(t,e):r}function I2(t,e){return t instanceof uh?function(n){return Xp(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Du extends fd{}class Ou extends fd{constructor(e){super(),this.elements=e}}function C2(t,e){const r=k2(e);for(const n of t.elements)r.some(i=>ii(i,n))||r.push(n);return{arrayValue:{values:r}}}class Fu extends fd{constructor(e){super(),this.elements=e}}function R2(t,e){let r=k2(e);for(const n of t.elements)r=r.filter(i=>!ii(i,n));return{arrayValue:{values:r}}}class uh extends fd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function ny(t){return Rt(t.integerValue||t.doubleValue)}function k2(t){return Ig(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(e,r){this.field=e,this.transform=r}}function O3(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Ou&&i instanceof Ou||n instanceof Fu&&i instanceof Fu?jo(n.elements,i.elements,ii):n instanceof uh&&i instanceof uh?ii(n.Ae,i.Ae):n instanceof Du&&i instanceof Du}(t.transform,e.transform)}class F3{constructor(e,r){this.version=e,this.transformResults=r}}class Zn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Zn}static exists(e){return new Zn(void 0,e)}static updateTime(e){return new Zn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Tf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hd{}function P2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new D2(t.key,Zn.none()):new Qu(t.key,t.data,Zn.none());{const r=t.data,n=Or.empty();let i=new Ht(ir.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new bs(t.key,n,new Xr(i.toArray()),Zn.none())}}function L3(t,e,r){t instanceof Qu?function(i,s,a){const o=i.value.clone(),l=sy(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof bs?function(i,s,a){if(!Tf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=sy(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(N2(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function eu(t,e,r,n){return t instanceof Qu?function(s,a,o,l){if(!Tf(s.precondition,a))return o;const u=s.value.clone(),f=ay(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof bs?function(s,a,o,l){if(!Tf(s.precondition,a))return o;const u=ay(s.fieldTransforms,l,a),f=a.data;return f.setAll(N2(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return Tf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function b3(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=I2(n.transform,i||null);s!=null&&(r===null&&(r=Or.empty()),r.set(n.field,s))}return r||null}function iy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&jo(n,i,(s,a)=>O3(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Qu extends hd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bs extends hd{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function N2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function sy(t,e,r){const n=new Map;Xe(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,N3(a,o,r[i]))}return n}function ay(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,P3(s,a,e))}return n}class D2 extends hd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class M3 extends hd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&L3(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=eu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=eu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=S2();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=P2(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ze())}isEqual(e){return this.batchId===e.batchId&&jo(this.mutations,e.mutations,(r,n)=>iy(r,n))&&jo(this.baseMutations,e.baseMutations,(r,n)=>iy(r,n))}}class Ng{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Xe(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return A3}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Ng(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,We;function j3(t){switch(t){case ne.OK:return Ne(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return Ne(15467,{code:t})}}function O2(t){if(t===void 0)return Ri("GRPC error has no .code"),ne.UNKNOWN;switch(t){case Ot.OK:return ne.OK;case Ot.CANCELLED:return ne.CANCELLED;case Ot.UNKNOWN:return ne.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return ne.INTERNAL;case Ot.UNAVAILABLE:return ne.UNAVAILABLE;case Ot.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Ot.NOT_FOUND:return ne.NOT_FOUND;case Ot.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Ot.ABORTED:return ne.ABORTED;case Ot.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Ot.DATA_LOSS:return ne.DATA_LOSS;default:return Ne(39323,{code:t})}}(We=Ot||(Ot={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3=new gs([4294967295,4294967295],0);function oy(t){const e=z3().encode(t),r=new KT;return r.update(e),new Uint8Array(r.digest())}function ly(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new gs([r,n],0),new gs([i,s],0)]}class Dg{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Vl(`Invalid padding: ${r}`);if(n<0)throw new Vl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Vl(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Vl(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=gs.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(gs.fromNumber(n)));return i.compare(W3)===1&&(i=new gs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=oy(e),[n,i]=ly(r);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,i,s);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Dg(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const r=oy(e),[n,i]=ly(r);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,i,s);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Ju.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new dd(Fe.min(),i,new wt(je),ki(),ze())}}class Ju{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Ju(n,r,ze(),ze(),ze())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class F2{constructor(e,r){this.targetId=e,this.Ce=r}}class L2{constructor(e,r,n=cr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class uy{constructor(){this.ve=0,this.Fe=cy(),this.Me=cr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ze(),r=ze(),n=ze();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ne(38017,{changeType:s})}}),new Ju(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=cy()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Xe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class H3{constructor(e){this.Ge=e,this.ze=new Map,this.je=ki(),this.Je=Gc(),this.He=Gc(),this.Ye=new wt(je)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ne(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const s=i.target;if(Qp(s))if(n===0){const a=new Ce(s.path);this.et(r,a,vr.newNoDocument(a,Fe.min()))}else Xe(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Ss(n).toUint8Array()}catch(l){if(l instanceof s2)return Bo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Dg(a,i,s)}catch(l){return Bo(l instanceof Vl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(r,s,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((s,a)=>{const o=this.ot(a);if(o){if(s.current&&Qp(o.target)){const l=new Ce(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,vr.newNoDocument(l,e))}s.Be&&(r.set(a,s.ke()),s.qe())}});let n=ze();this.He.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const i=new dd(e,r,this.Ye,this.je,n);return this.je=ki(),this.Je=Gc(),this.He=Gc(),this.Ye=new wt(je),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new uy,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Ht(je),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Ht(je),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ee("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new uy),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Gc(){return new wt(Ce.comparator)}function cy(){return new wt(Ce.comparator)}const $3={asc:"ASCENDING",desc:"DESCENDING"},G3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},K3={and:"AND",or:"OR"};class q3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function em(t,e){return t.useProto3Json||od(e)?e:{value:e}}function ch(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function b2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function X3(t,e){return ch(t,e.toTimestamp())}function ei(t){return Xe(!!t,49232),Fe.fromTimestamp(function(r){const n=Ts(r);return new ct(n.seconds,n.nanos)}(t))}function Og(t,e){return tm(t,e).canonicalString()}function tm(t,e){const r=function(i){return new ut(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function M2(t){const e=ut.fromString(t);return Xe(z2(e),10190,{key:e.toString()}),e}function rm(t,e){return Og(t.databaseId,e.path)}function C0(t,e){const r=M2(e);if(r.get(1)!==t.databaseId.projectId)throw new we(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new we(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ce(U2(r))}function V2(t,e){return Og(t.databaseId,e)}function Y3(t){const e=M2(t);return e.length===4?ut.emptyPath():U2(e)}function nm(t){return new ut(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function U2(t){return Xe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fy(t,e,r){return{name:rm(t,e),fields:r.value.mapValue.fields}}function Q3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ne(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(Xe(f===void 0||typeof f=="string",58123),cr.fromBase64String(f||"")):(Xe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),cr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?ne.UNKNOWN:O2(u.code);return new we(f,u.message||"")}(a);r=new L2(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=C0(t,n.document.name),s=ei(n.document.updateTime),a=n.document.createTime?ei(n.document.createTime):Fe.min(),o=new Or({mapValue:{fields:n.document.fields}}),l=vr.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new Sf(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=C0(t,n.document),s=n.readTime?ei(n.readTime):Fe.min(),a=vr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Sf([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=C0(t,n.document),s=n.removedTargetIds||[];r=new Sf([],s,i,null)}else{if(!("filter"in e))return Ne(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new B3(i,s),o=n.targetId;r=new F2(o,a)}}return r}function J3(t,e){let r;if(e instanceof Qu)r={update:fy(t,e.key,e.value)};else if(e instanceof D2)r={delete:rm(t,e.key)};else if(e instanceof bs)r={update:fy(t,e.key,e.data),updateMask:oD(e.fieldMask)};else{if(!(e instanceof M3))return Ne(16599,{Vt:e.type});r={verify:rm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Du)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ou)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Fu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof uh)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Ne(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:X3(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ne(27497)}(t,e.precondition)),r}function Z3(t,e){return t&&t.length>0?(Xe(e!==void 0,14353),t.map(r=>function(i,s){let a=i.updateTime?ei(i.updateTime):ei(s);return a.isEqual(Fe.min())&&(a=ei(s)),new F3(a,i.transformResults||[])}(r,e))):[]}function eD(t,e){return{documents:[V2(t,e.path)]}}function tD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=V2(t,i);const s=function(u){if(u.length!==0)return j2(Vn.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(d){return{field:to(d.field),direction:iD(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=em(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function rD(t){let e=Y3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Xe(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=B2(h);return d instanceof Vn&&m2(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(y){return new lh(ro(y.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,od(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,m=h.values||[];return new oh(m,d)}(r.startAt));let u=null;return r.endAt&&(u=function(h){const d=!h.before,m=h.values||[];return new oh(m,d)}(r.endAt)),x3(e,i,a,s,o,"F",l,u)}function nD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function B2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ro(r.unaryFilter.field);return Lt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ro(r.unaryFilter.field);return Lt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ro(r.unaryFilter.field);return Lt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ro(r.unaryFilter.field);return Lt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}}(t):t.fieldFilter!==void 0?function(r){return Lt.create(ro(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Vn.create(r.compositeFilter.filters.map(n=>B2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}}(r.compositeFilter.op))}(t):Ne(30097,{filter:t})}function iD(t){return $3[t]}function sD(t){return G3[t]}function aD(t){return K3[t]}function to(t){return{fieldPath:t.canonicalString()}}function ro(t){return ir.fromServerFormat(t.fieldPath)}function j2(t){return t instanceof Lt?function(r){if(r.op==="=="){if(J_(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NAN"}};if(Q_(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(J_(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NOT_NAN"}};if(Q_(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:to(r.field),op:sD(r.op),value:r.value}}}(t):t instanceof Vn?function(r){const n=r.getFilters().map(i=>j2(i));return n.length===1?n[0]:{compositeFilter:{op:aD(r.op),filters:n}}}(t):Ne(54877,{filter:t})}function oD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function z2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,r,n,i,s=Fe.min(),a=Fe.min(),o=cr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new ns(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e){this.yt=e}}function uD(t){const e=rD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Zp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(){this.Cn=new fD}addToCollectionParentIndex(e,r){return this.Cn.add(r),ie.resolve()}getCollectionParents(e,r){return ie.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return ie.resolve()}deleteFieldIndex(e,r){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,r){return ie.resolve()}getDocumentsMatchingTarget(e,r){return ie.resolve(null)}getIndexType(e,r){return ie.resolve(0)}getFieldIndexes(e,r){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,r){return ie.resolve(Es.min())}getMinOffsetFromCollectionGroup(e,r){return ie.resolve(Es.min())}updateCollectionGroup(e,r,n){return ie.resolve()}updateIndexEntries(e,r){return ie.resolve()}}class fD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Ht(ut.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ht(ut.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},W2=41943040;class Pr{static withCacheSize(e){return new Pr(e,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr.DEFAULT_COLLECTION_PERCENTILE=10,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pr.DEFAULT=new Pr(W2,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pr.DISABLED=new Pr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ho(0)}static cr(){return new Ho(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy="LruGarbageCollector",hD=1048576;function py([t,e],[r,n]){const i=je(t,r);return i===0?je(e,n):i}class dD{constructor(e){this.Ir=e,this.buffer=new Ht(py),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();py(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class pD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ee(dy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){el(r)?Ee(dy,"Ignoring IndexedDB error during garbage collection: ",r):await Zo(r)}await this.Vr(3e5)})}}class mD{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return ie.resolve(ad.ce);const n=new dD(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(hy)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hy):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,s,a,o,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,a=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(u=Date.now(),Za()<=Be.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function gD(t,e){return new mD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.changes=new ka(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,vr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ie.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&eu(n.mutation,i,Xr.empty(),ct.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ze()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ze()){const i=na();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Ml();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=na();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ze()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=ki();const a=Zl(),o=function(){return Zl()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof bs)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),eu(f.mutation,u,f.mutation.getFieldMask(),ct.now())):a.set(u.key,Xr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>o.set(u,new _D(f,a.get(u)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Zl();let i=new wt((a,o)=>a-o),s=ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||Xr.empty();f=o.applyToLocalView(u,f),n.set(l,f);const h=(i.get(o.batchId)||ze()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,h=S2();f.forEach(d=>{if(!s.has(d)){const m=P2(r.get(d),n.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ie.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Ce.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):y2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):ie.resolve(na());let o=Ru,l=s;return a.next(u=>ie.forEach(u,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?ie.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ze())).next(f=>({batchId:o,changes:T2(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ce(r)).next(n=>{let i=Ml();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=Ml();return this.indexManager.getCollectionParents(e,s).next(o=>ie.forEach(o,l=>{const u=function(h,d){return new Yu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,vr.newInvalidDocument(f)))});let o=Ml();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&eu(f.mutation,u,Xr.empty(),ct.now()),cd(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return ie.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ei(i.createTime)}}(r)),ie.resolve()}getNamedQuery(e,r){return ie.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:uD(i.bundledQuery),readTime:ei(i.readTime)}}(r)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(){this.overlays=new wt(Ce.comparator),this.qr=new Map}getOverlay(e,r){return ie.resolve(this.overlays.get(r))}getOverlays(e,r){const n=na();return ie.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.St(e,r,s)}),ie.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(n)),ie.resolve()}getOverlaysForCollection(e,r,n){const i=na(),s=r.length+1,a=new Ce(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new wt((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=na(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=na(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return ie.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new U3(r,n));let s=this.qr.get(r);s===void 0&&(s=ze(),this.qr.set(r,s)),this.qr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(){this.sessionToken=cr.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(){this.Qr=new Ht(Kt.$r),this.Ur=new Ht(Kt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Kt(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Kt(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Ce(new ut([])),n=new Kt(r,e),i=new Kt(r,e+1),s=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Ce(new ut([])),n=new Kt(r,e),i=new Kt(r,e+1);let s=ze();return this.Ur.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Kt(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Kt{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Ce.comparator(e.key,r.key)||je(e.Yr,r.Yr)}static Kr(e,r){return je(e.Yr,r.Yr)||Ce.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Ht(Kt.$r)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new V3(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Kt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ie.resolve(a)}lookupMutationBatch(e,r){return ie.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?Sg:this.tr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Kt(r,0),i=new Kt(r,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,i],a=>{const o=this.Xr(a.Yr);s.push(o)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ht(je);return r.forEach(i=>{const s=new Kt(i,0),a=new Kt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],o=>{n=n.add(o.Yr)})}),ie.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Ce.isDocumentKey(s)||(s=s.child(""));const a=new Kt(new Ce(s),0);let o=new Ht(je);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)},a),ie.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Xe(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ie.forEach(r.mutations,i=>{const s=new Kt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Kt(r,0),i=this.Zr.firstAfterOrEqual(n);return ie.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.ri=e,this.docs=function(){return new wt(Ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ie.resolve(n?n.document.mutableCopy():vr.newInvalidDocument(r))}getEntries(e,r){let n=ki();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():vr.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=ki();const a=r.path,o=new Ce(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||JN(QN(f),n)<=0||(i.has(f.key)||cd(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Ne(9500)}ii(e,r){return ie.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new AD(this)}getSize(e){return ie.resolve(this.size)}}class AD extends vD{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),ie.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.persistence=e,this.si=new ka(r=>Cg(r),Rg),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this.oi=0,this._i=new Fg,this.targetCount=0,this.ai=Ho.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),ie.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ho(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,ie.resolve()}updateTargetData(e,r){return this.Pr(r),ie.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return ie.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),ie.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),ie.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return ie.resolve(n)}containsKey(e,r){return ie.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e,r){this.ui={},this.overlays={},this.ci=new ad(0),this.li=!1,this.li=!0,this.hi=new ED,this.referenceDelegate=e(this),this.Pi=new ID(this),this.indexManager=new cD,this.remoteDocumentCache=function(i){return new SD(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new lD(r),this.Ii=new xD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new wD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new TD(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ee("MemoryPersistence","Starting transaction:",e);const i=new CD(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,r){return ie.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class CD extends e3{constructor(e){super(),this.currentSequenceNumber=e}}class Lg{constructor(e){this.persistence=e,this.Ri=new Fg,this.Vi=null}static mi(e){return new Lg(e)}get fi(){if(this.Vi)return this.Vi;throw Ne(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),ie.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),ie.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.fi,n=>{const i=Ce.fromPath(n);return this.gi(e,i).next(s=>{s||r.removeEntry(i,Fe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return ie.or([()=>ie.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class fh{constructor(e,r){this.persistence=e,this.pi=new ka(n=>n3(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=gD(this,r)}static mi(e,r){return new fh(e,r)}Ei(){}di(e){return ie.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return ie.forEach(this.pi,(n,i)=>this.br(e,n,i).next(s=>s?ie.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(o=>{o||(n++,s.removeEntry(a,Fe.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),ie.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),ie.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),ie.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=wf(e.data.value)),r}br(e,r,n){return ie.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return ie.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=ze(),i=ze();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new bg(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return YR()?8:t3(wr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.ys(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new RD;return this.Ss(e,r,a).next(o=>{if(s.result=o,this.Vs)return this.bs(e,r,a,o.size)})}).next(()=>s.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(Za()<=Be.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",eo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ie.resolve()):(Za()<=Be.DEBUG&&Ee("QueryEngine","Query:",eo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Za()<=Be.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",eo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jn(r))):ie.resolve())}ys(e,r){if(ry(r))return ie.resolve(null);let n=Jn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Zp(r,null,"F"),n=Jn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=ze(...s);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.Ds(r,o);return this.Cs(r,u,a,l.readTime)?this.ys(e,Zp(r,null,"F")):this.vs(e,u,r,l)}))})))}ws(e,r,n,i){return ry(r)||i.isEqual(Fe.min())?ie.resolve(null):this.ps.getDocuments(e,n).next(s=>{const a=this.Ds(r,s);return this.Cs(r,a,n,i)?ie.resolve(null):(Za()<=Be.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),eo(r)),this.vs(e,a,r,YN(i,Ru)).next(o=>o))})}Ds(e,r){let n=new Ht(w2(e));return r.forEach((i,s)=>{cd(e,s)&&(n=n.add(s))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,r,n){return Za()<=Be.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",eo(r)),this.ps.getDocumentsMatchingQuery(e,r,Es.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="LocalStore",PD=3e8;class ND{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new wt(je),this.xs=new ka(s=>Cg(s),Rg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function DD(t,e,r,n){return new ND(t,e,r,n)}async function $2(t,e){const r=Le(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=ze();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:o}))})})}function OD(t,e){const r=Le(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const h=u.batch,d=h.keys();let m=ie.resolve();return d.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(g=>{const A=u.docVersions.get(y);Xe(A!==null,48541),g.version.compareTo(A)<0&&(h.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),f.addEntry(g)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=ze();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function G2(t){const e=Le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function FD(t,e){const r=Le(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(s,f.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(cr.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(h,m),function(g,A,w){return g.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=PD?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(d,m,f)&&o.push(r.Pi.updateTargetData(s,m))});let l=ki(),u=ze();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(LD(s,a,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!n.isEqual(Fe.min())){const f=r.Pi.getLastRemoteSnapshotVersion(s).next(h=>r.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return ie.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.Ms=i,s))}function LD(t,e,r){let n=ze(),i=ze();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=ki();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Fe.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ee(Mg,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{ks:a,qs:i}})}function bD(t,e){const r=Le(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Sg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function MD(t,e){const r=Le(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(s=>s?(i=s,ie.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new ns(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function im(t,e,r){const n=Le(t),i=n.Ms.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!el(a))throw a;Ee(Mg,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function my(t,e,r){const n=Le(t);let i=Fe.min(),s=ze();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const h=Le(l),d=h.xs.get(f);return d!==void 0?ie.resolve(h.Ms.get(d)):h.Pi.getTargetData(u,f)}(n,a,Jn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:Fe.min(),r?s:ze())).next(o=>(VD(n,E3(e),o),{documents:o,Qs:s})))}function VD(t,e,r){let n=t.Os.get(e)||Fe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.Os.set(e,n)}class gy{constructor(){this.activeTargetIds=R3()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class UD{constructor(){this.Mo=new gy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new gy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy="ConnectivityMonitor";class _y{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ee(vy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ee(vy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kc=null;function sm(){return Kc===null?Kc=function(){return 268435456+Math.round(2147483648*Math.random())}():Kc++,"0x"+Kc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="RestConnection",jD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class zD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===sh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,s){const a=sm(),o=this.zo(e,r.toUriEncodedString());Ee(R0,`Sending RPC '${e}' ${a}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),f=Ia(u);return this.Jo(e,o,l,n,f).then(h=>(Ee(R0,`Received RPC '${e}' ${a}: `,h),h),h=>{throw Bo(R0,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,s,a){return this.Go(e,r,n,i,s)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}zo(e,r){const n=jD[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr="WebChannelConnection";class HD extends zD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,s){const a=sm();return new Promise((o,l)=>{const u=new qT;u.setWithCredentials(!0),u.listenOnce(XT.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case xf.NO_ERROR:const h=u.getResponseJson();Ee(pr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case xf.TIMEOUT:Ee(pr,`RPC '${e}' ${a} timed out`),l(new we(ne.DEADLINE_EXCEEDED,"Request time out"));break;case xf.HTTP_ERROR:const d=u.getStatus();if(Ee(pr,`RPC '${e}' ${a} failed with status:`,d,"response text:",u.getResponseText()),d>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const g=function(w){const x=w.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(x)>=0?x:ne.UNKNOWN}(y.status);l(new we(g,y.message))}else l(new we(ne.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new we(ne.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ee(pr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);Ee(pr,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",f,n,15)})}T_(e,r,n){const i=sm(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=JT(),o=QT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Ee(pr,`Creating RPC '${e}' stream ${i}: ${f}`,l);const h=a.createWebChannel(f,l);this.I_(h);let d=!1,m=!1;const y=new WD({Yo:A=>{m?Ee(pr,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(d||(Ee(pr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Ee(pr,`RPC '${e}' stream ${i} sending:`,A),h.send(A))},Zo:()=>h.close()}),g=(A,w,x)=>{A.listen(w,I=>{try{x(I)}catch(L){setTimeout(()=>{throw L},0)}})};return g(h,bl.EventType.OPEN,()=>{m||(Ee(pr,`RPC '${e}' stream ${i} transport opened.`),y.o_())}),g(h,bl.EventType.CLOSE,()=>{m||(m=!0,Ee(pr,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(h))}),g(h,bl.EventType.ERROR,A=>{m||(m=!0,Bo(pr,`RPC '${e}' stream ${i} transport errored. Name:`,A.name,"Message:",A.message),y.a_(new we(ne.UNAVAILABLE,"The operation could not be completed")))}),g(h,bl.EventType.MESSAGE,A=>{var w;if(!m){const x=A.data[0];Xe(!!x,16349);const I=x,L=(I==null?void 0:I.error)||((w=I[0])==null?void 0:w.error);if(L){Ee(pr,`RPC '${e}' stream ${i} received error:`,L);const W=L.status;let G=function(S){const R=Ot[S];if(R!==void 0)return O2(R)}(W),E=L.message;G===void 0&&(G=ne.INTERNAL,E="Unknown error status: "+W+" with message "+L.message),m=!0,y.a_(new we(G,E)),h.close()}else Ee(pr,`RPC '${e}' stream ${i} received:`,x),y.u_(x)}}),g(o,YT.STAT_EVENT,A=>{A.stat===Gp.PROXY?Ee(pr,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===Gp.NOPROXY&&Ee(pr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.__()},0),y}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function k0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(t){return new q3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e,r,n=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yy="PersistentStream";class q2{constructor(e,r,n,i,s,a,o,l){this.Mi=e,this.S_=n,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new K2(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ne.RESOURCE_EXHAUSTED?(Ri(r.toString()),Ri("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new we(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ee(yy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ee(yy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $D extends q2{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=Q3(this.serializer,e),n=function(s){if(!("targetChange"in s))return Fe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Fe.min():a.readTime?ei(a.readTime):Fe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=nm(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=Qp(l)?{documents:eD(s,l)}:{query:tD(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=b2(s,a.resumeToken);const u=em(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Fe.min())>0){o.readTime=ch(s,a.snapshotVersion.toTimestamp());const u=em(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=nD(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=nm(this.serializer),r.removeTarget=e,this.q_(r)}}class GD extends q2{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Xe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=Z3(e.writeResults,e.commitTime),n=ei(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=nm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>J3(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{}class qD extends KD{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new we(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,tm(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new we(ne.UNKNOWN,s.toString())})}Ho(e,r,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,tm(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new we(ne.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class XD{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ri(r),this.aa=!1):Ee("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="RemoteStore";class YD{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Pa(this)&&(Ee(_a,"Restarting streams for network reachability change."),await async function(l){const u=Le(l);u.Ea.add(4),await Zu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await md(u)}(this))})}),this.Ra=new XD(n,i)}}async function md(t){if(Pa(t))for(const e of t.da)await e(!0)}async function Zu(t){for(const e of t.da)await e(!1)}function X2(t,e){const r=Le(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),jg(r)?Bg(r):tl(r).O_()&&Ug(r,e))}function Vg(t,e){const r=Le(t),n=tl(r);r.Ia.delete(e),n.O_()&&Y2(r,e),r.Ia.size===0&&(n.O_()?n.L_():Pa(r)&&r.Ra.set("Unknown"))}function Ug(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}tl(t).Y_(e)}function Y2(t,e){t.Va.Ue(e),tl(t).Z_(e)}function Bg(t){t.Va=new H3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),tl(t).start(),t.Ra.ua()}function jg(t){return Pa(t)&&!tl(t).x_()&&t.Ia.size>0}function Pa(t){return Le(t).Ea.size===0}function Q2(t){t.Va=void 0}async function QD(t){t.Ra.set("Online")}async function JD(t){t.Ia.forEach((e,r)=>{Ug(t,e)})}async function ZD(t,e){Q2(t),jg(t)?(t.Ra.ha(e),Bg(t)):t.Ra.set("Unknown")}async function eO(t,e,r){if(t.Ra.set("Online"),e instanceof L2&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){Ee(_a,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await hh(t,n)}else if(e instanceof Sf?t.Va.Ze(e):e instanceof F2?t.Va.st(e):t.Va.tt(e),!r.isEqual(Fe.min()))try{const n=await G2(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(cr.EMPTY_BYTE_STRING,f.snapshotVersion)),Y2(s,l);const h=new ns(f.target,l,u,f.sequenceNumber);Ug(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ee(_a,"Failed to raise snapshot:",n),await hh(t,n)}}async function hh(t,e,r){if(!el(e))throw e;t.Ea.add(1),await Zu(t),t.Ra.set("Offline"),r||(r=()=>G2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ee(_a,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await md(t)})}function J2(t,e){return e().catch(r=>hh(t,r,e))}async function gd(t){const e=Le(t),r=Is(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Sg;for(;tO(e);)try{const i=await bD(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,rO(e,i)}catch(i){await hh(e,i)}Z2(e)&&eS(e)}function tO(t){return Pa(t)&&t.Ta.length<10}function rO(t,e){t.Ta.push(e);const r=Is(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Z2(t){return Pa(t)&&!Is(t).x_()&&t.Ta.length>0}function eS(t){Is(t).start()}async function nO(t){Is(t).ra()}async function iO(t){const e=Is(t);for(const r of t.Ta)e.ea(r.mutations)}async function sO(t,e,r){const n=t.Ta.shift(),i=Ng.from(n,e,r);await J2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await gd(t)}async function aO(t,e){e&&Is(t).X_&&await async function(n,i){if(function(a){return j3(a)&&a!==ne.ABORTED}(i.code)){const s=n.Ta.shift();Is(n).B_(),await J2(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await gd(n)}}(t,e),Z2(t)&&eS(t)}async function xy(t,e){const r=Le(t);r.asyncQueue.verifyOperationInProgress(),Ee(_a,"RemoteStore received new credentials");const n=Pa(r);r.Ea.add(3),await Zu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await md(r)}async function oO(t,e){const r=Le(t);e?(r.Ea.delete(2),await md(r)):e||(r.Ea.add(2),await Zu(r),r.Ra.set("Unknown"))}function tl(t){return t.ma||(t.ma=function(r,n,i){const s=Le(r);return s.sa(),new $D(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:QD.bind(null,t),t_:JD.bind(null,t),r_:ZD.bind(null,t),H_:eO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),jg(t)?Bg(t):t.Ra.set("Unknown")):(await t.ma.stop(),Q2(t))})),t.ma}function Is(t){return t.fa||(t.fa=function(r,n,i){const s=Le(r);return s.sa(),new GD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:nO.bind(null,t),r_:aO.bind(null,t),ta:iO.bind(null,t),na:sO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await gd(t)):(await t.fa.stop(),t.Ta.length>0&&(Ee(_a,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new vs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new zg(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wg(t,e){if(Ri("AsyncQueue",`${e}: ${t}`),el(t))return new we(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{static emptySet(e){return new Ao(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ce.comparator(r.key,n.key):(r,n)=>Ce.comparator(r.key,n.key),this.keyedMap=Ml(),this.sortedSet=new wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ao;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(){this.ga=new wt(Ce.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ne(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class $o{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new $o(e,r,Ao.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ud(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class uO{constructor(){this.queries=Ey(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=Le(r),s=i.queries;i.queries=Ey(),s.forEach((a,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new we(ne.ABORTED,"Firestore shutting down"))}}function Ey(){return new ka(t=>x2(t),ud)}async function tS(t,e){const r=Le(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.ba()&&e.Da()&&(n=2):(s=new lO,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await r.onListen(i,!0);break;case 1:s.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Wg(a,`Initialization of query '${eo(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.Sa.push(e),e.va(r.onlineState),s.wa&&e.Fa(s.wa)&&Hg(r)}async function rS(t,e){const r=Le(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function cO(t,e){const r=Le(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(n=!0);a.wa=i}}n&&Hg(r)}function fO(t,e,r){const n=Le(t),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(r);n.queries.delete(e)}function Hg(t){t.Ca.forEach(e=>{e.next()})}var am,Ty;(Ty=am||(am={})).Ma="default",Ty.Cache="cache";class nS{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new $o(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=$o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==am.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e){this.key=e}}class sS{constructor(e){this.key=e}}class hO{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ze(),this.mutatedKeys=ze(),this.eu=w2(e),this.tu=new Ao(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new wy,i=r?r.tu:this.tu;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),m=cd(this.query,h)?h:null,y=!!d&&this.mutatedKeys.has(d.key),g=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let A=!1;d&&m?d.data.isEqual(m.data)?y!==g&&(n.track({type:3,doc:m}),A=!0):this.su(d,m)||(n.track({type:2,doc:m}),A=!0,(l&&this.eu(m,l)>0||u&&this.eu(m,u)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),A=!0):d&&!m&&(n.track({type:1,doc:d}),A=!0,(l||u)&&(o=!0)),A&&(m?(a=a.add(m),s=g?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:o,mutatedKeys:s}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,h)=>function(m,y){const g=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne(20277,{Rt:A})}};return g(m)-g(y)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new $o(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new wy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ze(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new sS(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new iS(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=ze();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return $o.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const $g="SyncEngine";class dO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class pO{constructor(e){this.key=e,this.hu=!1}}class mO{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new ka(o=>x2(o),ud),this.Iu=new Map,this.Eu=new Set,this.du=new wt(Ce.comparator),this.Au=new Map,this.Ru=new Fg,this.Vu={},this.mu=new Map,this.fu=Ho.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function gO(t,e,r=!0){const n=fS(t);let i;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await aS(n,e,r,!0),i}async function vO(t,e){const r=fS(t);await aS(r,e,!0,!1)}async function aS(t,e,r,n){const i=await MD(t.localStore,Jn(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await _O(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&X2(t.remoteStore,i),o}async function _O(t,e,r,n,i){t.pu=(h,d,m)=>async function(g,A,w,x){let I=A.view.ru(w);I.Cs&&(I=await my(g.localStore,A.query,!1).then(({documents:E})=>A.view.ru(E,I)));const L=x&&x.targetChanges.get(A.targetId),W=x&&x.targetMismatches.get(A.targetId)!=null,G=A.view.applyChanges(I,g.isPrimaryClient,L,W);return Ay(g,A.targetId,G.au),G.snapshot}(t,h,d,m);const s=await my(t.localStore,e,!0),a=new hO(e,s.Qs),o=a.ru(s.documents),l=Ju.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);Ay(t,r,u.au);const f=new dO(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function yO(t,e,r){const n=Le(t),i=n.Tu.get(e),s=n.Iu.get(i.targetId);if(s.length>1)return n.Iu.set(i.targetId,s.filter(a=>!ud(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await im(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Vg(n.remoteStore,i.targetId),om(n,i.targetId)}).catch(Zo)):(om(n,i.targetId),await im(n.localStore,i.targetId,!0))}async function xO(t,e){const r=Le(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Vg(r.remoteStore,n.targetId))}async function wO(t,e,r){const n=RO(t);try{const i=await function(a,o){const l=Le(a),u=ct.now(),f=o.reduce((m,y)=>m.add(y.key),ze());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=ki(),g=ze();return l.Ns.getEntries(m,f).next(A=>{y=A,y.forEach((w,x)=>{x.isValidDocument()||(g=g.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(A=>{h=A;const w=[];for(const x of o){const I=b3(x,h.get(x.key).overlayedDocument);I!=null&&w.push(new bs(x.key,I,h2(I.value.mapValue),Zn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,w,o)}).next(A=>{d=A;const w=A.applyToLocalDocumentSet(h,g);return l.documentOverlayCache.saveOverlays(m,A.batchId,w)})}).then(()=>({batchId:d.batchId,changes:T2(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new wt(je)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u}(n,i.batchId,r),await ec(n,i.changes),await gd(n.remoteStore)}catch(i){const s=Wg(i,"Failed to persist write");r.reject(s)}}async function oS(t,e){const r=Le(t);try{const n=await FD(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Au.get(s);a&&(Xe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Xe(a.hu,14607):i.removedDocuments.size>0&&(Xe(a.hu,42227),a.hu=!1))}),await ec(r,n,e)}catch(n){await Zo(n)}}function Sy(t,e,r){const n=Le(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Le(a);l.onlineState=o;let u=!1;l.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(u=!0)}),u&&Hg(l)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function EO(t,e,r){const n=Le(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),s=i&&i.key;if(s){let a=new wt(Ce.comparator);a=a.insert(s,vr.newNoDocument(s,Fe.min()));const o=ze().add(s),l=new dd(Fe.min(),new Map,new wt(je),a,o);await oS(n,l),n.du=n.du.remove(s),n.Au.delete(e),Gg(n)}else await im(n.localStore,e,!1).then(()=>om(n,e,r)).catch(Zo)}async function TO(t,e){const r=Le(t),n=e.batch.batchId;try{const i=await OD(r.localStore,e);uS(r,n,null),lS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ec(r,i)}catch(i){await Zo(i)}}async function SO(t,e,r){const n=Le(t);try{const i=await function(a,o){const l=Le(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(h=>(Xe(h!==null,37113),f=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);uS(n,e,r),lS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await ec(n,i)}catch(i){await Zo(i)}}function lS(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function uS(t,e,r){const n=Le(t);let i=n.Vu[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function om(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||cS(t,n)})}function cS(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Vg(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Gg(t))}function Ay(t,e,r){for(const n of r)n instanceof iS?(t.Ru.addReference(n.key,e),AO(t,n)):n instanceof sS?(Ee($g,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||cS(t,n.key)):Ne(19791,{wu:n})}function AO(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ee($g,"New document in limbo: "+r),t.Eu.add(n),Gg(t))}function Gg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Ce(ut.fromString(e)),n=t.fu.next();t.Au.set(n,new pO(r)),t.du=t.du.insert(r,n),X2(t.remoteStore,new ns(Jn(kg(r.path)),n,"TargetPurposeLimboResolution",ad.ce))}}async function ec(t,e,r){const n=Le(t),i=[],s=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{a.push(n.pu(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=bg.As(l.targetId,u);s.push(h)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(l,u){const f=Le(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ie.forEach(u,d=>ie.forEach(d.Es,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>ie.forEach(d.ds,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!el(h))throw h;Ee(Mg,"Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const m=f.Ms.get(d),y=m.snapshotVersion,g=m.withLastLimboFreeSnapshotVersion(y);f.Ms=f.Ms.insert(d,g)}}}(n.localStore,s))}async function IO(t,e){const r=Le(t);if(!r.currentUser.isEqual(e)){Ee($g,"User change. New user:",e.toKey());const n=await $2(r.localStore,e);r.currentUser=e,function(s,a){s.mu.forEach(o=>{o.forEach(l=>{l.reject(new we(ne.CANCELLED,a))})}),s.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ec(r,n.Ls)}}function CO(t,e){const r=Le(t),n=r.Au.get(e);if(n&&n.hu)return ze().add(n.key);{let i=ze();const s=r.Iu.get(e);if(!s)return i;for(const a of s){const o=r.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function fS(t){const e=Le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=oS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EO.bind(null,e),e.Pu.H_=cO.bind(null,e.eventManager),e.Pu.yu=fO.bind(null,e.eventManager),e}function RO(t){const e=Le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SO.bind(null,e),e}class dh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return DD(this.persistence,new kD,e.initialUser,this.serializer)}Cu(e){return new H2(Lg.mi,this.serializer)}Du(e){return new UD}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}dh.provider={build:()=>new dh};class kO extends dh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Xe(this.persistence.referenceDelegate instanceof fh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new pD(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Pr.withCacheSize(this.cacheSizeBytes):Pr.DEFAULT;return new H2(n=>fh.mi(n,r),this.serializer)}}class lm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Sy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=IO.bind(null,this.syncEngine),await oO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uO}()}createDatastore(e){const r=pd(e.databaseInfo.databaseId),n=function(s){return new HD(s)}(e.databaseInfo);return function(s,a,o,l){return new qD(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new YD(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>Sy(this.syncEngine,r,0),function(){return _y.v()?new _y:new BD}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const h=new mO(i,s,a,o,l,u);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=Le(i);Ee(_a,"RemoteStore shutting down."),s.Ea.add(5),await Zu(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}lm.provider={build:()=>new lm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ri("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="FirestoreClient";class PO{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=mr.UNAUTHENTICATED,this.clientId=Tg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ee(Cs,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ee(Cs,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Wg(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function P0(t,e){t.asyncQueue.verifyOperationInProgress(),Ee(Cs,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await $2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Iy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await NO(t);Ee(Cs,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>xy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>xy(e.remoteStore,i)),t._onlineComponents=e}async function NO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ee(Cs,"Using user provided OfflineComponentProvider");try{await P0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ne.FAILED_PRECONDITION||i.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Bo("Error using user provided cache. Falling back to memory cache: "+r),await P0(t,new dh)}}else Ee(Cs,"Using default OfflineComponentProvider"),await P0(t,new kO(void 0));return t._offlineComponents}async function dS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ee(Cs,"Using user provided OnlineComponentProvider"),await Iy(t,t._uninitializedComponentsProvider._online)):(Ee(Cs,"Using default OnlineComponentProvider"),await Iy(t,new lm))),t._onlineComponents}function DO(t){return dS(t).then(e=>e.syncEngine)}async function um(t){const e=await dS(t),r=e.eventManager;return r.onListen=gO.bind(null,e.syncEngine),r.onUnlisten=yO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=vO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=xO.bind(null,e.syncEngine),r}function OO(t,e,r={}){const n=new vs;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new hS({next:d=>{f.Nu(),a.enqueueAndForget(()=>rS(s,h)),d.fromCache&&l.source==="server"?u.reject(new we(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new nS(o,f,{includeMetadataChanges:!0,qa:!0});return tS(s,h)}(await um(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS="firestore.googleapis.com",Ry=!0;class ky{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mS,this.ssl=Ry}else this.host=e.host,this.ssl=e.ssl??Ry;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=W2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<hD)throw new we(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pS(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vd{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ky({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ky(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new UN;switch(n.type){case"firstParty":return new WN(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new we(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Cy.get(r);n&&(Ee("ComponentProvider","Removing Datastore"),Cy.delete(r),n.terminate())}(this),Promise.resolve()}}function FO(t,e,r,n={}){var u;t=Qn(t,vd);const i=Ia(e),s=t._getSettings(),a={...s,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(dg(`https://${o}`),pg("Firestore",!0)),s.host!==mS&&s.host!==o&&Bo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:n};if(!ws(l,a)&&(t._setSettings(l),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=mr.MOCK_USER;else{f=gT(n.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new we(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new mr(d)}t._authCredentials=new BN(new e2(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Na(this.firestore,e,this._query)}}class Pt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _s(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pt(this.firestore,e,this._key)}toJSON(){return{type:Pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Xu(r,Pt._jsonSchema))return new Pt(e,n||null,new Ce(ut.fromString(r.referencePath)))}}Pt._jsonSchemaVersion="firestore/documentReference/1.0",Pt._jsonSchema={type:bt("string",Pt._jsonSchemaVersion),referencePath:bt("string")};class _s extends Na{constructor(e,r,n){super(e,r,kg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pt(this.firestore,null,new Ce(e))}withConverter(e){return new _s(this.firestore,e,this._path)}}function qc(t,e,...r){if(t=vt(t),t2("collection","path",e),t instanceof vd){const n=ut.fromString(e,...r);return z_(n),new _s(t,null,n)}{if(!(t instanceof Pt||t instanceof _s))throw new we(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ut.fromString(e,...r));return z_(n),new _s(t.firestore,null,n)}}function qs(t,e,...r){if(t=vt(t),arguments.length===1&&(e=Tg.newId()),t2("doc","path",e),t instanceof vd){const n=ut.fromString(e,...r);return j_(n),new Pt(t,null,new Ce(n))}{if(!(t instanceof Pt||t instanceof _s))throw new we(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ut.fromString(e,...r));return j_(n),new Pt(t.firestore,t instanceof _s?t.converter:null,new Ce(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py="AsyncQueue";class Ny{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new K2(this,"async_queue_retry"),this._c=()=>{const n=k0();n&&Ee(Py,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=k0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=k0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new vs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!el(e))throw e;Ee(Py,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Ri("INTERNAL UNHANDLED ERROR: ",Dy(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=zg.createAndSchedule(this,e,r,n,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Ne(47125,{Pc:Dy(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Dy(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Go extends vd{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Ny,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ny(e),this._firestoreClient=void 0,await e}}}function LO(t,e){const r=typeof t=="object"?t:rd(),n=typeof t=="string"?t:sh,i=Fs(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=dT("firestore");s&&FO(i,...s)}return i}function Kg(t){if(t._terminated)throw new we(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||bO(t),t._firestoreClient}function bO(t){var n,i,s;const e=t._freezeSettings(),r=function(o,l,u,f){return new a3(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,pS(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new PO(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ln(cr.fromBase64String(e))}catch(r){throw new we(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ln(cr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Xu(e,ln._jsonSchema))return ln.fromBase64String(e.bytes)}}ln._jsonSchemaVersion="firestore/bytes/1.0",ln._jsonSchema={type:bt("string",ln._jsonSchemaVersion),bytes:bt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new we(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ir(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new we(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new we(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ti._jsonSchemaVersion}}static fromJSON(e){if(Xu(e,ti._jsonSchema))return new ti(e.latitude,e.longitude)}}ti._jsonSchemaVersion="firestore/geoPoint/1.0",ti._jsonSchema={type:bt("string",ti._jsonSchemaVersion),latitude:bt("number"),longitude:bt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ri._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Xu(e,ri._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ri(e.vectorValues);throw new we(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ri._jsonSchemaVersion="firestore/vectorValue/1.0",ri._jsonSchema={type:bt("string",ri._jsonSchemaVersion),vectorValues:bt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MO=/^__.*__$/;class VO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new bs(e,this.data,this.fieldMask,r,this.fieldTransforms):new Qu(e,this.data,r,this.fieldTransforms)}}class gS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new bs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function vS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne(40011,{Ac:t})}}class qg{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const r=(i=this.path)==null?void 0:i.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var i;const r=(i=this.path)==null?void 0:i.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ph(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vS(this.Ac)&&MO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class UO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||pd(e)}Cc(e,r,n,i=!1){return new qg({Ac:e,methodName:r,Dc:n,path:ir.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xg(t){const e=t._freezeSettings(),r=pd(t._databaseId);return new UO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function BO(t,e,r,n,i,s={}){const a=t.Cc(s.merge||s.mergeFields?2:0,e,r,i);Qg("Data must be an object, but it was:",a,n);const o=_S(n,a);let l,u;if(s.merge)l=new Xr(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=cm(e,h,r);if(!a.contains(d))throw new we(ne.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);xS(f,d)||f.push(d)}l=new Xr(f),u=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=a.fieldTransforms;return new VO(new Or(o),l,u)}class xd extends yd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xd}}class Yg extends yd{_toFieldTransform(e){return new D3(e.path,new Du)}isEqual(e){return e instanceof Yg}}function jO(t,e,r,n){const i=t.Cc(1,e,r);Qg("Data must be an object, but it was:",i,n);const s=[],a=Or.empty();Ls(n,(l,u)=>{const f=Jg(e,l,r);u=vt(u);const h=i.yc(f);if(u instanceof xd)s.push(f);else{const d=tc(u,h);d!=null&&(s.push(f),a.set(f,d))}});const o=new Xr(s);return new gS(a,o,i.fieldTransforms)}function zO(t,e,r,n,i,s){const a=t.Cc(1,e,r),o=[cm(e,n,r)],l=[i];if(s.length%2!=0)throw new we(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(cm(e,s[d])),l.push(s[d+1]);const u=[],f=Or.empty();for(let d=o.length-1;d>=0;--d)if(!xS(u,o[d])){const m=o[d];let y=l[d];y=vt(y);const g=a.yc(m);if(y instanceof xd)u.push(m);else{const A=tc(y,g);A!=null&&(u.push(m),f.set(m,A))}}const h=new Xr(u);return new gS(f,h,a.fieldTransforms)}function WO(t,e,r,n=!1){return tc(r,t.Cc(n?4:3,e))}function tc(t,e){if(yS(t=vt(t)))return Qg("Unsupported field value:",e,t),_S(t,e);if(t instanceof yd)return function(n,i){if(!vS(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=tc(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=vt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return k3(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ct.fromDate(n);return{timestampValue:ch(i.serializer,s)}}if(n instanceof ct){const s=new ct(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ch(i.serializer,s)}}if(n instanceof ti)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ln)return{bytesValue:b2(i.serializer,n._byteString)};if(n instanceof Pt){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Og(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ri)return function(a,o){return{mapValue:{fields:{[c2]:{stringValue:f2},[ah]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return Pg(o.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${sd(n)}`)}(t,e)}function _S(t,e){const r={};return i2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ls(t,(n,i)=>{const s=tc(i,e.mc(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function yS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ct||t instanceof ti||t instanceof ln||t instanceof Pt||t instanceof yd||t instanceof ri)}function Qg(t,e,r){if(!yS(r)||!r2(r)){const n=sd(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function cm(t,e,r){if((e=vt(e))instanceof _d)return e._internalPath;if(typeof e=="string")return Jg(t,e);throw ph("Field path arguments must be of type string or ",t,!1,void 0,r)}const HO=new RegExp("[~\\*/\\[\\]]");function Jg(t,e,r){if(e.search(HO)>=0)throw ph(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new _d(...e.split("."))._internalPath}catch{throw ph(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ph(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new we(ne.INVALID_ARGUMENT,o+t+l)}function xS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $O(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Zg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class $O extends wS{data(){return super.data()}}function Zg(t,e){return typeof e=="string"?Jg(t,e):e instanceof _d?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class e1{}class GO extends e1{}function KO(t,e,...r){let n=[];e instanceof e1&&n.push(e),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof t1).length,o=s.filter(l=>l instanceof wd).length;if(a>1||a>0&&o>0)throw new we(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class wd extends GO{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new wd(e,r,n)}_apply(e){const r=this._parse(e);return TS(e._query,r),new Na(e.firestore,e.converter,Jp(e._query,r))}_parse(e){const r=Xg(e.firestore);return function(s,a,o,l,u,f,h){let d;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new we(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Ly(h,f);const y=[];for(const g of h)y.push(Fy(l,s,g));d={arrayValue:{values:y}}}else d=Fy(l,s,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Ly(h,f),d=WO(o,a,h,f==="in"||f==="not-in");return Lt.create(u,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function qO(t,e,r){const n=e,i=Zg("where",t);return wd._create(i,n,r)}class t1 extends e1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new t1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Vn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)TS(a,l),a=Jp(a,l)}(e._query,r),new Na(e.firestore,e.converter,Jp(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Fy(t,e,r){if(typeof(r=vt(r))=="string"){if(r==="")throw new we(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!y2(e)&&r.indexOf("/")!==-1)throw new we(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ut.fromString(r));if(!Ce.isDocumentKey(n))throw new we(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Y_(t,new Ce(n))}if(r instanceof Pt)return Y_(t,r._key);throw new we(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sd(r)}.`)}function Ly(t,e){if(!Array.isArray(t)||t.length===0)throw new we(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TS(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new we(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class XO{convertValue(e,r="none"){switch(As(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ls(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var n,i,s;const r=(s=(i=(n=e.fields)==null?void 0:n[ah].arrayValue)==null?void 0:i.values)==null?void 0:s.map(a=>Rt(a.doubleValue));return new ri(r)}convertGeoPoint(e){return new ti(Rt(e.latitude),Rt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ld(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(ku(e));default:return null}}convertTimestamp(e){const r=Ts(e);return new ct(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ut.fromString(e);Xe(z2(n),9688,{name:e});const i=new Pu(n.get(1),n.get(3)),s=new Ce(n.popFirst(5));return i.isEqual(r)||Ri(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Ul{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class oa extends wS{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Af(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Zg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=oa._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}oa._jsonSchemaVersion="firestore/documentSnapshot/1.0",oa._jsonSchema={type:bt("string",oa._jsonSchemaVersion),bundleSource:bt("string","DocumentSnapshot"),bundleName:bt("string"),bundle:bt("string")};class Af extends oa{data(e={}){return super.data(e)}}class la{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Ul(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Af(this._firestore,this._userDataWriter,n.key,n,new Ul(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new we(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new Af(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ul(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new Af(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ul(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:QO(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=la._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(r.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function QO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:t})}}la._jsonSchemaVersion="firestore/querySnapshot/1.0",la._jsonSchema={type:bt("string",la._jsonSchemaVersion),bundleSource:bt("string","QuerySnapshot"),bundleName:bt("string"),bundle:bt("string")};class r1 extends XO{constructor(e){super(),this.firestore=e}convertBytes(e){return new ln(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Pt(this.firestore,null,r)}}function N0(t){t=Qn(t,Na);const e=Qn(t.firestore,Go),r=Kg(e),n=new r1(e);return ES(t._query),OO(r,t._query).then(i=>new la(e,n,t,i))}function D0(t,e,r){t=Qn(t,Pt);const n=Qn(t.firestore,Go),i=YO(t.converter,e,r);return SS(n,[BO(Xg(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Zn.none())])}function Xc(t,e,r,...n){t=Qn(t,Pt);const i=Qn(t.firestore,Go),s=Xg(i);let a;return a=typeof(e=vt(e))=="string"||e instanceof _d?zO(s,"updateDoc",t._key,e,r,n):jO(s,"updateDoc",t._key,e),SS(i,[a.toMutation(t._key,Zn.exists(!0))])}function JO(t,...e){var l,u,f;t=vt(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Oy(e[n])||(r=e[n++]);const i={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Oy(e[n])){const h=e[n];e[n]=(l=h.next)==null?void 0:l.bind(h),e[n+1]=(u=h.error)==null?void 0:u.bind(h),e[n+2]=(f=h.complete)==null?void 0:f.bind(h)}let s,a,o;if(t instanceof Pt)a=Qn(t.firestore,Go),o=kg(t._key.path),s={next:h=>{e[n]&&e[n](ZO(a,t,h))},error:e[n+1],complete:e[n+2]};else{const h=Qn(t,Na);a=Qn(h.firestore,Go),o=h._query;const d=new r1(a);s={next:m=>{e[n]&&e[n](new la(a,d,h,m))},error:e[n+1],complete:e[n+2]},ES(t._query)}return function(d,m,y,g){const A=new hS(g),w=new nS(m,A,y);return d.asyncQueue.enqueueAndForget(async()=>tS(await um(d),w)),()=>{A.Nu(),d.asyncQueue.enqueueAndForget(async()=>rS(await um(d),w))}}(Kg(a),o,i,s)}function SS(t,e){return function(n,i){const s=new vs;return n.asyncQueue.enqueueAndForget(async()=>wO(await DO(n),i,s)),s.promise}(Kg(t),e)}function ZO(t,e,r){const n=r.docs.get(e._key),i=new r1(t);return new oa(t,i,e._key,n,new Ul(r.hasPendingWrites,r.fromCache),e.converter)}function Yc(){return new Yg("serverTimestamp")}(function(e,r=!0){(function(i){Jo=i})(Ra),Mn(new dn("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Go(new jN(n.getProvider("auth-internal")),new HN(a,n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new we(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pu(u.options.projectId,f)}(a,i),a);return s={useFetchStreams:r,...s},o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Vr(M_,V_,e),Vr(M_,V_,"esm2020")})();function AS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eF=AS,IS=new Ca("auth","Firebase",AS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new td("@firebase/auth");function tF(t,...e){mh.logLevel<=Be.WARN&&mh.warn(`Auth (${Ra}): ${t}`,...e)}function If(t,...e){mh.logLevel<=Be.ERROR&&mh.error(`Auth (${Ra}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(t,...e){throw i1(t,...e)}function Fn(t,...e){return i1(t,...e)}function n1(t,e,r){const n={...eF(),[e]:r};return new Ca("auth","Firebase",n).create(e,{appName:t.name})}function yi(t){return n1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rF(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&pn(t,"argument-error"),n1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function i1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return IS.create(t,...e)}function Pe(t,e,...r){if(!t)throw i1(e,...r)}function gi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw If(e),new Error(e)}function Pi(t,e){t||gi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nF(){return by()==="http:"||by()==="https:"}function by(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nF()||vT()||"connection"in navigator)?navigator.onLine:!0}function sF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,r){this.shortDelay=e,this.longDelay=r,Pi(r>e,"Short delay should be less than long delay!"),this.isMobile=$R()||qR()}get(){return iF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(t,e){Pi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],lF=new rc(3e4,6e4);function Ms(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Fi(t,e,r,n,i={}){return RS(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=qu({key:t.config.apiKey,...a}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return KR()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Ia(t.emulatorConfig.host)&&(u.credentials="include"),CS.fetch()(await kS(t,t.config.apiHost,r,o),u)})}async function RS(t,e,r){t._canInitEmulator=!1;const n={...aF,...e};try{const i=new cF(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Qc(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qc(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Qc(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Qc(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw n1(t,f,u);pn(t,f)}}catch(i){if(i instanceof mn)throw i;pn(t,"network-request-failed",{message:String(i)})}}async function nc(t,e,r,n,i={}){const s=await Fi(t,e,r,n,i);return"mfaPendingCredential"in s&&pn(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function kS(t,e,r,n){const i=`${e}${r}?${n}`,s=t,a=s.config.emulator?s1(t.config,i):`${t.config.apiScheme}://${i}`;return oF.includes(r)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function uF(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Fn(this.auth,"network-request-failed")),lF.get())})}}function Qc(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Fn(t,e,n);return i.customData._tokenResponse=r,i}function My(t){return t!==void 0&&t.enterprise!==void 0}class fF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return uF(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function hF(t,e){return Fi(t,"GET","/v2/recaptchaConfig",Ms(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dF(t,e){return Fi(t,"POST","/v1/accounts:delete",e)}async function gh(t,e){return Fi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pF(t,e=!1){const r=vt(t),n=await r.getIdToken(e),i=a1(n);Pe(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:tu(O0(i.auth_time)),issuedAtTime:tu(O0(i.iat)),expirationTime:tu(O0(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function O0(t){return Number(t)*1e3}function a1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return If("JWT malformed, contained fewer than 3 sections"),null;try{const i=fT(r);return i?JSON.parse(i):(If("Failed to decode base64 JWT payload"),null)}catch(i){return If("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Vy(t){const e=a1(t);return Pe(e,"internal-error"),Pe(typeof e.exp<"u","internal-error"),Pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof mn&&mF(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function mF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=tu(this.lastLoginAt),this.creationTime=tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vh(t){var h;const e=t.auth,r=await t.getIdToken(),n=await Ko(t,gh(e,{idToken:r}));Pe(n==null?void 0:n.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const s=(h=i.providerUserInfo)!=null&&h.length?PS(i.providerUserInfo):[],a=_F(t.providerData,s),o=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=o?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new hm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function vF(t){const e=vt(t);await vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _F(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function PS(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(t,e){const r=await RS(t,{},async()=>{const n=qu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=await kS(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&Ia(t.emulatorConfig.host)&&(l.credentials="include"),CS.fetch()(a,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function xF(t,e){return Fi(t,"POST","/v2/accounts:revokeToken",Ms(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pe(e.idToken,"internal-error"),Pe(typeof e.idToken<"u","internal-error"),Pe(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Vy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Pe(e.length!==0,"internal-error");const r=Vy(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await yF(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Io;return n&&(Pe(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(Pe(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Pe(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return gi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t,e){Pe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class kn{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new gF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Ko(this,this.stsTokenManager.getToken(this.auth,e));return Pe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return pF(this,e)}reload(){return vF(this)}_assign(e){this!==e&&(Pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new kn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await vh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dr(this.auth.app))return Promise.reject(yi(this.auth));const e=await this.getIdToken();return await Ko(this,dF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,s=r.phoneNumber??void 0,a=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,u=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:m,providerData:y,stsTokenManager:g}=r;Pe(h&&g,e,"internal-error");const A=Io.fromJSON(this.name,g);Pe(typeof h=="string",e,"internal-error"),Gi(n,e.name),Gi(i,e.name),Pe(typeof d=="boolean",e,"internal-error"),Pe(typeof m=="boolean",e,"internal-error"),Gi(s,e.name),Gi(a,e.name),Gi(o,e.name),Gi(l,e.name),Gi(u,e.name),Gi(f,e.name);const w=new kn({uid:h,auth:e,email:i,emailVerified:d,displayName:n,isAnonymous:m,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:A,createdAt:u,lastLoginAt:f});return y&&Array.isArray(y)&&(w.providerData=y.map(x=>({...x}))),l&&(w._redirectEventId=l),w}static async _fromIdTokenResponse(e,r,n=!1){const i=new Io;i.updateFromServerResponse(r);const s=new kn({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await vh(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Pe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?PS(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Io;o.updateFromIdToken(n);const l=new kn({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new hm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=new Map;function vi(t){Pi(t instanceof Function,"Expected a class definition");let e=Uy.get(t);return e?(Pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Uy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}NS.type="NONE";const By=NS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t,e,r){return`firebase:${t}:${e}:${r}`}class Co{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Cf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Cf("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await gh(this.auth,{idToken:e}).catch(()=>{});return r?kn._fromGetAccountInfoResponse(this.auth,r,e):null}return kn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Co(vi(By),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||vi(By);const a=Cf(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){let h;if(typeof f=="string"){const d=await gh(e,{idToken:f}).catch(()=>{});if(!d)break;h=await kn._fromGetAccountInfoResponse(e,d,f)}else h=kn._fromJSON(e,f);u!==s&&(o=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Co(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new Co(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(MS(e))return"Blackberry";if(VS(e))return"Webos";if(OS(e))return"Safari";if((e.includes("chrome/")||FS(e))&&!e.includes("edge/"))return"Chrome";if(bS(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function DS(t=wr()){return/firefox\//i.test(t)}function OS(t=wr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FS(t=wr()){return/crios\//i.test(t)}function LS(t=wr()){return/iemobile/i.test(t)}function bS(t=wr()){return/android/i.test(t)}function MS(t=wr()){return/blackberry/i.test(t)}function VS(t=wr()){return/webos/i.test(t)}function o1(t=wr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wF(t=wr()){var e;return o1(t)&&!!((e=window.navigator)!=null&&e.standalone)}function EF(){return XR()&&document.documentMode===10}function US(t=wr()){return o1(t)||bS(t)||VS(t)||MS(t)||/windows phone/i.test(t)||LS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(t,e=[]){let r;switch(t){case"Browser":r=jy(wr());break;case"Worker":r=`${jy(wr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ra}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SF(t,e={}){return Fi(t,"GET","/v2/passwordPolicy",Ms(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=6;class IF{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??AF,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zy(this),this.idTokenSubscription=new zy(this),this.beforeStateQueue=new TF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=IS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=vi(r)),this._initializationPromise=this.queue(async()=>{var n,i,s;if(!this._deleted&&(this.persistenceManager=await Co.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await gh(this,{idToken:e}),n=await kn._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Dr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(s=this.redirectUser)==null?void 0:s._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await vh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dr(this.app))return Promise.reject(yi(this));const r=e?vt(e):null;return r&&Pe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dr(this.app)?Promise.reject(yi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dr(this.app)?Promise.reject(yi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await SF(this),r=new IF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ca("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await xF(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&vi(e)||this._popupRedirectResolver;Pe(r,this,"argument-error"),this.redirectPersistenceManager=await Co.create(this,[vi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pe(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=BS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(Dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&tF(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Vs(t){return vt(t)}class zy{constructor(e){this.auth=e,this.observer=null,this.addObserver=rk(r=>this.observer=r)}get next(){return Pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ed={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RF(t){Ed=t}function jS(t){return Ed.loadJS(t)}function kF(){return Ed.recaptchaEnterpriseScript}function PF(){return Ed.gapiScript}function NF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class DF{constructor(){this.enterprise=new OF}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class OF{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const FF="recaptcha-enterprise",zS="NO_RECAPTCHA";class LF{constructor(e){this.type=FF,this.auth=Vs(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{hF(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new fF(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;My(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{a(u)}).catch(()=>{a(zS)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new DF().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&My(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=kF();l.length!==0&&(l+=o),jS(l).then(()=>{i(o,s,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function Wy(t,e,r,n=!1,i=!1){const s=new LF(t);let a;if(i)a=zS;else try{a=await s.verify(r)}catch{a=await s.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function dm(t,e,r,n,i){var s;if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Wy(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Wy(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bF(t,e){const r=Fs(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(ws(s,e??{}))return i;pn(i,"already-initialized")}return r.initialize({options:e})}function MF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(vi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function VF(t,e,r){const n=Vs(t);Pe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=WS(e),{host:a,port:o}=UF(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},f=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Pe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Pe(ws(u,n.config.emulator)&&ws(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,Ia(a)?(dg(`${s}//${a}${l}`),pg("Auth",!0)):BF()}function WS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function UF(t){const e=WS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:Hy(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Hy(a)}}}function Hy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function BF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return gi("not implemented")}_getIdTokenResponse(e){return gi("not implemented")}_linkToIdToken(e,r){return gi("not implemented")}_getReauthenticationResolver(e){return gi("not implemented")}}async function jF(t,e){return Fi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zF(t,e){return nc(t,"POST","/v1/accounts:signInWithPassword",Ms(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WF(t,e){return nc(t,"POST","/v1/accounts:signInWithEmailLink",Ms(t,e))}async function HF(t,e){return nc(t,"POST","/v1/accounts:signInWithEmailLink",Ms(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu extends l1{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Lu(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Lu(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dm(e,r,"signInWithPassword",zF);case"emailLink":return WF(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dm(e,n,"signUpPassword",jF);case"emailLink":return HF(e,{idToken:r,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(t,e){return nc(t,"POST","/v1/accounts:signInWithIdp",Ms(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F="http://localhost";class ya extends l1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ya(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):pn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...s}=r;if(!n||!i)return null;const a=new ya(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Ro(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ro(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ro(e,r)}buildRequest(){const e={requestUri:$F,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=qu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KF(t){const e=Fl(Ll(t)).link,r=e?Fl(Ll(e)).deep_link_id:null,n=Fl(Ll(t)).deep_link_id;return(n?Fl(Ll(n)).link:null)||n||r||e||t}class u1{constructor(e){const r=Fl(Ll(e)),n=r.apiKey??null,i=r.oobCode??null,s=GF(r.mode??null);Pe(n&&i&&s,"argument-error"),this.apiKey=n,this.operation=s,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=KF(e);try{return new u1(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){this.providerId=rl.PROVIDER_ID}static credential(e,r){return Lu._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=u1.parseLink(r);return Pe(n,"argument-error"),Lu._fromEmailAndCode(e,n.code,n.tenantId)}}rl.PROVIDER_ID="password";rl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic extends c1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends ic{constructor(){super("facebook.com")}static credential(e){return ya._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ji.credential(e.oauthAccessToken)}catch{return null}}}Ji.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ji.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di extends ic{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ya._fromParams({providerId:di.PROVIDER_ID,signInMethod:di.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return di.credentialFromTaggedObject(e)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return di.credential(r,n)}catch{return null}}}di.GOOGLE_SIGN_IN_METHOD="google.com";di.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends ic{constructor(){super("github.com")}static credential(e){return ya._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.GITHUB_SIGN_IN_METHOD="github.com";Zi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends ic{constructor(){super("twitter.com")}static credential(e,r){return ya._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return es.credential(r,n)}catch{return null}}}es.TWITTER_SIGN_IN_METHOD="twitter.com";es.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(t,e){return nc(t,"POST","/v1/accounts:signUp",Ms(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await kn._fromIdTokenResponse(e,n,i),a=$y(n);return new xa({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=$y(n);return new xa({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function $y(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends mn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,_h.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new _h(e,r,n,i)}}function HS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?_h._fromErrorAndOperation(t,s,e,n):s})}async function XF(t,e,r=!1){const n=await Ko(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return xa._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YF(t,e,r=!1){const{auth:n}=t;if(Dr(n.app))return Promise.reject(yi(n));const i="reauthenticate";try{const s=await Ko(t,HS(n,i,e,t),r);Pe(s.idToken,n,"internal-error");const a=a1(s.idToken);Pe(a,n,"internal-error");const{sub:o}=a;return Pe(t.uid===o,n,"user-mismatch"),xa._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&pn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $S(t,e,r=!1){if(Dr(t.app))return Promise.reject(yi(t));const n="signIn",i=await HS(t,n,e),s=await xa._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}async function QF(t,e){return $S(Vs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GS(t){const e=Vs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function JF(t,e,r){if(Dr(t.app))return Promise.reject(yi(t));const n=Vs(t),a=await dm(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qF).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&GS(t),l}),o=await xa._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function ZF(t,e,r){return Dr(t.app)?Promise.reject(yi(t)):QF(vt(t),rl.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&GS(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e6(t,e){return Fi(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t6(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=vt(t),s={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await Ko(n,e6(n.auth,s));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function r6(t,e,r,n){return vt(t).onIdTokenChanged(e,r,n)}function n6(t,e,r){return vt(t).beforeAuthStateChanged(e,r)}function i6(t,e,r,n){return vt(t).onAuthStateChanged(e,r,n)}function s6(t){return vt(t).signOut()}const yh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(yh,"1"),this.storage.removeItem(yh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a6=1e3,o6=10;class qS extends KS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=US(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);EF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,o6):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},a6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}qS.type="LOCAL";const l6=qS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS extends KS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}XS.type="SESSION";const YS=XS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Td(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await u6(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=f1("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===u)switch(d.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(){return window}function f6(t){ni().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(){return typeof ni().WorkerGlobalScope<"u"&&typeof ni().importScripts=="function"}async function h6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function d6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function p6(){return QS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS="firebaseLocalStorageDb",m6=1,xh="firebaseLocalStorage",ZS="fbase_key";class sc{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Sd(t,e){return t.transaction([xh],e?"readwrite":"readonly").objectStore(xh)}function g6(){const t=indexedDB.deleteDatabase(JS);return new sc(t).toPromise()}function pm(){const t=indexedDB.open(JS,m6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(xh,{keyPath:ZS})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(xh)?e(n):(n.close(),await g6(),e(await pm()))})})}async function Gy(t,e,r){const n=Sd(t,!0).put({[ZS]:e,value:r});return new sc(n).toPromise()}async function v6(t,e){const r=Sd(t,!1).get(e),n=await new sc(r).toPromise();return n===void 0?null:n.value}function Ky(t,e){const r=Sd(t,!0).delete(e);return new sc(r).toPromise()}const _6=800,y6=3;class eA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>y6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return QS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Td._getInstance(p6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await h6(),!this.activeServiceWorker)return;this.sender=new c6(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||d6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pm();return await Gy(e,yh,"1"),await Ky(e,yh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Gy(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>v6(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ky(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Sd(i,!1).getAll();return new sc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eA.type="LOCAL";const x6=eA;new rc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t,e){return e?vi(e):(Pe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1 extends l1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ro(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ro(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ro(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function w6(t){return $S(t.auth,new h1(t),t.bypassAuthState)}function E6(t){const{auth:e,user:r}=t;return Pe(r,e,"internal-error"),YF(r,new h1(t),t.bypassAuthState)}async function T6(t){const{auth:e,user:r}=t;return Pe(r,e,"internal-error"),XF(r,new h1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w6;case"linkViaPopup":case"linkViaRedirect":return T6;case"reauthViaPopup":case"reauthViaRedirect":return E6;default:pn(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6=new rc(2e3,1e4);async function A6(t,e,r){if(Dr(t.app))return Promise.reject(Fn(t,"operation-not-supported-in-this-environment"));const n=Vs(t);rF(t,e,c1);const i=tA(n,r);return new ia(n,"signInViaPopup",e,i).executeNotNull()}class ia extends rA{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,ia.currentPopupAction&&ia.currentPopupAction.cancel(),ia.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pe(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=f1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ia.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,S6.get())};e()}}ia.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I6="pendingRedirect",Rf=new Map;class C6 extends rA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Rf.get(this.auth._key());if(!e){try{const n=await R6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Rf.set(this.auth._key(),e)}return this.bypassAuthState||Rf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function R6(t,e){const r=N6(e),n=P6(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function k6(t,e){Rf.set(t._key(),e)}function P6(t){return vi(t._redirectPersistence)}function N6(t){return Cf(I6,t.config.apiKey,t.name)}async function D6(t,e,r=!1){if(Dr(t.app))return Promise.reject(yi(t));const n=Vs(t),i=tA(n,e),a=await new C6(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6=10*60*1e3;class F6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!L6(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!nA(e)){const i=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(Fn(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=O6&&this.cachedEventUids.clear(),this.cachedEventUids.has(qy(e))}saveEventToCache(e){this.cachedEventUids.add(qy(e)),this.lastProcessedEventTime=Date.now()}}function qy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function nA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function L6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b6(t,e={}){return Fi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,V6=/^https?/;async function U6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await b6(t);for(const r of e)try{if(B6(r))return}catch{}pn(t,"unauthorized-domain")}function B6(t){const e=fm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!V6.test(r))return!1;if(M6.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6=new rc(3e4,6e4);function Xy(){const t=ni().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function z6(t){return new Promise((e,r)=>{var i,s,a;function n(){Xy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xy(),r(Fn(t,"network-request-failed"))},timeout:j6.get()})}if((s=(i=ni().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((a=ni().gapi)!=null&&a.load)n();else{const o=NF("iframefcb");return ni()[o]=()=>{gapi.load?n():r(Fn(t,"network-request-failed"))},jS(`${PF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw kf=null,e})}let kf=null;function W6(t){return kf=kf||z6(t),kf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=new rc(5e3,15e3),$6="__/auth/iframe",G6="emulator/auth/iframe",K6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X6(t){const e=t.config;Pe(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?s1(e,G6):`https://${t.config.authDomain}/${$6}`,n={apiKey:e.apiKey,appName:t.name,v:Ra},i=q6.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${qu(n).slice(1)}`}async function Y6(t){const e=await W6(t),r=ni().gapi;return Pe(r,t,"internal-error"),e.open({where:document.body,url:X6(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:K6,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Fn(t,"network-request-failed"),o=ni().setTimeout(()=>{s(a)},H6.get());function l(){ni().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},J6=500,Z6=600,eL="_blank",tL="http://localhost";class Yy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rL(t,e,r,n=J6,i=Z6){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...Q6,width:n.toString(),height:i.toString(),top:s,left:a},u=wr().toLowerCase();r&&(o=FS(u)?eL:r),DS(u)&&(e=e||tL,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[m,y])=>`${d}${m}=${y},`,"");if(wF(u)&&o!=="_self")return nL(e||"",o),new Yy(null);const h=window.open(e||"",o,f);Pe(h,t,"popup-blocked");try{h.focus()}catch{}return new Yy(h)}function nL(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL="__/auth/handler",sL="emulator/auth/handler",aL=encodeURIComponent("fac");async function Qy(t,e,r,n,i,s){Pe(t.config.authDomain,t,"auth-domain-config-required"),Pe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ra,eventId:i};if(e instanceof c1){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",tk(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof ic){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${aL}=${encodeURIComponent(l)}`:"";return`${oL(t)}?${qu(o).slice(1)}${u}`}function oL({config:t}){return t.emulator?s1(t,sL):`https://${t.authDomain}/${iL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0="webStorageSupport";class lL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=YS,this._completeRedirectFn=D6,this._overrideRedirectResult=k6}async _openPopup(e,r,n,i){var a;Pi((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const s=await Qy(e,r,n,fm(),i);return rL(e,s,f1())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await Qy(e,r,n,fm(),i);return f6(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Pi(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await Y6(e),n=new F6(e);return r.register("authEvent",i=>(Pe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(F0,{type:F0},i=>{var a;const s=(a=i==null?void 0:i[0])==null?void 0:a[F0];s!==void 0&&r(!!s),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=U6(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return US()||OS()||o1()}}const uL=lL;var Jy="@firebase/auth",Zy="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hL(t){Mn(new dn("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Pe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BS(t)},u=new CF(n,i,s,l);return MF(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Mn(new dn("auth-internal",e=>{const r=Vs(e.getProvider("auth").getImmediate());return(n=>new cL(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vr(Jy,Zy,fL(t)),Vr(Jy,Zy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=5*60,pL=mT("authIdTokenMaxAge")||dL;let ex=null;const mL=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>pL)return;const i=r==null?void 0:r.token;ex!==i&&(ex=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gL(t=rd()){const e=Fs(t,"auth");if(e.isInitialized())return e.getImmediate();const r=bF(t,{popupRedirectResolver:uL,persistence:[x6,l6,YS]}),n=mT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=mL(s.toString());n6(r,a,()=>a(r.currentUser)),r6(r,o=>a(o))}}const i=hT("auth");return i&&VF(r,`http://${i}`),r}function vL(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}RF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Fn("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",vL().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hL("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="firebasestorage.googleapis.com",_L="storageBucket",yL=2*60*1e3,xL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends mn{constructor(e,r,n=0){super(L0(e),`Firebase Storage: ${r} (${L0(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,oi.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return L0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var si;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(si||(si={}));function L0(t){return"storage/"+t}function wL(){const t="An unknown error occurred, please check the error payload for server response.";return new oi(si.UNKNOWN,t)}function EL(){return new oi(si.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function TL(){return new oi(si.CANCELED,"User canceled the upload/download.")}function SL(t){return new oi(si.INVALID_URL,"Invalid URL '"+t+"'.")}function AL(t){return new oi(si.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function tx(t){return new oi(si.INVALID_ARGUMENT,t)}function sA(){return new oi(si.APP_DELETED,"The Firebase app was deleted.")}function IL(t){return new oi(si.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Pn.makeFromUrl(e,r)}catch{return new Pn(e,"")}if(n.path==="")return n;throw AL(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${f}/b/${i}/o${d}`,"i"),y={bucket:1,path:3},g=r===iA?"(?:storage.googleapis.com|storage.cloud.google.com)":r,A="([^?#]*)",w=new RegExp(`^https?://${g}/${i}/${A}`,"i"),I=[{regex:o,indices:l,postModify:s},{regex:m,indices:y,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let L=0;L<I.length;L++){const W=I[L],G=W.regex.exec(e);if(G){const E=G[W.indices.bucket];let T=G[W.indices.path];T||(T=""),n=new Pn(E,T),W.postModify(n);break}}if(n==null)throw SL(e);return n}}class CL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RL(t,e,r){let n=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function f(...A){u||(u=!0,e.apply(null,A))}function h(A){i=setTimeout(()=>{i=null,t(m,l())},A)}function d(){s&&clearTimeout(s)}function m(A,...w){if(u){d();return}if(A){d(),f.call(null,A,...w);return}if(l()||a){d(),f.call(null,A,...w);return}n<64&&(n*=2);let I;o===1?(o=2,I=0):I=(n+Math.random())*1e3,h(I)}let y=!1;function g(A){y||(y=!0,d(),!u&&(i!==null?(A||(o=2),clearTimeout(i),h(0)):A||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,g(!0)},r),g}function kL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(t){return t!==void 0}function rx(t,e,r,n){if(n<e)throw tx(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw tx(`Invalid value for '${t}'. Expected ${r} or less.`)}function NL(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var wh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(wh||(wh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{constructor(e,r,n,i,s,a,o,l,u,f,h,d=!0,m=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=h,this.retry=d,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,g)=>{this.resolve_=y,this.reject_=g,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Jc(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===wh.NO_ERROR,l=s.getStatus();if(!o||DL(l,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===wh.ABORT;n(!1,new Jc(!1,null,f));return}const u=this.successCodes_.indexOf(l)!==-1;n(!0,new Jc(u,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());PL(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=wL();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?sA():TL();a(l)}else{const l=EL();a(l)}};this.canceled_?r(!1,new Jc(!1,null,!0)):this.backoffId_=RL(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&kL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Jc{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function FL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function LL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function bL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ML(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function VL(t,e,r,n,i,s,a=!0,o=!1){const l=NL(t.urlParams),u=t.url+l,f=Object.assign({},t.headers);return bL(f,e),FL(f,r),LL(f,s),ML(f,n),new OL(u,t.method,f,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function BL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,r){this._service=e,r instanceof Pn?this._location=r:this._location=Pn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Eh(e,r)}get root(){const e=new Pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return BL(this._location.path)}get storage(){return this._service}get parent(){const e=UL(this._location.path);if(e===null)return null;const r=new Pn(this._location.bucket,e);return new Eh(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw IL(e)}}function nx(t,e){const r=e==null?void 0:e[_L];return r==null?null:Pn.makeFromBucketSpec(r,t)}function jL(t,e,r,n={}){t.host=`${e}:${r}`;const i=Ia(e);i&&(dg(`https://${t.host}/b`),pg("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:gT(s,t.app.options.projectId))}class zL{constructor(e,r,n,i,s,a=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=iA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yL,this._maxUploadRetryTime=xL,this._requests=new Set,i!=null?this._bucket=Pn.makeFromBucketSpec(i,this._host):this._bucket=nx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Pn.makeFromBucketSpec(this._url,e):this._bucket=nx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){rx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){rx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Eh(this,e)}_makeRequest(e,r,n,i,s=!0){if(this._deleted)return new CL(sA());{const a=VL(e,this._appId,n,i,r,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const ix="@firebase/storage",sx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="storage";function WL(t=rd(),e){t=vt(t);const n=Fs(t,aA).getImmediate({identifier:e}),i=dT("storage");return i&&HL(n,...i),n}function HL(t,e,r,n={}){jL(t,e,r,n)}function $L(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new zL(r,n,i,e,Ra)}function GL(){Mn(new dn(aA,$L,"PUBLIC").setMultipleInstances(!0)),Vr(ix,sx,""),Vr(ix,sx,"esm2020")}GL();const KL={apiKey:"AIzaSyCsVopI5-6yaYBX78_jpXKujV9xHIzYFYM",authDomain:"regradeplus-b0390.firebaseapp.com",projectId:"regradeplus-b0390",storageBucket:"regradeplus-b0390.firebasestorage.app",messagingSenderId:"398294611314",appId:"1:398294611314:web:2478255b5063900bdc19eb",measurementId:"G-VMQM7QQ0K4"},Ad=TT(KL);FN(Ad);const wn=LO(Ad),ac=gL(Ad);WL(Ad);const En={USERS:"users",SUBMISSIONS:"submissions"},qa=t=>t?t instanceof ct?t.toDate().toISOString():t:null,Ct={getUsers:async()=>{try{const t=qc(wn,En.USERS);return(await N0(t)).docs.map(r=>({id:r.id,...r.data()}))}catch(t){return console.error("Error getting users:",t),[]}},getUserByEmail:async t=>{try{const e=qc(wn,En.USERS),r=KO(e,qO("email","==",t)),n=await N0(r);if(n.empty)return null;const i=n.docs[0];return{id:i.id,...i.data()}}catch(e){return console.error("Error getting user by email:",e),null}},saveUser:async t=>{try{const e=t.email.replace(/[.@]/g,"_"),r=qs(wn,En.USERS,e);return await D0(r,{...t,updatedAt:Yc()},{merge:!0}),{success:!0}}catch(e){return console.error("Error saving user:",e),{success:!1,error:e.message}}},saveUsers:async t=>{try{const e=t.map(r=>Ct.saveUser(r));return await Promise.all(e),{success:!0}}catch(e){return console.error("Error saving users:",e),{success:!1,error:e.message}}},getSubmissions:async()=>{try{const t=qc(wn,En.SUBMISSIONS);return(await N0(t)).docs.map(r=>{const n=r.data();return{id:r.id,...n,submittedAt:qa(n.submittedAt),completedAt:qa(n.completedAt),deletedAt:qa(n.deletedAt)}})}catch(t){return console.error("Error getting submissions:",t),[]}},subscribeToSubmissions:t=>{try{const e=qc(wn,En.SUBMISSIONS);return JO(e,r=>{const n=r.docs.map(i=>{const s=i.data();return{id:i.id,...s,submittedAt:qa(s.submittedAt),completedAt:qa(s.completedAt),deletedAt:qa(s.deletedAt)}});t(n)},r=>{console.error("Error in submissions subscription:",r)})}catch(e){return console.error("Error subscribing to submissions:",e),()=>{}}},addSubmission:async t=>{try{const e=t.id||Date.now().toString(),r=qs(wn,En.SUBMISSIONS,e);return await D0(r,{...t,submittedAt:Yc()}),{success:!0,id:e}}catch(e){return console.error("Error adding submission:",e),{success:!1,error:e.message}}},updateSubmission:async(t,e)=>{try{const r=qs(wn,En.SUBMISSIONS,t);return await Xc(r,{...e,updatedAt:Yc()}),{success:!0}}catch(r){return console.error("Error updating submission:",r),{success:!1,error:r.message}}},saveSubmissions:async t=>{try{const e=t.map(r=>{const n=qs(wn,En.SUBMISSIONS,r.id);return D0(n,r,{merge:!0})});return await Promise.all(e),{success:!0}}catch(e){return console.error("Error saving submissions:",e),{success:!1,error:e.message}}},deleteSubmission:async t=>{try{const e=qs(wn,En.SUBMISSIONS,t);return await Xc(e,{isDeleted:!0,deletedAt:Yc()}),{success:!0}}catch(e){return console.error("Error deleting submission:",e),{success:!1,error:e.message}}},restoreSubmission:async t=>{try{const e=qs(wn,En.SUBMISSIONS,t);return await Xc(e,{isDeleted:!1,deletedAt:null,status:""}),{success:!0}}catch(e){return console.error("Error restoring submission:",e),{success:!1,error:e.message}}},permanentDeleteSubmission:async t=>{try{const e=qs(wn,En.SUBMISSIONS,t);return await Xc(e,{isPermanentlyDeleted:!0}),{success:!0}}catch(e){return console.error("Error permanently deleting submission:",e),{success:!1,error:e.message}}}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Th={};Th.version="0.18.5";var oA=1252,qL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lA=function(t){qL.indexOf(t)!=-1&&(oA=t)};function XL(){lA(1252)}var bu=function(t){lA(t)};function YL(){bu(1200),XL()}var Zc=function(e){return String.fromCharCode(e)},ax=function(e){return String.fromCharCode(e)},Sh,is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mu(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=is.charAt(s)+is.charAt(a)+is.charAt(o)+is.charAt(l);return e}function Ni(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=is.indexOf(t.charAt(u++)),a=is.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=is.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=is.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Li=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function wa(t){return qe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ox(t){return qe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Rn=function(e){return qe?Li(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Id(t){if(typeof ArrayBuffer>"u")return Rn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function oc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function QL(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var sr=qe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Li(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function JL(t){for(var e=[],r=0,n=t.length+250,i=wa(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=wa(65535),n=65530)}return e.push(i.slice(0,r)),sr(e)}var ru=/\u0000/g,ef=/[\u0001-\u0006]/g;function ko(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Nn(t,e){var r=""+t;return r.length>=e?r:St("0",e-r.length)+r}function d1(t,e){var r=""+t;return r.length>=e?r:St(" ",e-r.length)+r}function Ah(t,e){var r=""+t;return r.length>=e?r:r+St(" ",e-r.length)}function ZL(t,e){var r=""+Math.round(t);return r.length>=e?r:St("0",e-r.length)+r}function e5(t,e){var r=""+t;return r.length>=e?r:St("0",e-r.length)+r}var lx=Math.pow(2,32);function Xa(t,e){if(t>lx||t<-lx)return ZL(t,e);var r=Math.round(t);return e5(r,e)}function Ih(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ux=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],b0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function t5(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var At={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},cx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},r5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ch(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,h=Math.floor(i);u<e&&(h=Math.floor(i),o=h*a+s,f=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function tf(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=u5(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var uA=new Date(1899,11,31,0,0,0),n5=uA.getTime(),i5=new Date(1900,2,1,0,0,0);function cA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=i5&&(r+=24*60*60*1e3),(r-(n5+(t.getTimezoneOffset()-uA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function p1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function s5(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function a5(t){var e=t<0?12:11,r=p1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function o5(t){var e=p1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function l5(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=a5(t):e===10?r=t.toFixed(10).substr(0,12):r=o5(t),p1(s5(r.toUpperCase()))}function mm(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):l5(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Rs(14,cA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function u5(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function c5(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return b0[r.m-1][1];case 5:return b0[r.m-1][0];default:return b0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return ux[r.q][0];default:return ux[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Nn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Nn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Nn(l,u):"";return f}function ss(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var fA=/%/g;function f5(t,e,r){var n=e.replace(fA,""),i=e.length-n.length;return xi(t,n,r*Math.pow(10,2*i))+St("%",i)}function h5(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return xi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+hA(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dA=/# (\?+)( ?)\/( ?)(\d+)/;function d5(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?St(" ",t[1].length+1+t[4].length):d1(a,t[1].length)+t[2]+"/"+t[3]+Nn(o,t[4].length))}function p5(t,e,r){return r+(e===0?"":""+e)+St(" ",t[1].length+2+t[4].length)}var pA=/^#*0*\.([0#]+)/,mA=/\).*[0#]/,gA=/\(###\) ###\\?-####/;function Tr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function fx(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function hx(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function m5(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function g5(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function nn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nn("n",n,r):"("+nn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return h5(t,e,r);if(e.indexOf("%")!==-1)return f5(t,e,r);if(e.indexOf("E")!==-1)return hA(e,r);if(e.charCodeAt(0)===36)return"$"+nn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Xa(l,e.length);if(e.match(/^[#?]+$/))return i=Xa(r,0),i==="0"&&(i=""),i.length>e.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(dA))return d5(s,l,u);if(e.match(/^#+0+$/))return u+Xa(l,e.length-e.indexOf("0"));if(s=e.match(pA))return i=fx(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])).replace(/\.(\d*)$/,function(y,g){return"."+g+St("0",Tr(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+fx(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ss(Xa(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nn(t,e,-r):ss(""+(Math.floor(r)+m5(r,s[1].length)))+"."+Nn(hx(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return nn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ko(nn(t,e.replace(/[\\-]/g,""),r)),a=0,ko(ko(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(gA))return i=nn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ch(l,Math.pow(10,a)-1,!1),i=""+u,f=xi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Ah(o[2],a),f.length<s[4].length&&(f=Tr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ch(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?d1(o[1],a)+s[2]+"/"+s[3]+Ah(o[2],a):St(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Xa(r,0),e.length<=i.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Tr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=hx(r,s[1].length),r<0?"-"+nn(t,e,-r):ss(g5(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Nn(0,3-y.length):"")+y})+"."+Nn(a,s[1].length);switch(e){case"###,##0.00":return nn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ss(Xa(l,0));return m!=="0"?u+m:"";case"###,###.00":return nn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return nn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function v5(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return xi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function _5(t,e,r){var n=e.replace(fA,""),i=e.length-n.length;return xi(t,n,r*Math.pow(10,2*i))+St("%",i)}function vA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vA(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Hn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hn("n",n,r):"("+Hn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return v5(t,e,r);if(e.indexOf("%")!==-1)return _5(t,e,r);if(e.indexOf("E")!==-1)return vA(e,r);if(e.charCodeAt(0)===36)return"$"+Hn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Nn(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(dA))return p5(s,l,u);if(e.match(/^#+0+$/))return u+Nn(l,e.length-e.indexOf("0"));if(s=e.match(pA))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])),i=i.replace(/\.(\d*)$/,function(y,g){return"."+g+St("0",Tr(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ss(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hn(t,e,-r):ss(""+r)+"."+St("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Hn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ko(Hn(t,e.replace(/[\\-]/g,""),r)),a=0,ko(ko(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(gA))return i=Hn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ch(l,Math.pow(10,a)-1,!1),i=""+u,f=xi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Ah(o[2],a),f.length<s[4].length&&(f=Tr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ch(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?d1(o[1],a)+s[2]+"/"+s[3]+Ah(o[2],a):St(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Tr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Tr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Hn(t,e,-r):ss(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Nn(0,3-y.length):"")+y})+"."+Nn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=ss(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return Hn(t,e.slice(0,e.lastIndexOf(".")),r)+Tr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function xi(t,e,r){return(r|0)===r?Hn(t,e,r):nn(t,e,r)}function y5(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var _A=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yA(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ih(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(_A))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function x5(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Ih(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=tf(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=tf(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=tf(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",a+=5,d="h"):(g.t="t",++a),u==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(_A)){if(u==null&&(u=tf(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yA(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var A=0,w=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",A<1&&(A=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(w=Math.max(w,x[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&i[a].v.match(/[Hh]/)&&(A=1),A<2&&i[a].v.match(/[Mm]/)&&(A=2),A<3&&i[a].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var I="",L;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=c5(i[a].t.charCodeAt(0),i[a].v,u,w),i[a].t="t";break;case"n":case"?":for(L=a+1;i[L]!=null&&((o=i[L].t)==="?"||o==="D"||(o===" "||o==="t")&&i[L+1]!=null&&(i[L+1].t==="?"||i[L+1].t==="t"&&i[L+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[L].v==="/"||i[L].v===" "&&i[L+1]!=null&&i[L+1].t=="?"));)i[a].v+=i[L].v,i[L]={v:"",t:";"},++L;I+=i[a].v,a=L-1;break;case"G":i[a].t="t",i[a].v=mm(e,r);break}var W="",G,E;if(I.length>0){I.charCodeAt(0)==40?(G=e<0&&I.charCodeAt(0)===45?-e:e,E=xi("n",I,G)):(G=e<0&&n>1?-e:e,E=xi("n",I,G),G<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),L=E.length-1;var T=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){T=a;break}var S=i.length;if(T===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(L>=i[a].v.length-1?(L-=i[a].v.length,i[a].v=E.substr(L+1,i[a].v.length)):L<0?i[a].v="":(i[a].v=E.substr(0,L+1),L=-1),i[a].t="t",S=a);L>=0&&S<i.length&&(i[S].v=E.substr(0,L+1)+i[S].v)}else if(T!==i.length&&E.indexOf("E")===-1){for(L=E.indexOf(".")-1,a=T;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")-1:i[a].v.length-1,W=i[a].v.substr(f+1);f>=0;--f)L>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(W=E.charAt(L--)+W);i[a].v=W,i[a].t="t",S=a}for(L>=0&&S<i.length&&(i[S].v=E.substr(0,L+1)+i[S].v),L=E.indexOf(".")+1,a=T;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==T)){for(f=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")+1:0,W=i[a].v.substr(0,f);f<i[a].v.length;++f)L<E.length&&(W+=E.charAt(L++));i[a].v=W,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(G=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=xi(i[a].t,i[a].v,G),i[a].t="t");var R="";for(a=0;a!==i.length;++a)i[a]!=null&&(R+=i[a].v);return R}var dx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function px(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function w5(t,e){var r=y5(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(dx),o=r[1].match(dx);return px(e,a)?[n,r[0]]:px(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Rs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:At)[t],n==null&&(n=r.table&&r.table[cx[t]]||At[cx[t]]),n==null&&(n=r5[t]||"General");break}if(Ih(n,0))return mm(e,r);e instanceof Date&&(e=cA(e,r.date1904));var i=w5(n,e);if(Ih(i[1]))return mm(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return x5(i[1],e,r,i[0])}function xA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(At[r]==null){e<0&&(e=r);continue}if(At[r]==t){e=r;break}}e<0&&(e=391)}return At[e]=t,e}function Cd(t){for(var e=0;e!=392;++e)t[e]!==void 0&&xA(t[e],e)}function Rd(){At=t5()}var wA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function E5(t){var e=typeof t=="number"?At[t]:t;return e=e.replace(wA,"(\\d+)"),new RegExp("^"+e+"$")}function T5(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(wA)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var S5=function(){var t={};t.version="1.2.0";function e(){for(var E=0,T=new Array(256),S=0;S!=256;++S)E=S,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,T[S]=E;return typeof Int32Array<"u"?new Int32Array(T):T}var r=e();function n(E){var T=0,S=0,R=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)N[R]=E[R];for(R=0;R!=256;++R)for(S=E[R],T=256+R;T<4096;T+=256)S=N[T]=S>>>8^E[S&255];var M=[];for(R=1;R!=16;++R)M[R-1]=typeof Int32Array<"u"?N.subarray(R*256,R*256+256):N.slice(R*256,R*256+256);return M}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],h=i[6],d=i[7],m=i[8],y=i[9],g=i[10],A=i[11],w=i[12],x=i[13],I=i[14];function L(E,T){for(var S=T^-1,R=0,N=E.length;R<N;)S=S>>>8^r[(S^E.charCodeAt(R++))&255];return~S}function W(E,T){for(var S=T^-1,R=E.length-15,N=0;N<R;)S=I[E[N++]^S&255]^x[E[N++]^S>>8&255]^w[E[N++]^S>>16&255]^A[E[N++]^S>>>24]^g[E[N++]]^y[E[N++]]^m[E[N++]]^d[E[N++]]^h[E[N++]]^f[E[N++]]^u[E[N++]]^l[E[N++]]^o[E[N++]]^a[E[N++]]^s[E[N++]]^r[E[N++]];for(R+=15;N<R;)S=S>>>8^r[(S^E[N++])&255];return~S}function G(E,T){for(var S=T^-1,R=0,N=E.length,M=0,D=0;R<N;)M=E.charCodeAt(R++),M<128?S=S>>>8^r[(S^M)&255]:M<2048?(S=S>>>8^r[(S^(192|M>>6&31))&255],S=S>>>8^r[(S^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,D=E.charCodeAt(R++)&1023,S=S>>>8^r[(S^(240|M>>8&7))&255],S=S>>>8^r[(S^(128|M>>2&63))&255],S=S>>>8^r[(S^(128|D>>6&15|(M&3)<<4))&255],S=S>>>8^r[(S^(128|D&63))&255]):(S=S>>>8^r[(S^(224|M>>12&15))&255],S=S>>>8^r[(S^(128|M>>6&63))&255],S=S>>>8^r[(S^(128|M&63))&255]);return~S}return t.table=r,t.bstr=L,t.buf=W,t.str=G,t}(),rt=function(){var e={};e.version="1.2.1";function r(C,F){for(var P=C.split("/"),O=F.split("/"),b=0,U=0,q=Math.min(P.length,O.length);b<q;++b){if(U=P[b].length-O[b].length)return U;if(P[b]!=O[b])return P[b]<O[b]?-1:1}return P.length-O.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var F=C.lastIndexOf("/");return F===-1?C:C.slice(0,F+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var F=C.lastIndexOf("/");return F===-1?C:C.slice(F+1)}function s(C,F){typeof F=="string"&&(F=new Date(F));var P=F.getHours();P=P<<6|F.getMinutes(),P=P<<5|F.getSeconds()>>>1,C.write_shift(2,P);var O=F.getFullYear()-1980;O=O<<4|F.getMonth()+1,O=O<<5|F.getDate(),C.write_shift(2,O)}function a(C){var F=C.read_shift(2)&65535,P=C.read_shift(2)&65535,O=new Date,b=P&31;P>>>=5;var U=P&15;P>>>=4,O.setMilliseconds(0),O.setFullYear(P+1980),O.setMonth(U-1),O.setDate(b);var q=F&31;F>>>=5;var ee=F&63;return F>>>=6,O.setHours(F),O.setMinutes(ee),O.setSeconds(q<<1),O}function o(C){$r(C,0);for(var F={},P=0;C.l<=C.length-4;){var O=C.read_shift(2),b=C.read_shift(2),U=C.l+b,q={};switch(O){case 21589:P=C.read_shift(1),P&1&&(q.mtime=C.read_shift(4)),b>5&&(P&2&&(q.atime=C.read_shift(4)),P&4&&(q.ctime=C.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}C.l=U,F[O]=q}return F}var l;function u(){return l||(l={})}function f(C,F){if(C[0]==80&&C[1]==75)return Mi(C,F);if((C[0]|32)==109&&(C[1]|32)==105)return Md(C,F);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var P=3,O=512,b=0,U=0,q=0,ee=0,K=0,X=[],Y=C.slice(0,512);$r(Y,0);var oe=h(Y);switch(P=oe[0],P){case 3:O=512;break;case 4:O=4096;break;case 0:if(oe[1]==0)return Mi(C,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}O!==512&&(Y=C.slice(0,O),$r(Y,28));var me=C.slice(0,O);d(Y,P);var xe=Y.read_shift(4,"i");if(P===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);Y.l+=4,q=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),ee=Y.read_shift(4,"i"),b=Y.read_shift(4,"i"),K=Y.read_shift(4,"i"),U=Y.read_shift(4,"i");for(var le=-1,_e=0;_e<109&&(le=Y.read_shift(4,"i"),!(le<0));++_e)X[_e]=le;var Oe=m(C,O);A(K,U,Oe,O,X);var ot=x(Oe,q,X,O);ot[q].name="!Directory",b>0&&ee!==D&&(ot[ee].name="!MiniFAT"),ot[X[0]].name="!FAT",ot.fat_addrs=X,ot.ssz=O;var lt={},Ut=[],ui=[],ci=[];I(q,ot,Oe,Ut,b,lt,ui,ee),y(ui,ci,Ut),Ut.shift();var Ui={FileIndex:ui,FullPaths:ci};return F&&F.raw&&(Ui.raw={header:me,sectors:Oe}),Ui}function h(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Re,"Header Signature: "),C.l+=16;var F=C.read_shift(2,"u");return[C.read_shift(2,"u"),F]}function d(C,F){var P=9;switch(C.l+=2,P=C.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function m(C,F){for(var P=Math.ceil(C.length/F)-1,O=[],b=1;b<P;++b)O[b-1]=C.slice(b*F,(b+1)*F);return O[P-1]=C.slice(P*F),O}function y(C,F,P){for(var O=0,b=0,U=0,q=0,ee=0,K=P.length,X=[],Y=[];O<K;++O)X[O]=Y[O]=O,F[O]=P[O];for(;ee<Y.length;++ee)O=Y[ee],b=C[O].L,U=C[O].R,q=C[O].C,X[O]===O&&(b!==-1&&X[b]!==b&&(X[O]=X[b]),U!==-1&&X[U]!==U&&(X[O]=X[U])),q!==-1&&(X[q]=O),b!==-1&&O!=X[O]&&(X[b]=X[O],Y.lastIndexOf(b)<ee&&Y.push(b)),U!==-1&&O!=X[O]&&(X[U]=X[O],Y.lastIndexOf(U)<ee&&Y.push(U));for(O=1;O<K;++O)X[O]===O&&(U!==-1&&X[U]!==U?X[O]=X[U]:b!==-1&&X[b]!==b&&(X[O]=X[b]));for(O=1;O<K;++O)if(C[O].type!==0){if(ee=O,ee!=X[ee])do ee=X[ee],F[O]=F[ee]+"/"+F[O];while(ee!==0&&X[ee]!==-1&&ee!=X[ee]);X[O]=-1}for(F[0]+="/",O=1;O<K;++O)C[O].type!==2&&(F[O]+="/")}function g(C,F,P){for(var O=C.start,b=C.size,U=[],q=O;P&&b>0&&q>=0;)U.push(F.slice(q*M,q*M+M)),b-=M,q=Js(P,q*4);return U.length===0?Z(0):sr(U).slice(0,C.size)}function A(C,F,P,O,b){var U=D;if(C===D){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var q=P[C],ee=(O>>>2)-1;if(!q)return;for(var K=0;K<ee&&(U=Js(q,K*4))!==D;++K)b.push(U);A(Js(q,O-4),F-1,P,O,b)}}function w(C,F,P,O,b){var U=[],q=[];b||(b=[]);var ee=O-1,K=0,X=0;for(K=F;K>=0;){b[K]=!0,U[U.length]=K,q.push(C[K]);var Y=P[Math.floor(K*4/O)];if(X=K*4&ee,O<4+X)throw new Error("FAT boundary crossed: "+K+" 4 "+O);if(!C[Y])break;K=Js(C[Y],X)}return{nodes:U,data:Ex([q])}}function x(C,F,P,O){var b=C.length,U=[],q=[],ee=[],K=[],X=O-1,Y=0,oe=0,me=0,xe=0;for(Y=0;Y<b;++Y)if(ee=[],me=Y+F,me>=b&&(me-=b),!q[me]){K=[];var le=[];for(oe=me;oe>=0;){le[oe]=!0,q[oe]=!0,ee[ee.length]=oe,K.push(C[oe]);var _e=P[Math.floor(oe*4/O)];if(xe=oe*4&X,O<4+xe)throw new Error("FAT boundary crossed: "+oe+" 4 "+O);if(!C[_e]||(oe=Js(C[_e],xe),le[oe]))break}U[me]={nodes:ee,data:Ex([K])}}return U}function I(C,F,P,O,b,U,q,ee){for(var K=0,X=O.length?2:0,Y=F[C].data,oe=0,me=0,xe;oe<Y.length;oe+=128){var le=Y.slice(oe,oe+128);$r(le,64),me=le.read_shift(2),xe=y1(le,0,me-X),O.push(xe);var _e={name:xe,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},Oe=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Oe!==0&&(_e.ct=L(le,le.l-8));var ot=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);ot!==0&&(_e.mt=L(le,le.l-8)),_e.start=le.read_shift(4,"i"),_e.size=le.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=D,_e.name=""),_e.type===5?(K=_e.start,b>0&&K!==D&&(F[K].name="!StreamData")):_e.size>=4096?(_e.storage="fat",F[_e.start]===void 0&&(F[_e.start]=w(P,_e.start,F.fat_addrs,F.ssz)),F[_e.start].name=_e.name,_e.content=F[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:K!==D&&_e.start!==D&&F[K]&&(_e.content=g(_e,F[K].data,(F[ee]||{}).data))),_e.content&&$r(_e.content,0),U[xe]=_e,q.push(_e)}}function L(C,F){return new Date((Kr(C,F+4)/1e7*Math.pow(2,32)+Kr(C,F)/1e7-11644473600)*1e3)}function W(C,F){return u(),f(l.readFileSync(C),F)}function G(C,F){var P=F&&F.type;switch(P||qe&&Buffer.isBuffer(C)&&(P="buffer"),P||"base64"){case"file":return W(C,F);case"base64":return f(Rn(Ni(C)),F);case"binary":return f(Rn(C),F)}return f(C,F)}function E(C,F){var P=F||{},O=P.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=O+"/",C.FileIndex[0]={name:O,type:5}),P.CLSID&&(C.FileIndex[0].clsid=P.CLSID),T(C)}function T(C){var F="Sh33tJ5";if(!rt.find(C,"/"+F)){var P=Z(4);P[0]=55,P[1]=P[3]=50,P[2]=54,C.FileIndex.push({name:F,type:2,content:P,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+F),S(C)}}function S(C,F){E(C);for(var P=!1,O=!1,b=C.FullPaths.length-1;b>=0;--b){var U=C.FileIndex[b];switch(U.type){case 0:O?P=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(U.R*U.L*U.C)&&(P=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!F)){var q=new Date(1987,1,19),ee=0,K=Object.create?Object.create(null):{},X=[];for(b=0;b<C.FullPaths.length;++b)K[C.FullPaths[b]]=!0,C.FileIndex[b].type!==0&&X.push([C.FullPaths[b],C.FileIndex[b]]);for(b=0;b<X.length;++b){var Y=n(X[b][0]);O=K[Y],O||(X.push([Y,{name:i(Y).replace("/",""),type:1,clsid:nt,ct:q,mt:q,content:null}]),K[Y]=!0)}for(X.sort(function(xe,le){return r(xe[0],le[0])}),C.FullPaths=[],C.FileIndex=[],b=0;b<X.length;++b)C.FullPaths[b]=X[b][0],C.FileIndex[b]=X[b][1];for(b=0;b<X.length;++b){var oe=C.FileIndex[b],me=C.FullPaths[b];if(oe.name=i(me).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||nt,b===0)oe.C=X.length>1?1:-1,oe.size=0,oe.type=5;else if(me.slice(-1)=="/"){for(ee=b+1;ee<X.length&&n(C.FullPaths[ee])!=me;++ee);for(oe.C=ee>=X.length?-1:ee,ee=b+1;ee<X.length&&n(C.FullPaths[ee])!=n(me);++ee);oe.R=ee>=X.length?-1:ee,oe.type=1}else n(C.FullPaths[b+1]||"")==n(me)&&(oe.R=b+1),oe.type=2}}}function R(C,F){var P=F||{};if(P.fileType=="mad")return Vd(C,P);switch(S(C),P.fileType){case"zip":return Zt(C,P)}var O=function(xe){for(var le=0,_e=0,Oe=0;Oe<xe.FileIndex.length;++Oe){var ot=xe.FileIndex[Oe];if(ot.content){var lt=ot.content.length;lt>0&&(lt<4096?le+=lt+63>>6:_e+=lt+511>>9)}}for(var Ut=xe.FullPaths.length+3>>2,ui=le+7>>3,ci=le+127>>7,Ui=ui+_e+Ut+ci,Bn=Ui+127>>7,Ha=Bn<=109?0:Math.ceil((Bn-109)/127);Ui+Bn+Ha+127>>7>Bn;)Ha=++Bn<=109?0:Math.ceil((Bn-109)/127);var yn=[1,Ha,Bn,ci,Ut,_e,le,0];return xe.FileIndex[0].size=le<<6,yn[7]=(xe.FileIndex[0].start=yn[0]+yn[1]+yn[2]+yn[3]+yn[4]+yn[5])+(yn[6]+7>>3),yn}(C),b=Z(O[7]<<9),U=0,q=0;{for(U=0;U<8;++U)b.write_shift(1,Ie[U]);for(U=0;U<8;++U)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),U=0;U<3;++U)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,O[2]),b.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:D),b.write_shift(4,O[3]),b.write_shift(-4,O[1]?O[0]-1:D),b.write_shift(4,O[1]),U=0;U<109;++U)b.write_shift(-4,U<O[2]?O[1]+U:-1)}if(O[1])for(q=0;q<O[1];++q){for(;U<236+q*127;++U)b.write_shift(-4,U<O[2]?O[1]+U:-1);b.write_shift(-4,q===O[1]-1?D:q+1)}var ee=function(xe){for(q+=xe;U<q-1;++U)b.write_shift(-4,U+1);xe&&(++U,b.write_shift(-4,D))};for(q=U=0,q+=O[1];U<q;++U)b.write_shift(-4,Ke.DIFSECT);for(q+=O[2];U<q;++U)b.write_shift(-4,Ke.FATSECT);ee(O[3]),ee(O[4]);for(var K=0,X=0,Y=C.FileIndex[0];K<C.FileIndex.length;++K)Y=C.FileIndex[K],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=q,ee(X+511>>9)));for(ee(O[6]+7>>3);b.l&511;)b.write_shift(-4,Ke.ENDOFCHAIN);for(q=U=0,K=0;K<C.FileIndex.length;++K)Y=C.FileIndex[K],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=q,ee(X+63>>6)));for(;b.l&511;)b.write_shift(-4,Ke.ENDOFCHAIN);for(U=0;U<O[4]<<2;++U){var oe=C.FullPaths[U];if(!oe||oe.length===0){for(K=0;K<17;++K)b.write_shift(4,0);for(K=0;K<3;++K)b.write_shift(4,-1);for(K=0;K<12;++K)b.write_shift(4,0);continue}Y=C.FileIndex[U],U===0&&(Y.start=Y.size?Y.start-1:D);var me=U===0&&P.root||Y.name;if(X=2*(me.length+1),b.write_shift(64,me,"utf16le"),b.write_shift(2,X),b.write_shift(1,Y.type),b.write_shift(1,Y.color),b.write_shift(-4,Y.L),b.write_shift(-4,Y.R),b.write_shift(-4,Y.C),Y.clsid)b.write_shift(16,Y.clsid,"hex");else for(K=0;K<4;++K)b.write_shift(4,0);b.write_shift(4,Y.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,Y.start),b.write_shift(4,Y.size),b.write_shift(4,0)}for(U=1;U<C.FileIndex.length;++U)if(Y=C.FileIndex[U],Y.size>=4096)if(b.l=Y.start+1<<9,qe&&Buffer.isBuffer(Y.content))Y.content.copy(b,b.l,0,Y.size),b.l+=Y.size+511&-512;else{for(K=0;K<Y.size;++K)b.write_shift(1,Y.content[K]);for(;K&511;++K)b.write_shift(1,0)}for(U=1;U<C.FileIndex.length;++U)if(Y=C.FileIndex[U],Y.size>0&&Y.size<4096)if(qe&&Buffer.isBuffer(Y.content))Y.content.copy(b,b.l,0,Y.size),b.l+=Y.size+63&-64;else{for(K=0;K<Y.size;++K)b.write_shift(1,Y.content[K]);for(;K&63;++K)b.write_shift(1,0)}if(qe)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function N(C,F){var P=C.FullPaths.map(function(K){return K.toUpperCase()}),O=P.map(function(K){var X=K.split("/");return X[X.length-(K.slice(-1)=="/"?2:1)]}),b=!1;F.charCodeAt(0)===47?(b=!0,F=P[0].slice(0,-1)+F):b=F.indexOf("/")!==-1;var U=F.toUpperCase(),q=b===!0?P.indexOf(U):O.indexOf(U);if(q!==-1)return C.FileIndex[q];var ee=!U.match(ef);for(U=U.replace(ru,""),ee&&(U=U.replace(ef,"!")),q=0;q<P.length;++q)if((ee?P[q].replace(ef,"!"):P[q]).replace(ru,"")==U||(ee?O[q].replace(ef,"!"):O[q]).replace(ru,"")==U)return C.FileIndex[q];return null}var M=64,D=-2,Re="d0cf11e0a1b11ae1",Ie=[208,207,17,224,161,177,26,225],nt="00000000000000000000000000000000",Ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:nt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(C,F,P){u();var O=R(C,P);l.writeFileSync(F,O)}function J(C){for(var F=new Array(C.length),P=0;P<C.length;++P)F[P]=String.fromCharCode(C[P]);return F.join("")}function te(C,F){var P=R(C,F);switch(F&&F.type||"buffer"){case"file":return u(),l.writeFileSync(F.filename,P),P;case"binary":return typeof P=="string"?P:J(P);case"base64":return Mu(typeof P=="string"?P:J(P));case"buffer":if(qe)return Buffer.isBuffer(P)?P:Li(P);case"array":return typeof P=="string"?Rn(P):P}return P}var ce;function V(C){try{var F=C.InflateRaw,P=new F;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)ce=C;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function z(C,F){if(!ce)return Bs(C,F);var P=ce.InflateRaw,O=new P,b=O._processChunk(C.slice(C.l),O._finishFlushFlag);return C.l+=O.bytesRead,b}function B(C){return ce?ce.deflateRawSync(C):pc(C)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(C){var F=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(F>>16|F>>8|F)&255}for(var Te=typeof Uint8Array<"u",ve=Te?new Uint8Array(256):[],$e=0;$e<256;++$e)ve[$e]=Ae($e);function ue(C,F){var P=ve[C&255];return F<=8?P>>>8-F:(P=P<<8|ve[C>>8&255],F<=16?P>>>16-F:(P=P<<8|ve[C>>16&255],P>>>24-F))}function it(C,F){var P=F&7,O=F>>>3;return(C[O]|(P<=6?0:C[O+1]<<8))>>>P&3}function Ve(C,F){var P=F&7,O=F>>>3;return(C[O]|(P<=5?0:C[O+1]<<8))>>>P&7}function Nt(C,F){var P=F&7,O=F>>>3;return(C[O]|(P<=4?0:C[O+1]<<8))>>>P&15}function Ye(C,F){var P=F&7,O=F>>>3;return(C[O]|(P<=3?0:C[O+1]<<8))>>>P&31}function se(C,F){var P=F&7,O=F>>>3;return(C[O]|(P<=1?0:C[O+1]<<8))>>>P&127}function $t(C,F,P){var O=F&7,b=F>>>3,U=(1<<P)-1,q=C[b]>>>O;return P<8-O||(q|=C[b+1]<<8-O,P<16-O)||(q|=C[b+2]<<16-O,P<24-O)||(q|=C[b+3]<<24-O),q&U}function De(C,F,P){var O=F&7,b=F>>>3;return O<=5?C[b]|=(P&7)<<O:(C[b]|=P<<O&255,C[b+1]=(P&7)>>8-O),F+3}function at(C,F,P){var O=F&7,b=F>>>3;return P=(P&1)<<O,C[b]|=P,F+1}function vn(C,F,P){var O=F&7,b=F>>>3;return P<<=O,C[b]|=P&255,P>>>=8,C[b+1]=P,F+8}function dc(C,F,P){var O=F&7,b=F>>>3;return P<<=O,C[b]|=P&255,P>>>=8,C[b+1]=P&255,C[b+2]=P>>>8,F+16}function Ma(C,F){var P=C.length,O=2*P>F?2*P:F+5,b=0;if(P>=F)return C;if(qe){var U=ox(O);if(C.copy)C.copy(U);else for(;b<C.length;++b)U[b]=C[b];return U}else if(Te){var q=new Uint8Array(O);if(q.set)q.set(C);else for(;b<P;++b)q[b]=C[b];return q}return C.length=O,C}function rn(C){for(var F=new Array(C),P=0;P<C;++P)F[P]=0;return F}function Un(C,F,P){var O=1,b=0,U=0,q=0,ee=0,K=C.length,X=Te?new Uint16Array(32):rn(32);for(U=0;U<32;++U)X[U]=0;for(U=K;U<P;++U)C[U]=0;K=C.length;var Y=Te?new Uint16Array(K):rn(K);for(U=0;U<K;++U)X[b=C[U]]++,O<b&&(O=b),Y[U]=0;for(X[0]=0,U=1;U<=O;++U)X[U+16]=ee=ee+X[U-1]<<1;for(U=0;U<K;++U)ee=C[U],ee!=0&&(Y[U]=X[ee+16]++);var oe=0;for(U=0;U<K;++U)if(oe=C[U],oe!=0)for(ee=ue(Y[U],O)>>O-oe,q=(1<<O+4-oe)-1;q>=0;--q)F[ee|q<<oe]=oe&15|U<<4;return O}var Va=Te?new Uint16Array(512):rn(512),Ua=Te?new Uint16Array(32):rn(32);if(!Te){for(var _n=0;_n<512;++_n)Va[_n]=0;for(_n=0;_n<32;++_n)Ua[_n]=0}(function(){for(var C=[],F=0;F<32;F++)C.push(5);Un(C,Ua,32);var P=[];for(F=0;F<=143;F++)P.push(8);for(;F<=255;F++)P.push(9);for(;F<=279;F++)P.push(7);for(;F<=287;F++)P.push(8);Un(P,Va,288)})();var Fd=function(){for(var F=Te?new Uint8Array(32768):[],P=0,O=0;P<ye.length-1;++P)for(;O<ye[P+1];++O)F[O]=P;for(;O<32768;++O)F[O]=29;var b=Te?new Uint8Array(259):[];for(P=0,O=0;P<re.length-1;++P)for(;O<re[P+1];++O)b[O]=P;function U(ee,K){for(var X=0;X<ee.length;){var Y=Math.min(65535,ee.length-X),oe=X+Y==ee.length;for(K.write_shift(1,+oe),K.write_shift(2,Y),K.write_shift(2,~Y&65535);Y-- >0;)K[K.l++]=ee[X++]}return K.l}function q(ee,K){for(var X=0,Y=0,oe=Te?new Uint16Array(32768):[];Y<ee.length;){var me=Math.min(65535,ee.length-Y);if(me<10){for(X=De(K,X,+(Y+me==ee.length)),X&7&&(X+=8-(X&7)),K.l=X/8|0,K.write_shift(2,me),K.write_shift(2,~me&65535);me-- >0;)K[K.l++]=ee[Y++];X=K.l*8;continue}X=De(K,X,+(Y+me==ee.length)+2);for(var xe=0;me-- >0;){var le=ee[Y];xe=(xe<<5^le)&32767;var _e=-1,Oe=0;if((_e=oe[xe])&&(_e|=Y&-32768,_e>Y&&(_e-=32768),_e<Y))for(;ee[_e+Oe]==ee[Y+Oe]&&Oe<250;)++Oe;if(Oe>2){le=b[Oe],le<=22?X=vn(K,X,ve[le+1]>>1)-1:(vn(K,X,3),X+=5,vn(K,X,ve[le-23]>>5),X+=3);var ot=le<8?0:le-4>>2;ot>0&&(dc(K,X,Oe-re[le]),X+=ot),le=F[Y-_e],X=vn(K,X,ve[le]>>3),X-=3;var lt=le<4?0:le-2>>1;lt>0&&(dc(K,X,Y-_e-ye[le]),X+=lt);for(var Ut=0;Ut<Oe;++Ut)oe[xe]=Y&32767,xe=(xe<<5^ee[Y])&32767,++Y;me-=Oe-1}else le<=143?le=le+48:X=at(K,X,1),X=vn(K,X,ve[le]),oe[xe]=Y&32767,++Y}X=vn(K,X,0)-1}return K.l=(X+7)/8|0,K.l}return function(K,X){return K.length<8?U(K,X):q(K,X)}}();function pc(C){var F=Z(50+Math.floor(C.length*1.1)),P=Fd(C,F);return F.slice(0,P)}var ol=Te?new Uint16Array(32768):rn(32768),ll=Te?new Uint16Array(32768):rn(32768),bi=Te?new Uint16Array(128):rn(128),Ba=1,ja=1;function li(C,F){var P=Ye(C,F)+257;F+=5;var O=Ye(C,F)+1;F+=5;var b=Nt(C,F)+4;F+=4;for(var U=0,q=Te?new Uint8Array(19):rn(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,X=Te?new Uint8Array(8):rn(8),Y=Te?new Uint8Array(8):rn(8),oe=q.length,me=0;me<b;++me)q[j[me]]=U=Ve(C,F),K<U&&(K=U),X[U]++,F+=3;var xe=0;for(X[0]=0,me=1;me<=K;++me)Y[me]=xe=xe+X[me-1]<<1;for(me=0;me<oe;++me)(xe=q[me])!=0&&(ee[me]=Y[xe]++);var le=0;for(me=0;me<oe;++me)if(le=q[me],le!=0){xe=ve[ee[me]]>>8-le;for(var _e=(1<<7-le)-1;_e>=0;--_e)bi[xe|_e<<le]=le&7|me<<3}var Oe=[];for(K=1;Oe.length<P+O;)switch(xe=bi[se(C,F)],F+=xe&7,xe>>>=3){case 16:for(U=3+it(C,F),F+=2,xe=Oe[Oe.length-1];U-- >0;)Oe.push(xe);break;case 17:for(U=3+Ve(C,F),F+=3;U-- >0;)Oe.push(0);break;case 18:for(U=11+se(C,F),F+=7;U-- >0;)Oe.push(0);break;default:Oe.push(xe),K<xe&&(K=xe);break}var ot=Oe.slice(0,P),lt=Oe.slice(P);for(me=P;me<286;++me)ot[me]=0;for(me=O;me<30;++me)lt[me]=0;return Ba=Un(ot,ol,286),ja=Un(lt,ll,30),F}function mc(C,F){if(C[0]==3&&!(C[1]&3))return[wa(F),2];for(var P=0,O=0,b=ox(F||1<<18),U=0,q=b.length>>>0,ee=0,K=0;!(O&1);){if(O=Ve(C,P),P+=3,O>>>1)O>>1==1?(ee=9,K=5):(P=li(C,P),ee=Ba,K=ja);else{P&7&&(P+=8-(P&7));var X=C[P>>>3]|C[(P>>>3)+1]<<8;if(P+=32,X>0)for(!F&&q<U+X&&(b=Ma(b,U+X),q=b.length);X-- >0;)b[U++]=C[P>>>3],P+=8;continue}for(;;){!F&&q<U+32767&&(b=Ma(b,U+32767),q=b.length);var Y=$t(C,P,ee),oe=O>>>1==1?Va[Y]:ol[Y];if(P+=oe&15,oe>>>=4,!(oe>>>8&255))b[U++]=oe;else{if(oe==256)break;oe-=257;var me=oe<8?0:oe-4>>2;me>5&&(me=0);var xe=U+re[oe];me>0&&(xe+=$t(C,P,me),P+=me),Y=$t(C,P,K),oe=O>>>1==1?Ua[Y]:ll[Y],P+=oe&15,oe>>>=4;var le=oe<4?0:oe-2>>1,_e=ye[oe];for(le>0&&(_e+=$t(C,P,le),P+=le),!F&&q<xe&&(b=Ma(b,xe+100),q=b.length);U<xe;)b[U]=b[U-_e],++U}}}return F?[b,P+7>>>3]:[b.slice(0,U),P+7>>>3]}function Bs(C,F){var P=C.slice(C.l||0),O=mc(P,F);return C.l+=O[1],O[0]}function ul(C,F){if(C)typeof console<"u"&&console.error(F);else throw new Error(F)}function Mi(C,F){var P=C;$r(P,0);var O=[],b=[],U={FileIndex:O,FullPaths:b};E(U,{root:F.root});for(var q=P.length-4;(P[q]!=80||P[q+1]!=75||P[q+2]!=5||P[q+3]!=6)&&q>=0;)--q;P.l=q+4,P.l+=4;var ee=P.read_shift(2);P.l+=6;var K=P.read_shift(4);for(P.l=K,q=0;q<ee;++q){P.l+=20;var X=P.read_shift(4),Y=P.read_shift(4),oe=P.read_shift(2),me=P.read_shift(2),xe=P.read_shift(2);P.l+=8;var le=P.read_shift(4),_e=o(P.slice(P.l+oe,P.l+oe+me));P.l+=oe+me+xe;var Oe=P.l;P.l=le+4,gc(P,X,Y,U,_e),P.l=Oe}return U}function gc(C,F,P,O,b){C.l+=2;var U=C.read_shift(2),q=C.read_shift(2),ee=a(C);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var K=C.read_shift(4),X=C.read_shift(4),Y=C.read_shift(4),oe=C.read_shift(2),me=C.read_shift(2),xe="",le=0;le<oe;++le)xe+=String.fromCharCode(C[C.l++]);if(me){var _e=o(C.slice(C.l,C.l+me));(_e[21589]||{}).mt&&(ee=_e[21589].mt),((b||{})[21589]||{}).mt&&(ee=b[21589].mt)}C.l+=me;var Oe=C.slice(C.l,C.l+X);switch(q){case 8:Oe=z(C,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var ot=!1;U&8&&(K=C.read_shift(4),K==134695760&&(K=C.read_shift(4),ot=!0),X=C.read_shift(4),Y=C.read_shift(4)),X!=F&&ul(ot,"Bad compressed size: "+F+" != "+X),Y!=P&&ul(ot,"Bad uncompressed size: "+P+" != "+Y),Wa(O,xe,Oe,{unsafe:!0,mt:ee})}function Zt(C,F){var P=F||{},O=[],b=[],U=Z(1),q=P.compression?8:0,ee=0,K=0,X=0,Y=0,oe=0,me=C.FullPaths[0],xe=me,le=C.FileIndex[0],_e=[],Oe=0;for(K=1;K<C.FullPaths.length;++K)if(xe=C.FullPaths[K].slice(me.length),le=C.FileIndex[K],!(!le.size||!le.content||xe=="Sh33tJ5")){var ot=Y,lt=Z(xe.length);for(X=0;X<xe.length;++X)lt.write_shift(1,xe.charCodeAt(X)&127);lt=lt.slice(0,lt.l),_e[oe]=S5.buf(le.content,0);var Ut=le.content;q==8&&(Ut=B(Ut)),U=Z(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ee),U.write_shift(2,q),le.mt?s(U,le.mt):U.write_shift(4,0),U.write_shift(-4,_e[oe]),U.write_shift(4,Ut.length),U.write_shift(4,le.content.length),U.write_shift(2,lt.length),U.write_shift(2,0),Y+=U.length,O.push(U),Y+=lt.length,O.push(lt),Y+=Ut.length,O.push(Ut),U=Z(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ee),U.write_shift(2,q),U.write_shift(4,0),U.write_shift(-4,_e[oe]),U.write_shift(4,Ut.length),U.write_shift(4,le.content.length),U.write_shift(2,lt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,ot),Oe+=U.l,b.push(U),Oe+=lt.length,b.push(lt),++oe}return U=Z(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,oe),U.write_shift(2,oe),U.write_shift(4,Oe),U.write_shift(4,Y),U.write_shift(2,0),sr([sr(O),sr(b),U])}var js={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zs(C,F){if(C.ctype)return C.ctype;var P=C.name||"",O=P.match(/\.([^\.]+)$/);return O&&js[O[1]]||F&&(O=(P=F).match(/[\.\\]([^\.\\])+$/),O&&js[O[1]])?js[O[1]]:"application/octet-stream"}function Ws(C){for(var F=Mu(C),P=[],O=0;O<F.length;O+=76)P.push(F.slice(O,O+76));return P.join(`\r
`)+`\r
`}function Ld(C){var F=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],O=F.split(`\r
`),b=0;b<O.length;++b){var U=O[b];if(U.length==0){P.push("");continue}for(var q=0;q<U.length;){var ee=76,K=U.slice(q,q+ee);K.charAt(ee-1)=="="?ee--:K.charAt(ee-2)=="="?ee-=2:K.charAt(ee-3)=="="&&(ee-=3),K=U.slice(q,q+ee),q+=ee,q<U.length&&(K+="="),P.push(K)}}return P.join(`\r
`)}function bd(C){for(var F=[],P=0;P<C.length;++P){for(var O=C[P];P<=C.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+C[++P];F.push(O)}for(var b=0;b<F.length;++b)F[b]=F[b].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Rn(F.join(`\r
`))}function Vi(C,F,P){for(var O="",b="",U="",q,ee=0;ee<10;++ee){var K=F[ee];if(!K||K.match(/^\s*$/))break;var X=K.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":O=X[2].trim();break;case"content-type":U=X[2].trim();break;case"content-transfer-encoding":b=X[2].trim();break}}switch(++ee,b.toLowerCase()){case"base64":q=Rn(Ni(F.slice(ee).join("")));break;case"quoted-printable":q=bd(F.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var Y=Wa(C,O.slice(P.length),q,{unsafe:!0});U&&(Y.ctype=U)}function Md(C,F){if(J(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=F&&F.root||"",O=(qe&&Buffer.isBuffer(C)?C.toString("binary"):J(C)).split(`\r
`),b=0,U="";for(b=0;b<O.length;++b)if(U=O[b],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),P||(P=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),U.slice(0,P.length)!=P););var q=(O[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var ee="--"+(q[1]||""),K=[],X=[],Y={FileIndex:K,FullPaths:X};E(Y);var oe,me=0;for(b=0;b<O.length;++b){var xe=O[b];xe!==ee&&xe!==ee+"--"||(me++&&Vi(Y,O.slice(oe,b),P),oe=b)}return Y}function Vd(C,F){var P=F||{},O=P.boundary||"SheetJS";O="------="+O;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],U=C.FullPaths[0],q=U,ee=C.FileIndex[0],K=1;K<C.FullPaths.length;++K)if(q=C.FullPaths[K].slice(U.length),ee=C.FileIndex[K],!(!ee.size||!ee.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var X=ee.content,Y=qe&&Buffer.isBuffer(X)?X.toString("binary"):J(X),oe=0,me=Math.min(1024,Y.length),xe=0,le=0;le<=me;++le)(xe=Y.charCodeAt(le))>=32&&xe<128&&++oe;var _e=oe>=me*4/5;b.push(O),b.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+q),b.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),b.push("Content-Type: "+zs(ee,q)),b.push(""),b.push(_e?Ld(Y):Ws(Y))}return b.push(O+`--\r
`),b.join(`\r
`)}function za(C){var F={};return E(F,C),F}function Wa(C,F,P,O){var b=O&&O.unsafe;b||E(C);var U=!b&&rt.find(C,F);if(!U){var q=C.FullPaths[0];F.slice(0,q.length)==q?q=F:(q.slice(-1)!="/"&&(q+="/"),q=(q+F).replace("//","/")),U={name:i(F),type:2},C.FileIndex.push(U),C.FullPaths.push(q),b||rt.utils.cfb_gc(C)}return U.content=P,U.size=P?P.length:0,O&&(O.CLSID&&(U.clsid=O.CLSID),O.mt&&(U.mt=O.mt),O.ct&&(U.ct=O.ct)),U}function vc(C,F){E(C);var P=rt.find(C,F);if(P){for(var O=0;O<C.FileIndex.length;++O)if(C.FileIndex[O]==P)return C.FileIndex.splice(O,1),C.FullPaths.splice(O,1),!0}return!1}function cl(C,F,P){E(C);var O=rt.find(C,F);if(O){for(var b=0;b<C.FileIndex.length;++b)if(C.FileIndex[b]==O)return C.FileIndex[b].name=i(P),C.FullPaths[b]=P,!0}return!1}function Hs(C){S(C,!0)}return e.find=N,e.read=G,e.parse=f,e.write=te,e.writeFile=he,e.utils={cfb_new:za,cfb_add:Wa,cfb_del:vc,cfb_mov:cl,cfb_gc:Hs,ReadShift:iu,CheckField:UA,prep_blob:$r,bconcat:sr,use_zlib:V,_deflateRaw:pc,_inflateRaw:Bs,consts:Ke},e}();function A5(t){return typeof t=="string"?Id(t):Array.isArray(t)?QL(t):t}function lc(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Id(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Uu(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([A5(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=oc(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function fr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function mx(t,e){for(var r=[],n=fr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function m1(t){for(var e=[],r=fr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function kd(t){for(var e=[],r=fr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function I5(t){for(var e=[],r=fr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Rh=new Date(1899,11,30,0,0,0);function Br(t,e){var r=t.getTime(),n=Rh.getTime()+(t.getTimezoneOffset()-Rh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var EA=new Date,C5=Rh.getTime()+(EA.getTimezoneOffset()-Rh.getTimezoneOffset())*6e4,gx=EA.getTimezoneOffset();function TA(t){var e=new Date;return e.setTime(t*24*60*60*1e3+C5),e.getTimezoneOffset()!==gx&&e.setTime(e.getTime()+(e.getTimezoneOffset()-gx)*6e4),e}var vx=new Date("2017-02-19T19:06:09.000Z"),SA=isNaN(vx.getFullYear())?new Date("2/19/17"):vx,R5=SA.getFullYear()==2017;function Cr(t,e){var r=new Date(t);if(R5)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(SA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Pd(t,e){if(qe&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function jr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=jr(t[r]));return e}function St(t,e){for(var r="";r.length<e;)r+=t;return r}function wi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var k5=["january","february","march","april","may","june","july","august","september","october","november","december"];function Vu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&k5.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Me(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return qe?n=Li(r):n=JL(r),rt.utils.cfb_add(t,e,n)}rt.utils.cfb_add(t,e,r)}else t.file(e,r)}function g1(){return rt.utils.cfb_new()}var Vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,P5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},v1=m1(P5),_1=/[&<>'"]/g,N5=/[\u0000-\u0008\u000b-\u001f]/g;function Ze(t){var e=t+"";return e.replace(_1,function(r){return v1[r]}).replace(N5,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function _x(t){return Ze(t).replace(/ /g,"_x0020_")}var AA=/[\u0000-\u001f]/g;function D5(t){var e=t+"";return e.replace(_1,function(r){return v1[r]}).replace(/\n/g,"<br/>").replace(AA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function O5(t){var e=t+"";return e.replace(_1,function(r){return v1[r]}).replace(AA,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function F5(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function L5(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function M0(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function yx(t){var e=wa(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function xx(t){return Li(t,"binary").toString("utf8")}var rf="foo bar baz",nu=qe&&(xx(rf)==M0(rf)&&xx||yx(rf)==M0(rf)&&yx)||M0,Uu=qe?function(t){return Li(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},b5=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),IA=/(^\s|\s$|\n)/;function ar(t,e){return"<"+t+(e.match(IA)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Bu(t){return fr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function de(t,e,r){return"<"+t+(r!=null?Bu(r):"")+(e!=null?(e.match(IA)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function gm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function M5(t,e){switch(typeof t){case"string":var r=de("vt:lpwstr",Ze(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return de((t|0)==t?"vt:i4":"vt:r8",Ze(String(t)));case"boolean":return de("vt:bool",t?"true":"false")}if(t instanceof Date)return de("vt:filetime",gm(t));throw new Error("Unable to serialize "+t)}var Xt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},nl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Gr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function V5(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function U5(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var wx=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Ex=qe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Li(e)})):wx(t)}:wx,Tx=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Bl(t,i)));return n.join("").replace(ru,"")},y1=qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ru,""):Tx(t,e,r)}:Tx,Sx=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},CA=qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Sx(t,e,r)}:Sx,Ax=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(no(t,i)));return n.join("")},uc=qe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Ax(e,r,n)}:Ax,RA=function(t,e){var r=Kr(t,e);return r>0?uc(t,e+4,e+4+r-1):""},kA=RA,PA=function(t,e){var r=Kr(t,e);return r>0?uc(t,e+4,e+4+r-1):""},NA=PA,DA=function(t,e){var r=2*Kr(t,e);return r>0?uc(t,e+4,e+4+r-1):""},OA=DA,FA=function(e,r){var n=Kr(e,r);return n>0?y1(e,r+4,r+4+n):""},LA=FA,bA=function(t,e){var r=Kr(t,e);return r>0?uc(t,e+4,e+4+r):""},MA=bA,VA=function(t,e){return V5(t,e)},kh=VA,x1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};qe&&(kA=function(e,r){if(!Buffer.isBuffer(e))return RA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},NA=function(e,r){if(!Buffer.isBuffer(e))return PA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},OA=function(e,r){if(!Buffer.isBuffer(e))return DA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},LA=function(e,r){if(!Buffer.isBuffer(e))return FA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},MA=function(e,r){if(!Buffer.isBuffer(e))return bA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},kh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):VA(e,r)},x1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var no=function(t,e){return t[e]},Bl=function(t,e){return t[e+1]*256+t[e]},B5=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Kr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Js=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},j5=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function iu(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Bl(this,u)),u+=2;t*=2;break;case"utf8":r=uc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=y1(this,this.l,this.l+t);break;case"wstr":return iu.call(this,t,"dbcs");case"lpstr-ansi":r=kA(this,this.l),t=4+Kr(this,this.l);break;case"lpstr-cp":r=NA(this,this.l),t=4+Kr(this,this.l);break;case"lpwstr":r=OA(this,this.l),t=4+2*Kr(this,this.l);break;case"lpp4":t=4+Kr(this,this.l),r=LA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Kr(this,this.l),r=MA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=no(this,this.l+t++))!==0;)s.push(Zc(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Bl(this,this.l+t))!==0;)s.push(Zc(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=no(this,u),this.l=u+1,o=iu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Zc(Bl(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=no(this,u),this.l=u+1,o=iu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Zc(no(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=no(this,this.l),this.l++,n;case 2:return n=(e==="i"?B5:Bl)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Js:j5)(this,this.l),this.l+=4,n):(i=Kr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=kh(this,this.l):i=kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=CA(this,this.l,t);break}}return this.l+=t,r}var z5=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},W5=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},H5=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function $5(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)H5(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,z5(this,e,this.l);break;case 8:if(n=8,r==="f"){U5(this,e,this.l);break}case 16:break;case-4:n=4,W5(this,e,this.l);break}return this.l+=n,this}function UA(t,e){var r=CA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function $r(t,e){t.l=e,t.read_shift=iu,t.chk=UA,t.write_shift=$5}function ai(t,e){t.l+=e}function Z(t){var e=wa(t);return $r(e,0),e}function Ur(){var t=[],e=qe?256:2048,r=function(u){var f=Z(u);return $r(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),sr(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ae(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=V7[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&x1(r)&&t.push(r)}}function su(t,e,r){var n=jr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ix(t,e,r){var n=jr(t);return n.s=su(n.s,e.s,r),n.e=su(n.e,e.s,r),n}function au(t,e){if(t.cRel&&t.c<0)for(t=jr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=jr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=tt(t);return!t.cRel&&t.cRel!=null&&(r=q5(r)),!t.rRel&&t.rRel!=null&&(r=G5(r)),r}function V0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_r(t.s.c)+":"+(t.e.cRel?"":"$")+_r(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+lr(t.s.r)+":"+(t.e.rRel?"":"$")+lr(t.e.r):au(t.s,e.biff)+":"+au(t.e,e.biff)}function w1(t){return parseInt(K5(t),10)-1}function lr(t){return""+(t+1)}function G5(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K5(t){return t.replace(/\$(\d+)$/,"$1")}function E1(t){for(var e=X5(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function _r(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function q5(t){return t.replace(/^([A-Z])/,"$$$1")}function X5(t){return t.replace(/^\$([A-Z])/,"$1")}function Y5(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Yt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function tt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Zr(t){var e=t.indexOf(":");return e==-1?{s:Yt(t),e:Yt(t)}:{s:Yt(t.slice(0,e)),e:Yt(t.slice(e+1))}}function Mt(t,e){return typeof e>"u"||typeof e=="number"?Mt(t.s,t.e):(typeof t!="string"&&(t=tt(t)),typeof e!="string"&&(e=tt(e)),t==e?t:t+":"+e)}function mt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Cx(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Rs(t.z,r?Br(e):e)}catch{}try{return t.w=Rs((t.XF||{}).numFmtId||(r?14:0),r?Br(e):e)}catch{return""+e}}function Di(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?cc[t.v]||t.v:e==null?Cx(t,t.v):Cx(t,e))}function Da(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function BA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Yt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=mt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},y=a+h,g=o+d;if(u.s.r>y&&(u.s.r=y),u.s.c>g&&(u.s.c=g),u.e.r<y&&(u.e.r=y),u.e.c<g&&(u.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||At[14],n.cellDates?(m.t="d",m.w=Rs(m.z,Br(m.v))):(m.t="n",m.v=Br(m.v),m.w=Rs(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][g]&&s[y][g].z&&(m.z=s[y][g].z),s[y][g]=m;else{var A=tt({c:g,r:y});s[A]&&s[A].z&&(m.z=s[A].z),s[A]=m}}}return u.s.c<1e7&&(s["!ref"]=Mt(u)),s}function il(t,e){return BA(null,t,e)}function Q5(t){return t.read_shift(4,"i")}function Ln(t,e){return e||(e=Z(4)),e.write_shift(4,t),e}function yr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Qt(t,e){var r=!1;return e==null&&(r=!0,e=Z(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function J5(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Z5(t,e){return e||(e=Z(4)),e.write_shift(2,0),e.write_shift(2,0),e}function T1(t,e){var r=t.l,n=t.read_shift(1),i=yr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(J5(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function e8(t,e){var r=!1;return e==null&&(r=!0,e=Z(15+4*t.t.length)),e.write_shift(1,0),Qt(t.t,e),r?e.slice(0,e.l):e}var t8=T1;function r8(t,e){var r=!1;return e==null&&(r=!0,e=Z(23+4*t.t.length)),e.write_shift(1,1),Qt(t.t,e),e.write_shift(4,1),Z5({},e),r?e.slice(0,e.l):e}function gn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Oa(t,e){return e==null&&(e=Z(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Fa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function La(t,e){return e==null&&(e=Z(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var n8=yr,jA=Qt;function S1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Ph(t,e){var r=!1;return e==null&&(r=!0,e=Z(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var i8=yr,vm=S1,A1=Ph;function zA(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?kh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Js(e,0)>>2;return r?i/100:i}function WA(t,e){e==null&&(e=Z(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function HA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function s8(t,e){return e||(e=Z(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ba=HA,sl=s8;function al(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ea(t,e){return(e||Z(8)).write_shift(8,t,"f")}function a8(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=m8[i];u&&(e.rgb=Vx(u));break;case 2:e.rgb=Vx([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Nh(t,e){if(e||(e=Z(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function o8(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function l8(t,e){e||(e=Z(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var $A=2,Wr=3,nf=11,Dh=19,sf=64,u8=65,c8=71,f8=4108,h8=4126,rr=80,Rx={1:{n:"CodePage",t:$A},2:{n:"Category",t:rr},3:{n:"PresentationFormat",t:rr},4:{n:"ByteCount",t:Wr},5:{n:"LineCount",t:Wr},6:{n:"ParagraphCount",t:Wr},7:{n:"SlideCount",t:Wr},8:{n:"NoteCount",t:Wr},9:{n:"HiddenCount",t:Wr},10:{n:"MultimediaClipCount",t:Wr},11:{n:"ScaleCrop",t:nf},12:{n:"HeadingPairs",t:f8},13:{n:"TitlesOfParts",t:h8},14:{n:"Manager",t:rr},15:{n:"Company",t:rr},16:{n:"LinksUpToDate",t:nf},17:{n:"CharacterCount",t:Wr},19:{n:"SharedDoc",t:nf},22:{n:"HyperlinksChanged",t:nf},23:{n:"AppVersion",t:Wr,p:"version"},24:{n:"DigSig",t:u8},26:{n:"ContentType",t:rr},27:{n:"ContentStatus",t:rr},28:{n:"Language",t:rr},29:{n:"Version",t:rr},255:{},2147483648:{n:"Locale",t:Dh},2147483651:{n:"Behavior",t:Dh},1919054434:{}},kx={1:{n:"CodePage",t:$A},2:{n:"Title",t:rr},3:{n:"Subject",t:rr},4:{n:"Author",t:rr},5:{n:"Keywords",t:rr},6:{n:"Comments",t:rr},7:{n:"Template",t:rr},8:{n:"LastAuthor",t:rr},9:{n:"RevNumber",t:rr},10:{n:"EditTime",t:sf},11:{n:"LastPrinted",t:sf},12:{n:"CreatedDate",t:sf},13:{n:"ModifiedDate",t:sf},14:{n:"PageCount",t:Wr},15:{n:"WordCount",t:Wr},16:{n:"CharCount",t:Wr},17:{n:"Thumbnail",t:c8},18:{n:"Application",t:rr},19:{n:"DocSecurity",t:Wr},255:{},2147483648:{n:"Locale",t:Dh},2147483651:{n:"Behavior",t:Dh},1919054434:{}};function d8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var p8=d8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),m8=jr(p8),cc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},g8={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},af={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function GA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function KA(t,e){var r=I5(g8),n=[],i;n[n.length]=Vt,n[n.length]=de("Types",null,{xmlns:Xt.CT,"xmlns:xsd":Xt.xsd,"xmlns:xsi":Xt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return de("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=de("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:af[l][e.bookType]||af[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=de("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:af[l][e.bookType]||af[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=de("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qA(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Po(t){var e=[Vt,de("Relationships",null,{xmlns:Xt.RELS})];return fr(t["!id"]).forEach(function(r){e[e.length]=de("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Je(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function v8(t){var e=[Vt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Px(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function _8(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function y8(t){var e=[Vt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Px(t[r][0],t[r][1])),e.push(_8("",t[r][0]));return e.push(Px("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function XA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Th.version+"</meta:generator></office:meta></office:document-meta>"}var ua=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function U0(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ze(e),n[n.length]=r?de(t,e,r):ar(t,e))}function YA(t,e){var r=e||{},n=[Vt,de("cp:coreProperties",null,{"xmlns:cp":Xt.CORE_PROPS,"xmlns:dc":Xt.dc,"xmlns:dcterms":Xt.dcterms,"xmlns:dcmitype":Xt.dcmitype,"xmlns:xsi":Xt.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&U0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:gm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&U0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:gm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ua.length;++s){var a=ua[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&U0(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var No=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],QA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function JA(t){var e=[],r=de;return t||(t={}),t.Application="SheetJS",e[e.length]=Vt,e[e.length]=de("Properties",null,{xmlns:Xt.EXT_PROPS,"xmlns:vt":Xt.vt}),No.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ze(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ze(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function ZA(t){var e=[Vt,de("Properties",null,{xmlns:Xt.CUST_PROPS,"xmlns:vt":Xt.vt})];if(!t)return e.join("");var r=1;return fr(t).forEach(function(i){++r,e[e.length]=de("property",M5(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ze(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Nx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function x8(t,e){var r=[];return fr(Nx).map(function(n){for(var i=0;i<ua.length;++i)if(ua[i][1]==n)return ua[i];for(i=0;i<No.length;++i)if(No[i][1]==n)return No[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(ar(Nx[n[1]]||n[1],i))}}),de("DocumentProperties",r.join(""),{xmlns:Gr.o})}function w8(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&fr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<ua.length;++a)if(s==ua[a][1])return;for(a=0;a<No.length;++a)if(s==No[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(de(_x(s),o,{"dt:dt":l}))}}),e&&fr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(de(_x(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Gr.o+'">'+i.join("")+"</"+n+">"}function E8(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Z(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Dx(t,e){var r=Z(4),n=Z(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Z(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=E8(e);break;case 31:case 80:for(n=Z(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return sr([r,n])}var eI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function T8(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Ox(t,e,r){var n=Z(8),i=[],s=[],a=8,o=0,l=Z(8),u=Z(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Z(8),u.write_shift(4,0),i.unshift(u);var f=[Z(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=Z(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=sr(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(eI.indexOf(t[o][0])>-1||QA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof d=="string"){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=Dx(y.t,d)}else{var A=T8(d);A==-1&&(A=31,d=String(d)),l=Dx(A,d)}s.push(l),u=Z(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),sr([n].concat(i).concat(s))}function Fx(t,e,r,n,i,s){var a=Z(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=Ox(t,r,n);if(o.push(l),i){var u=Ox(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return sr(o)}function S8(t,e){e||(e=Z(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function A8(t,e){return t.read_shift(e)===1}function Sr(t,e){return e||(e=Z(2)),e.write_shift(2,+!!t),e}function tI(t){return t.read_shift(2,"u")}function sn(t,e){return e||(e=Z(2)),e.write_shift(2,t),e}function rI(t,e,r){return r||(r=Z(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function nI(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function I8(t){var e=t.t||"",r=Z(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Z(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return sr(i)}function C8(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function R8(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):C8(t,n,r)}function k8(t,e,r){if(r.biff>5)return R8(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function iI(t,e,r){return r||(r=Z(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Lx(t,e){e||(e=Z(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function P8(t){var e=Z(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),Lx(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&Lx(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Ta(t,e,r,n){return n||(n=Z(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function N8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function D8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function sI(t,e){return e||(e=Z(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function I1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Z(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function O8(t,e){var r=!e||e.biff==8,n=Z(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function F8(t,e){var r=!e||e.biff>=8?2:1,n=Z(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function L8(t,e){var r=Z(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=I8(t[i]);var s=sr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function b8(){var t=Z(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function M8(t){var e=Z(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function V8(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=Z(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function U8(t,e,r,n){var i=Z(10);return Ta(t,e,n,i),i.write_shift(4,r),i}function B8(t,e,r,n,i){var s=!i||i.biff==8,a=Z(8+ +s+(1+s)*r.length);return Ta(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function j8(t,e,r,n){var i=r&&r.biff==5;n||(n=Z(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function z8(t,e){var r=e.biff==8||!e.biff?4:2,n=Z(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function bx(t,e,r,n){var i=r&&r.biff==5;n||(n=Z(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function W8(t){var e=Z(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function H8(t,e,r,n,i,s){var a=Z(8);return Ta(t,e,n,a),rI(r,s,a),a}function $8(t,e,r,n){var i=Z(14);return Ta(t,e,n,i),Ea(r,i),i}function G8(t,e,r){if(r.biff<8)return K8(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(N8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function K8(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=nI(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function q8(t){var e=Z(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)sI(t[r],e);return e}function X8(t){var e=Z(24),r=Yt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return sr([e,P8(t[1])])}function Y8(t){var e=t[1].Tooltip,r=Z(10+2*(e.length+1));r.write_shift(2,2048);var n=Yt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Q8(t){return t||(t=Z(4)),t.write_shift(2,1),t.write_shift(2,1),t}function J8(t,e,r){if(!r.cellStyles)return ai(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Z8(t,e){var r=Z(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function eb(t){for(var e=Z(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function tb(t,e,r){var n=Z(15);return hc(n,t,e),n.write_shift(8,r,"f"),n}function rb(t,e,r){var n=Z(9);return hc(n,t,e),n.write_shift(2,r),n}var nb=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=m1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=wa(1);switch(l.type){case"base64":f=Rn(Ni(o));break;case"binary":f=Rn(o);break;case"buffer":case"array":f=o;break}$r(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,A=521;h==2&&(g=f.read_shift(2)),f.l+=3,h!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(A=f.read_shift(2));var w=f.read_shift(2),x=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(x=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var I=[],L={},W=Math.min(f.length,h==2?521:A-10-(m?264:0)),G=y?32:11;f.l<W&&f[f.l]!=13;)switch(L={},L.name=Sh.utils.decode(x,f.slice(f.l,f.l+G)).replace(/[\u0000\r\n].*$/g,""),f.l+=G,L.type=String.fromCharCode(f.read_shift(1)),h!=2&&!y&&(L.offset=f.read_shift(4)),L.len=f.read_shift(1),h==2&&(L.offset=f.read_shift(2)),L.dec=f.read_shift(1),L.name.length&&I.push(L),h!=2&&(f.l+=y?13:14),L.type){case"B":(!m||L.len!=8)&&l.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(f[f.l]!==13&&(f.l=A-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=A;var E=0,T=0;for(u[0]=[],T=0;T!=I.length;++T)u[0][T]=I[T].name;for(;g-- >0;){if(f[f.l]===42){f.l+=w;continue}for(++f.l,u[++E]=[],T=0,T=0;T!=I.length;++T){var S=f.slice(f.l,f.l+I[T].len);f.l+=I[T].len,$r(S,0);var R=Sh.utils.decode(x,S);switch(I[T].type){case"C":R.trim().length&&(u[E][T]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[E][T]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[E][T]=R;break;case"F":u[E][T]=parseFloat(R.trim());break;case"+":case"I":u[E][T]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[E][T]=!0;break;case"N":case"F":u[E][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[E][T]="##MEMO##"+(y?parseInt(R.trim(),10):S.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[E][T]=+R||0);break;case"@":u[E][T]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[E][T]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[E][T]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][T]=-S.read_shift(-8,"f");break;case"B":if(m&&I[T].len==8){u[E][T]=S.read_shift(8,"f");break}case"G":case"P":S.l+=I[T].len;break;case"0":if(I[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[T].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=I,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=il(r(o,u),u);return f["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,f}function i(o,l){try{return Da(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&bu(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Ur(),h=Mh(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),y=o["!cols"]||[],g=0,A=0,w=0,x=1;for(g=0;g<d.length;++g){if(((y[g]||{}).DBF||{}).name){d[g]=y[g].DBF.name,++w;continue}if(d[g]!=null){if(++w,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(A=0;A<1024;++A)if(d.indexOf(d[g]+"_"+A)==-1){d[g]+="_"+A;break}}}}var I=mt(o["!ref"]),L=[],W=[],G=[];for(g=0;g<=I.e.c-I.s.c;++g){var E="",T="",S=0,R=[];for(A=0;A<m.length;++A)m[A][g]!=null&&R.push(m[A][g]);if(R.length==0||d[g]==null){L[g]="?";continue}for(A=0;A<R.length;++A){switch(typeof R[A]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=R[A]instanceof Date?"D":"C";break;default:T="C"}S=Math.max(S,String(R[A]).length),E=E&&E!=T?"C":T}S>250&&(S=250),T=((y[g]||{}).DBF||{}).type,T=="C"&&y[g].DBF.len>S&&(S=y[g].DBF.len),E=="B"&&T=="N"&&(E="N",G[g]=y[g].DBF.dec,S=y[g].DBF.len),W[g]=E=="C"||T=="N"?S:s[E]||0,x+=W[g],L[g]=E}var N=f.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*w),N.write_shift(2,x),g=0;g<4;++g)N.write_shift(4,0);for(N.write_shift(4,0|(+e[oA]||3)<<8),g=0,A=0;g<d.length;++g)if(d[g]!=null){var M=f.next(32),D=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,D,"sbcs"),M.write_shift(1,L[g]=="?"?"C":L[g],"sbcs"),M.write_shift(4,A),M.write_shift(1,W[g]||s[L[g]]||0),M.write_shift(1,G[g]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),A+=W[g]||s[L[g]]||0}var Re=f.next(264);for(Re.write_shift(4,13),g=0;g<65;++g)Re.write_shift(4,0);for(g=0;g<m.length;++g){var Ie=f.next(x);for(Ie.write_shift(1,0),A=0;A<d.length;++A)if(d[A]!=null)switch(L[A]){case"L":Ie.write_shift(1,m[g][A]==null?63:m[g][A]?84:70);break;case"B":Ie.write_shift(8,m[g][A]||0,"f");break;case"N":var nt="0";for(typeof m[g][A]=="number"&&(nt=m[g][A].toFixed(G[A]||0)),w=0;w<W[A]-nt.length;++w)Ie.write_shift(1,32);Ie.write_shift(1,nt,"sbcs");break;case"D":m[g][A]?(Ie.write_shift(4,("0000"+m[g][A].getFullYear()).slice(-4),"sbcs"),Ie.write_shift(2,("00"+(m[g][A].getMonth()+1)).slice(-2),"sbcs"),Ie.write_shift(2,("00"+m[g][A].getDate()).slice(-2),"sbcs")):Ie.write_shift(8,"00000000","sbcs");break;case"C":var Ke=String(m[g][A]!=null?m[g][A]:"").slice(0,W[A]);for(Ie.write_shift(1,Ke,"sbcs"),w=0;w<W[A]-Ke.length;++w)Ie.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),ib=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var y=t[m];return typeof y=="number"?ax(y):y},n=function(d,m,y){var g=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return g==59?d:ax(g)};t["|"]=254;function i(d,m){switch(m.type){case"base64":return s(Ni(d),m);case"binary":return s(d,m);case"buffer":return s(qe&&Buffer.isBuffer(d)?d.toString("binary"):oc(d),m);case"array":return s(Pd(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var y=d.split(/[\n\r]+/),g=-1,A=-1,w=0,x=0,I=[],L=[],W=null,G={},E=[],T=[],S=[],R=0,N;for(+m.codepage>=0&&bu(+m.codepage);w!==y.length;++w){R=0;var M=y[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=M.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Re=D[0],Ie;if(M.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&L.push(M.slice(3).replace(/;;/g,";"));break;case"C":var nt=!1,Ke=!1,he=!1,J=!1,te=-1,ce=-1;for(x=1;x<D.length;++x)switch(D[x].charAt(0)){case"A":break;case"X":A=parseInt(D[x].slice(1))-1,Ke=!0;break;case"Y":for(g=parseInt(D[x].slice(1))-1,Ke||(A=0),N=I.length;N<=g;++N)I[N]=[];break;case"K":Ie=D[x].slice(1),Ie.charAt(0)==='"'?Ie=Ie.slice(1,Ie.length-1):Ie==="TRUE"?Ie=!0:Ie==="FALSE"?Ie=!1:isNaN(wi(Ie))?isNaN(Vu(Ie).getDate())||(Ie=Cr(Ie)):(Ie=wi(Ie),W!==null&&yA(W)&&(Ie=TA(Ie))),nt=!0;break;case"E":J=!0;var V=rM(D[x].slice(1),{r:g,c:A});I[g][A]=[I[g][A],V];break;case"S":he=!0,I[g][A]=[I[g][A],"S5S"];break;case"G":break;case"R":te=parseInt(D[x].slice(1))-1;break;case"C":ce=parseInt(D[x].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+M)}if(nt&&(I[g][A]&&I[g][A].length==2?I[g][A][0]=Ie:I[g][A]=Ie,W=null),he){if(J)throw new Error("SYLK shared formula cannot have own formula");var z=te>-1&&I[te][ce];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");I[g][A][1]=nM(z[1],{r:g-te,c:A-ce})}break;case"F":var B=0;for(x=1;x<D.length;++x)switch(D[x].charAt(0)){case"X":A=parseInt(D[x].slice(1))-1,++B;break;case"Y":for(g=parseInt(D[x].slice(1))-1,N=I.length;N<=g;++N)I[N]=[];break;case"M":R=parseInt(D[x].slice(1))/20;break;case"F":break;case"G":break;case"P":W=L[parseInt(D[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=D[x].slice(1).split(" "),N=parseInt(S[0],10);N<=parseInt(S[1],10);++N)R=parseInt(S[2],10),T[N-1]=R===0?{hidden:!0}:{wch:R},C1(T[N-1]);break;case"C":A=parseInt(D[x].slice(1))-1,T[A]||(T[A]={});break;case"R":g=parseInt(D[x].slice(1))-1,E[g]||(E[g]={}),R>0?(E[g].hpt=R,E[g].hpx=cI(R)):R===0&&(E[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+M)}B<1&&(W=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+M)}}return E.length>0&&(G["!rows"]=E),T.length>0&&(G["!cols"]=T),m&&m.sheetRows&&(I=I.slice(0,m.sheetRows)),[I,G]}function a(d,m){var y=i(d,m),g=y[0],A=y[1],w=il(g,m);return fr(A).forEach(function(x){w[x]=A[x]}),w}function o(d,m){return Da(a(d,m),m)}function l(d,m,y,g){var A="C;Y"+(y+1)+";X"+(g+1)+";K";switch(d.t){case"n":A+=d.v||0,d.f&&!d.F&&(A+=";E"+k1(d.f,{r:y,c:g}));break;case"b":A+=d.v?"TRUE":"FALSE";break;case"e":A+=d.w||d.v;break;case"d":A+='"'+(d.w||d.v)+'"';break;case"s":A+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function u(d,m){m.forEach(function(y,g){var A="F;W"+(g+1)+" "+(g+1)+" ";y.hidden?A+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Oh(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Fh(y.wpx)),typeof y.wch=="number"&&(A+=Math.round(y.wch))),A.charAt(A.length-1)!=" "&&d.push(A)})}function f(d,m){m.forEach(function(y,g){var A="F;";y.hidden?A+="M0;":y.hpt?A+="M"+20*y.hpt+";":y.hpx&&(A+="M"+20*Lh(y.hpx)+";"),A.length>2&&d.push(A+"R"+(g+1))})}function h(d,m){var y=["ID;PWXL;N;E"],g=[],A=mt(d["!ref"]),w,x=Array.isArray(d),I=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),d["!cols"]&&u(y,d["!cols"]),d["!rows"]&&f(y,d["!rows"]),y.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var L=A.s.r;L<=A.e.r;++L)for(var W=A.s.c;W<=A.e.c;++W){var G=tt({r:L,c:W});w=x?(d[L]||[])[W]:d[G],!(!w||w.v==null&&(!w.f||w.F))&&g.push(l(w,d,L,W))}return y.join(I)+I+g.join(I)+I+"E"+I}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),sb=function(){function t(s,a){switch(a.type){case"base64":return e(Ni(s),a);case"binary":return e(s,a);case"buffer":return e(qe&&Buffer.isBuffer(s)?s.toString("binary"):oc(s),a);case"array":return e(Pd(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var d=o[f].trim().split(","),m=d[0],y=d[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][u]=!0:g==="FALSE"?h[l][u]=!1:isNaN(wi(y))?isNaN(Vu(y).getDate())?h[l][u]=y:h[l][u]=Cr(y):h[l][u]=wi(y),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return il(t(s,a),a)}function n(s,a){return Da(r(s,a),a)}var i=function(){var s=function(l,u,f,h,d){l.push(u),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,u,f,h){l.push(u+","+f),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],f=mt(l["!ref"]),h,d=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var g=tt({r:m,c:y});if(h=d?(l[m]||[])[y]:l[g],!h){a(u,1,0,"");continue}switch(h.t){case"n":var A=h.w;!A&&h.v!=null&&(A=h.v),A==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,A,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Rs(h.z||At[14],Br(Cr(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var w=`\r
`,x=u.join(w);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),aI=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),y=-1,g=-1,A=0,w=[];A!==m.length;++A){var x=m[A].trim().split(":");if(x[0]==="cell"){var I=Yt(x[1]);if(w.length<=I.r)for(y=w.length;y<=I.r;++y)w[y]||(w[y]=[]);switch(y=I.r,g=I.c,x[2]){case"t":w[y][g]=t(x[3]);break;case"v":w[y][g]=+x[3];break;case"vtf":var L=x[x.length-1];case"vtc":switch(x[3]){case"nl":w[y][g]=!!+x[4];break;default:w[y][g]=+x[4];break}x[2]=="vtf"&&(w[y][g]=[w[y][g],L])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return il(r(h,d),d)}function i(h,d){return Da(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],y,g="",A=Zr(h["!ref"]),w=Array.isArray(h),x=A.s.r;x<=A.e.r;++x)for(var I=A.s.c;I<=A.e.c;++I)if(g=tt({r:x,c:I}),y=w?(h[x]||[])[I]:h[g],!(!y||y.v==null||y.t==="z")){switch(m=["cell",g,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var L=Br(Cr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+L,m[5]=y.w||Rs(y.z||At[14],L);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),ab=function(){function t(f,h,d,m,y){y.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(wi(f))?isNaN(Vu(f).getDate())?h[d][m]=f:h[d][m]=Cr(f):h[d][m]=wi(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),g=y.length-1;g>=0&&y[g].length===0;)--g;for(var A=10,w=0,x=0;x<=g;++x)w=y[x].indexOf(" "),w==-1?w=y[x].length:w++,A=Math.max(A,w);for(x=0;x<=g;++x){m[x]=[];var I=0;for(t(y[x].slice(0,A).trim(),m,x,I,d),I=1;I<=(y[x].length-A)/10+1;++I)t(y[x].slice(A+(I-1)*10,A+I*10).trim(),m,x,I,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?d=!d:!d&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m]);if(!y.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m])}return y.sort(function(g,A){return g[0]-A[0]||n[g[1]]-n[A[1]]}),r[y.pop()[1]]||44}function s(f,h){var d=h||{},m="",y=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):d&&d.FS?m=d.FS:m=i(f.slice(0,1024));var A=0,w=0,x=0,I=0,L=0,W=m.charCodeAt(0),G=!1,E=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=d.dateNF!=null?E5(d.dateNF):null;function R(){var N=f.slice(I,L),M={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)M.t="z";else if(d.raw)M.t="s",M.v=N;else if(N.trim().length===0)M.t="s",M.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(M.t="s",M.v=N.slice(2,-1).replace(/""/g,'"')):iM(N)?(M.t="n",M.f=N.slice(1)):(M.t="s",M.v=N);else if(N=="TRUE")M.t="b",M.v=!0;else if(N=="FALSE")M.t="b",M.v=!1;else if(!isNaN(x=wi(N)))M.t="n",d.cellText!==!1&&(M.w=N),M.v=x;else if(!isNaN(Vu(N).getDate())||S&&N.match(S)){M.z=d.dateNF||At[14];var D=0;S&&N.match(S)&&(N=T5(N,d.dateNF,N.match(S)||[]),D=1),d.cellDates?(M.t="d",M.v=Cr(N,D)):(M.t="n",M.v=Br(Cr(N,D))),d.cellText!==!1&&(M.w=Rs(M.z,M.v instanceof Date?Br(M.v):M.v)),d.cellNF||delete M.z}else M.t="s",M.v=N;if(M.t=="z"||(d.dense?(y[A]||(y[A]=[]),y[A][w]=M):y[tt({c:w,r:A})]=M),I=L+1,T=f.charCodeAt(I),g.e.c<w&&(g.e.c=w),g.e.r<A&&(g.e.r=A),E==W)++w;else if(w=0,++A,d.sheetRows&&d.sheetRows<=A)return!0}e:for(;L<f.length;++L)switch(E=f.charCodeAt(L)){case 34:T===34&&(G=!G);break;case W:case 10:case 13:if(!G&&R())break e;break}return L-I>0&&R(),y["!ref"]=Mt(g),y}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):il(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:_U(f,h);switch(h.type){case"base64":d=Ni(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Sh<"u"||(d=qe&&Buffer.isBuffer(f)?f.toString("binary"):oc(f));break;case"array":d=Pd(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=nu(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=nu(d):h.type=="binary"&&typeof Sh<"u",d.slice(0,19)=="socialcalc:version:"?aI.to_sheet(h.type=="string"?d:nu(d),h):a(d,h)}function l(f,h){return Da(o(f,h),h)}function u(f){for(var h=[],d=mt(f["!ref"]),m,y=Array.isArray(f),g=d.s.r;g<=d.e.r;++g){for(var A=[],w=d.s.c;w<=d.e.c;++w){var x=tt({r:g,c:w});if(m=y?(f[g]||[])[w]:f[x],!m||m.v==null){A.push("          ");continue}for(var I=(m.w||(Di(m),m.w)||"").slice(0,10);I.length<10;)I+=" ";A.push(I+(w===0?" ":""))}h.push(A.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),Mx=function(){function t(V,z,B){if(V){$r(V,V.l||0);for(var j=B.Enum||te;V.l<V.length;){var re=V.read_shift(2),ye=j[re]||j[65535],Ae=V.read_shift(2),Te=V.l+Ae,ve=ye.f&&ye.f(V,Ae,B);if(V.l=Te,z(ve,ye,re))return}}}function e(V,z){switch(z.type){case"base64":return r(Rn(Ni(V)),z);case"binary":return r(Rn(V),z);case"buffer":case"array":return r(V,z)}throw"Unsupported type "+z.type}function r(V,z){if(!V)return V;var B=z||{},j=B.dense?[]:{},re="Sheet1",ye="",Ae=0,Te={},ve=[],$e=[],ue={s:{r:0,c:0},e:{r:0,c:0}},it=B.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)B.Enum=te,t(V,function(se,$t,De){switch(De){case 0:B.vers=se,se>=4096&&(B.qpro=!0);break;case 6:ue=se;break;case 204:se&&(ye=se);break;case 222:ye=se;break;case 15:case 51:B.qpro||(se[1].v=se[1].v.slice(1));case 13:case 14:case 16:De==14&&(se[2]&112)==112&&(se[2]&15)>1&&(se[2]&15)<15&&(se[1].z=B.dateNF||At[14],B.cellDates&&(se[1].t="d",se[1].v=TA(se[1].v))),B.qpro&&se[3]>Ae&&(j["!ref"]=Mt(ue),Te[re]=j,ve.push(re),j=B.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},Ae=se[3],re=ye||"Sheet"+(Ae+1),ye="");var at=B.dense?(j[se[0].r]||[])[se[0].c]:j[tt(se[0])];if(at){at.t=se[1].t,at.v=se[1].v,se[1].z!=null&&(at.z=se[1].z),se[1].f!=null&&(at.f=se[1].f);break}B.dense?(j[se[0].r]||(j[se[0].r]=[]),j[se[0].r][se[0].c]=se[1]):j[tt(se[0])]=se[1];break}},B);else if(V[2]==26||V[2]==14)B.Enum=ce,V[2]==14&&(B.qpro=!0,V.l=0),t(V,function(se,$t,De){switch(De){case 204:re=se;break;case 22:se[1].v=se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(se[3]>Ae&&(j["!ref"]=Mt(ue),Te[re]=j,ve.push(re),j=B.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},Ae=se[3],re="Sheet"+(Ae+1)),it>0&&se[0].r>=it)break;B.dense?(j[se[0].r]||(j[se[0].r]=[]),j[se[0].r][se[0].c]=se[1]):j[tt(se[0])]=se[1],ue.e.c<se[0].c&&(ue.e.c=se[0].c),ue.e.r<se[0].r&&(ue.e.r=se[0].r);break;case 27:se[14e3]&&($e[se[14e3][0]]=se[14e3][1]);break;case 1537:$e[se[0]]=se[1],se[0]==Ae&&(re=se[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(j["!ref"]=Mt(ue),Te[ye||re]=j,ve.push(ye||re),!$e.length)return{SheetNames:ve,Sheets:Te};for(var Ve={},Nt=[],Ye=0;Ye<$e.length;++Ye)Te[ve[Ye]]?(Nt.push($e[Ye]||ve[Ye]),Ve[$e[Ye]]=Te[$e[Ye]]||Te[ve[Ye]]):(Nt.push($e[Ye]),Ve[$e[Ye]]={"!ref":"A1"});return{SheetNames:Nt,Sheets:Ve}}function n(V,z){var B=z||{};if(+B.codepage>=0&&bu(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var j=Ur(),re=mt(V["!ref"]),ye=Array.isArray(V),Ae=[];pe(j,0,s(1030)),pe(j,6,l(re));for(var Te=Math.min(re.e.r,8191),ve=re.s.r;ve<=Te;++ve)for(var $e=lr(ve),ue=re.s.c;ue<=re.e.c;++ue){ve===re.s.r&&(Ae[ue]=_r(ue));var it=Ae[ue]+$e,Ve=ye?(V[ve]||[])[ue]:V[it];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?pe(j,13,m(ve,ue,Ve.v)):pe(j,14,g(ve,ue,Ve.v));else{var Nt=Di(Ve);pe(j,15,h(ve,ue,Nt.slice(0,239)))}}return pe(j,1),j.end()}function i(V,z){var B=z||{};if(+B.codepage>=0&&bu(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var j=Ur();pe(j,0,a(V));for(var re=0,ye=0;re<V.SheetNames.length;++re)(V.Sheets[V.SheetNames[re]]||{})["!ref"]&&pe(j,27,J(V.SheetNames[re],ye++));var Ae=0;for(re=0;re<V.SheetNames.length;++re){var Te=V.Sheets[V.SheetNames[re]];if(!(!Te||!Te["!ref"])){for(var ve=mt(Te["!ref"]),$e=Array.isArray(Te),ue=[],it=Math.min(ve.e.r,8191),Ve=ve.s.r;Ve<=it;++Ve)for(var Nt=lr(Ve),Ye=ve.s.c;Ye<=ve.e.c;++Ye){Ve===ve.s.r&&(ue[Ye]=_r(Ye));var se=ue[Ye]+Nt,$t=$e?(Te[Ve]||[])[Ye]:Te[se];if(!(!$t||$t.t=="z"))if($t.t=="n")pe(j,23,R(Ve,Ye,Ae,$t.v));else{var De=Di($t);pe(j,22,E(Ve,Ye,Ae,De.slice(0,239)))}}++Ae}}return pe(j,1),j.end()}function s(V){var z=Z(2);return z.write_shift(2,V),z}function a(V){var z=Z(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var B=0,j=0,re=0,ye=0;ye<V.SheetNames.length;++ye){var Ae=V.SheetNames[ye],Te=V.Sheets[Ae];if(!(!Te||!Te["!ref"])){++re;var ve=Zr(Te["!ref"]);B<ve.e.r&&(B=ve.e.r),j<ve.e.c&&(j=ve.e.c)}}return B>8191&&(B=8191),z.write_shift(2,B),z.write_shift(1,re),z.write_shift(1,j),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(V,z,B){var j={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&B.qpro?(j.s.c=V.read_shift(1),V.l++,j.s.r=V.read_shift(2),j.e.c=V.read_shift(1),V.l++,j.e.r=V.read_shift(2),j):(j.s.c=V.read_shift(2),j.s.r=V.read_shift(2),z==12&&B.qpro&&(V.l+=2),j.e.c=V.read_shift(2),j.e.r=V.read_shift(2),z==12&&B.qpro&&(V.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function l(V){var z=Z(8);return z.write_shift(2,V.s.c),z.write_shift(2,V.s.r),z.write_shift(2,V.e.c),z.write_shift(2,V.e.r),z}function u(V,z,B){var j=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(j[0].c=V.read_shift(1),j[3]=V.read_shift(1),j[0].r=V.read_shift(2),V.l+=2):(j[2]=V.read_shift(1),j[0].c=V.read_shift(2),j[0].r=V.read_shift(2)),j}function f(V,z,B){var j=V.l+z,re=u(V,z,B);if(re[1].t="s",B.vers==20768){V.l++;var ye=V.read_shift(1);return re[1].v=V.read_shift(ye,"utf8"),re}return B.qpro&&V.l++,re[1].v=V.read_shift(j-V.l,"cstr"),re}function h(V,z,B){var j=Z(7+B.length);j.write_shift(1,255),j.write_shift(2,z),j.write_shift(2,V),j.write_shift(1,39);for(var re=0;re<j.length;++re){var ye=B.charCodeAt(re);j.write_shift(1,ye>=128?95:ye)}return j.write_shift(1,0),j}function d(V,z,B){var j=u(V,z,B);return j[1].v=V.read_shift(2,"i"),j}function m(V,z,B){var j=Z(7);return j.write_shift(1,255),j.write_shift(2,z),j.write_shift(2,V),j.write_shift(2,B,"i"),j}function y(V,z,B){var j=u(V,z,B);return j[1].v=V.read_shift(8,"f"),j}function g(V,z,B){var j=Z(13);return j.write_shift(1,255),j.write_shift(2,z),j.write_shift(2,V),j.write_shift(8,B,"f"),j}function A(V,z,B){var j=V.l+z,re=u(V,z,B);if(re[1].v=V.read_shift(8,"f"),B.qpro)V.l=j;else{var ye=V.read_shift(2);L(V.slice(V.l,V.l+ye),re),V.l+=ye}return re}function w(V,z,B){var j=z&32768;return z&=-32769,z=(j?V:0)+(z>=8192?z-16384:z),(j?"":"$")+(B?_r(z):lr(z))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(V,z){$r(V,0);for(var B=[],j=0,re="",ye="",Ae="",Te="";V.l<V.length;){var ve=V[V.l++];switch(ve){case 0:B.push(V.read_shift(8,"f"));break;case 1:ye=w(z[0].c,V.read_shift(2),!0),re=w(z[0].r,V.read_shift(2),!1),B.push(ye+re);break;case 2:{var $e=w(z[0].c,V.read_shift(2),!0),ue=w(z[0].r,V.read_shift(2),!1);ye=w(z[0].c,V.read_shift(2),!0),re=w(z[0].r,V.read_shift(2),!1),B.push($e+ue+":"+ye+re)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(V.read_shift(2));break;case 6:{for(var it="";ve=V[V.l++];)it+=String.fromCharCode(ve);B.push('"'+it.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:Te=B.pop(),Ae=B.pop(),B.push(["AND","OR"][ve-20]+"("+Ae+","+Te+")");break;default:if(ve<32&&I[ve])Te=B.pop(),Ae=B.pop(),B.push(Ae+I[ve]+Te);else if(x[ve]){if(j=x[ve][1],j==69&&(j=V[V.l++]),j>B.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+B.join("|")+"|");return}var Ve=B.slice(-j);B.length-=j,B.push(x[ve][0]+"("+Ve.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}B.length==1?z[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function W(V){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=V.read_shift(2),z[3]=V[V.l++],z[0].c=V[V.l++],z}function G(V,z){var B=W(V);return B[1].t="s",B[1].v=V.read_shift(z-4,"cstr"),B}function E(V,z,B,j){var re=Z(6+j.length);re.write_shift(2,V),re.write_shift(1,B),re.write_shift(1,z),re.write_shift(1,39);for(var ye=0;ye<j.length;++ye){var Ae=j.charCodeAt(ye);re.write_shift(1,Ae>=128?95:Ae)}return re.write_shift(1,0),re}function T(V,z){var B=W(V);B[1].v=V.read_shift(2);var j=B[1].v>>1;if(B[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return B[1].v=j,B}function S(V,z){var B=W(V),j=V.read_shift(4),re=V.read_shift(4),ye=V.read_shift(2);if(ye==65535)return j===0&&re===3221225472?(B[1].t="e",B[1].v=15):j===0&&re===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var Ae=ye&32768;return ye=(ye&32767)-16446,B[1].v=(1-Ae*2)*(re*Math.pow(2,ye+32)+j*Math.pow(2,ye)),B}function R(V,z,B,j){var re=Z(14);if(re.write_shift(2,V),re.write_shift(1,B),re.write_shift(1,z),j==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var ye=0,Ae=0,Te=0,ve=0;return j<0&&(ye=1,j=-j),Ae=Math.log2(j)|0,j/=Math.pow(2,Ae-31),ve=j>>>0,ve&2147483648||(j/=2,++Ae,ve=j>>>0),j-=ve,ve|=2147483648,ve>>>=0,j*=Math.pow(2,32),Te=j>>>0,re.write_shift(4,Te),re.write_shift(4,ve),Ae+=16383+(ye?32768:0),re.write_shift(2,Ae),re}function N(V,z){var B=S(V);return V.l+=z-14,B}function M(V,z){var B=W(V),j=V.read_shift(4);return B[1].v=j>>6,B}function D(V,z){var B=W(V),j=V.read_shift(8,"f");return B[1].v=j,B}function Re(V,z){var B=D(V);return V.l+=z-10,B}function Ie(V,z){return V[V.l+z-1]==0?V.read_shift(z,"cstr"):""}function nt(V,z){var B=V[V.l++];B>z-1&&(B=z-1);for(var j="";j.length<B;)j+=String.fromCharCode(V[V.l++]);return j}function Ke(V,z,B){if(!(!B.qpro||z<21)){var j=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var re=V.read_shift(z-21,"cstr");return[j,re]}}function he(V,z){for(var B={},j=V.l+z;V.l<j;){var re=V.read_shift(2);if(re==14e3){for(B[re]=[0,""],B[re][0]=V.read_shift(2);V[V.l];)B[re][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return B}function J(V,z){var B=Z(5+V.length);B.write_shift(2,14e3),B.write_shift(2,z);for(var j=0;j<V.length;++j){var re=V.charCodeAt(j);B[B.l++]=re>127?95:re}return B[B.l++]=0,B}var te={0:{n:"BOF",f:tI},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ie},222:{n:"SHEETNAMELP",f:nt},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),ob=/^\s|\s$|[\t\n\r]/;function oI(t,e){if(!e.bookSST)return"";var r=[Vt];r[r.length]=de("sst",null,{xmlns:nl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(ob)&&(s+=' xml:space="preserve"'),s+=">"+Ze(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function lb(t){return[t.read_shift(4),t.read_shift(4)]}function ub(t,e){return e||(e=Z(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var cb=e8;function fb(t){var e=Ur();ae(e,159,ub(t));for(var r=0;r<t.length;++r)ae(e,19,cb(t[r]));return ae(e,160),e.end()}function hb(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function lI(t){var e=0,r,n=hb(t),i=n.length+1,s,a,o,l,u;for(r=wa(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var db=function(){function t(i,s){switch(s.type){case"base64":return e(Ni(i),s);case"binary":return e(i,s);case"buffer":return e(qe&&Buffer.isBuffer(i)?i.toString("binary"):oc(i),s);case"array":return e(Pd(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,y,g=-1;y=d.exec(f);){switch(y[0]){case"\\cell":var A=f.slice(m,d.lastIndex-y[0].length);if(A[0]==" "&&(A=A.slice(1)),++g,A.length){var w={v:A,t:"s"};Array.isArray(o)?o[h][g]=w:o[tt({r:h,c:g})]=w}break}m=d.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=Mt(u),o}function r(i,s){return Da(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=mt(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=tt({r:u,c:f});o=l?(i[u]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Di(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Vx(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var pb=6,Ei=pb;function Oh(t){return Math.floor((t+Math.round(128/Ei)/256)*Ei)}function Fh(t){return Math.floor((t-5)/Ei*100+.5)/100}function _m(t){return Math.round((t*Ei+5)/Ei*256)/256}function C1(t){t.width?(t.wpx=Oh(t.width),t.wch=Fh(t.wpx),t.MDW=Ei):t.wpx?(t.wch=Fh(t.wpx),t.width=_m(t.wch),t.MDW=Ei):typeof t.wch=="number"&&(t.width=_m(t.wch),t.wpx=Oh(t.width),t.MDW=Ei),t.customWidth&&delete t.customWidth}var mb=96,uI=mb;function Lh(t){return t*96/uI}function cI(t){return t*uI/96}function gb(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=de("numFmt",null,{numFmtId:n,formatCode:Ze(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=de("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function vb(t){var e=[];return e[e.length]=de("cellXfs",null),t.forEach(function(r){e[e.length]=de("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=de("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function fI(t,e){var r=[Vt,de("styleSheet",null,{xmlns:nl[0],"xmlns:vt":Xt.vt})],n;return t.SSF&&(n=gb(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=vb(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function _b(t,e){var r=t.read_shift(2),n=yr(t);return[r,n]}function yb(t,e,r){r||(r=Z(6+4*e.length)),r.write_shift(2,t),Qt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function xb(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=o8(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=a8(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=yr(t),n}function wb(t,e){e||(e=Z(25+4*32)),e.write_shift(2,t.sz*20),l8(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Nh(t.color,e);var n=0;return n=2,e.write_shift(1,n),Qt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Eb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],B0,Tb=ai;function Ux(t,e){e||(e=Z(4*3+8*7+16*1)),B0||(B0=m1(Eb));var r=B0[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Nh({auto:1},e),Nh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Sb(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function hI(t,e,r){r||(r=Z(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Rl(t,e){return e||(e=Z(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ab=ai;function Ib(t,e){return e||(e=Z(51)),e.write_shift(1,0),Rl(null,e),Rl(null,e),Rl(null,e),Rl(null,e),Rl(null,e),e.length>e.l?e.slice(0,e.l):e}function Cb(t,e){return e||(e=Z(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ph(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Rb(t,e,r){var n=Z(2052);return n.write_shift(4,t),Ph(e,n),Ph(r,n),n.length>n.l?n.slice(0,n.l):n}function kb(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ae(t,615,Ln(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ae(t,44,yb(i,e[i]))}),ae(t,616))}}function Pb(t){var e=1;ae(t,611,Ln(e)),ae(t,43,wb({sz:12,color:{theme:1},name:"Calibri",family:2})),ae(t,612)}function Nb(t){var e=2;ae(t,603,Ln(e)),ae(t,45,Ux({patternType:"none"})),ae(t,45,Ux({patternType:"gray125"})),ae(t,604)}function Db(t){var e=1;ae(t,613,Ln(e)),ae(t,46,Ib()),ae(t,614)}function Ob(t){var e=1;ae(t,626,Ln(e)),ae(t,47,hI({numFmtId:0},65535)),ae(t,627)}function Fb(t,e){ae(t,617,Ln(e.length)),e.forEach(function(r){ae(t,47,hI(r,0))}),ae(t,618)}function Lb(t){var e=1;ae(t,619,Ln(e)),ae(t,48,Cb({xfId:0,name:"Normal"})),ae(t,620)}function bb(t){var e=0;ae(t,505,Ln(e)),ae(t,506)}function Mb(t){var e=0;ae(t,508,Rb(e,"TableStyleMedium9","PivotStyleMedium4")),ae(t,509)}function Vb(t,e){var r=Ur();return ae(r,278),kb(r,t.SSF),Pb(r),Nb(r),Db(r),Ob(r),Fb(r,e.cellXfs),Lb(r),bb(r),Mb(r),ae(r,279),r.end()}function dI(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Vt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ub(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:yr(t)}}function Bb(t){var e=Z(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Qt(t.name,e),e.slice(0,e.l)}function jb(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function zb(t){var e=Z(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Wb(t,e){var r=Z(8+2*e.length);return r.write_shift(4,t),Qt(e,r),r.slice(0,r.l)}function Hb(t){return t.l+=4,t.read_shift(4)!=0}function $b(t,e){var r=Z(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Gb(){var t=Ur();return ae(t,332),ae(t,334,Ln(1)),ae(t,335,Bb({name:"XLDAPR",version:12e4,flags:3496657072})),ae(t,336),ae(t,339,Wb(1,"XLDAPR")),ae(t,52),ae(t,35,Ln(514)),ae(t,4096,Ln(0)),ae(t,4097,sn(1)),ae(t,36),ae(t,53),ae(t,340),ae(t,337,$b(1)),ae(t,51,zb([[1,0]])),ae(t,338),ae(t,333),t.end()}function pI(){var t=[Vt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Kb(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=tt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var vo=1024;function mI(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[de("xml",null,{"xmlns:v":Gr.v,"xmlns:o":Gr.o,"xmlns:x":Gr.x,"xmlns:mv":Gr.mv}).replace(/\/>/,">"),de("o:shapelayout",de("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),de("v:shapetype",[de("v:stroke",null,{joinstyle:"miter"}),de("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];vo<t*1e3;)vo+=1e3;return e.forEach(function(s){var a=Yt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?de("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=de("v:fill",l,o),f={on:"t",obscured:"t"};++vo,i=i.concat(["<v:shape"+Bu({id:"_x0000_s"+vo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,de("v:shadow",null,f),de("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ar("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),ar("x:AutoFill","False"),ar("x:Row",String(a.r)),ar("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gI(t){var e=[Vt,de("comments",null,{xmlns:nl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Ze(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Ze(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(ar("t",Ze(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(ar("t",Ze(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function qb(t,e,r){var n=[Vt,de("ThreadedComments",null,{xmlns:Xt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(de("threadedComment",ar("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function Xb(t){var e=[Vt,de("personList",null,{xmlns:Xt.TCMNT,"xmlns:x":nl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(de("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Yb(t){var e={};e.iauthor=t.read_shift(4);var r=ba(t);return e.rfx=r.s,e.ref=tt(r.s),t.l+=16,e}function Qb(t,e){return e==null&&(e=Z(36)),e.write_shift(4,t[1].iauthor),sl(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Jb=yr;function Zb(t){return Qt(t.slice(0,54))}function eM(t){var e=Ur(),r=[];return ae(e,628),ae(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ae(e,632,Zb(i.a)))})}),ae(e,631),ae(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Yt(n[0]),e:Yt(n[0])};ae(e,635,Qb([s,i])),i.t&&i.t.length>0&&ae(e,637,r8(i)),ae(e,636),delete i.iauthor})}),ae(e,634),ae(e,629),e.end()}function tM(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&rt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var vI=["xlsb","xlsm","xlam","biff8","xla"],rM=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+_r(f)+(l?"":"$")+lr(u)}return function(i,s){return e=s,i.replace(t,r)}}(),R1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,k1=function(){return function(e,r){return e.replace(R1,function(n,i,s,a,o,l){var u=E1(a)-(s?0:r.c),f=w1(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+d})}}();function nM(t,e){return t.replace(R1,function(r,n,i,s,a,o){return n+(i=="$"?i+s:_r(E1(s)+e.c))+(a=="$"?a+o:lr(w1(o)+e.r))})}function iM(t){return t.length!=1}function Dt(t){t.l+=1}function ks(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function _I(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return yI(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=ks(t),o=ks(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function yI(t){var e=ks(t),r=ks(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function sM(t,e,r){if(r.biff<8)return yI(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=ks(t),a=ks(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function xI(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return aM(t);var n=t.read_shift(r&&r.biff==12?4:2),i=ks(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function aM(t){var e=ks(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function oM(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function lM(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return uM(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function uM(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function cM(t,e,r){var n=(t[t.l++]&96)>>5,i=_I(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function fM(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=_I(t,s,r);return[n,i,a]}function hM(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function dM(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function pM(t,e,r){var n=(t[t.l++]&96)>>5,i=sM(t,e-1,r);return[n,i]}function mM(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Bx(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function gM(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function vM(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function _M(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function yM(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function xM(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function wI(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function wM(t){return t.read_shift(2),wI(t)}function EM(t){return t.read_shift(2),wI(t)}function TM(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=xI(t,0,r);return[n,i]}function SM(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=lM(t,0,r);return[n,i]}function AM(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=xI(t,0,r);return[n,i,s]}function IM(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[I9[i],SI[i],n]}function CM(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:RM(t);return[i,(s[0]===0?SI:A9)[s[1]]]}function RM(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function kM(t,e,r){t.l+=r&&r.biff==2?3:4}function PM(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function NM(t){return t.l++,cc[t.read_shift(1)]}function DM(t){return t.l++,t.read_shift(2)}function OM(t){return t.l++,t.read_shift(1)!==0}function FM(t){return t.l++,al(t)}function LM(t,e,r){return t.l++,nI(t,e-1,r)}function bM(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=A8(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=cc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=al(t);break;case 2:r[1]=k8(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function MM(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ba:D8)(t));return i}function VM(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=bM(t,r.biff);return a}function UM(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function BM(t,e,r){if(r.biff==5)return jM(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function jM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function zM(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function WM(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function HM(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function $M(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var GM=ai,KM=ai,qM=ai;function fc(t,e,r){return t.l+=2,[oM(t)]}function P1(t){return t.l+=6,[]}var XM=fc,YM=P1,QM=P1,JM=fc;function EI(t){return t.l+=2,[tI(t),t.read_shift(2)&1]}var ZM=fc,e9=EI,t9=P1,r9=fc,n9=fc,i9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function s9(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=i9[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function a9(t){return t.l+=2,[t.read_shift(4)]}function o9(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function l9(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function u9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function c9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function f9(t){return t.l+=4,[0,0]}var jx={1:{n:"PtgExp",f:PM},2:{n:"PtgTbl",f:qM},3:{n:"PtgAdd",f:Dt},4:{n:"PtgSub",f:Dt},5:{n:"PtgMul",f:Dt},6:{n:"PtgDiv",f:Dt},7:{n:"PtgPower",f:Dt},8:{n:"PtgConcat",f:Dt},9:{n:"PtgLt",f:Dt},10:{n:"PtgLe",f:Dt},11:{n:"PtgEq",f:Dt},12:{n:"PtgGe",f:Dt},13:{n:"PtgGt",f:Dt},14:{n:"PtgNe",f:Dt},15:{n:"PtgIsect",f:Dt},16:{n:"PtgUnion",f:Dt},17:{n:"PtgRange",f:Dt},18:{n:"PtgUplus",f:Dt},19:{n:"PtgUminus",f:Dt},20:{n:"PtgPercent",f:Dt},21:{n:"PtgParen",f:Dt},22:{n:"PtgMissArg",f:Dt},23:{n:"PtgStr",f:LM},26:{n:"PtgSheet",f:o9},27:{n:"PtgEndSheet",f:l9},28:{n:"PtgErr",f:NM},29:{n:"PtgBool",f:OM},30:{n:"PtgInt",f:DM},31:{n:"PtgNum",f:FM},32:{n:"PtgArray",f:mM},33:{n:"PtgFunc",f:IM},34:{n:"PtgFuncVar",f:CM},35:{n:"PtgName",f:UM},36:{n:"PtgRef",f:TM},37:{n:"PtgArea",f:cM},38:{n:"PtgMemArea",f:zM},39:{n:"PtgMemErr",f:GM},40:{n:"PtgMemNoMem",f:KM},41:{n:"PtgMemFunc",f:WM},42:{n:"PtgRefErr",f:HM},43:{n:"PtgAreaErr",f:hM},44:{n:"PtgRefN",f:SM},45:{n:"PtgAreaN",f:pM},46:{n:"PtgMemAreaN",f:u9},47:{n:"PtgMemNoMemN",f:c9},57:{n:"PtgNameX",f:BM},58:{n:"PtgRef3d",f:AM},59:{n:"PtgArea3d",f:fM},60:{n:"PtgRefErr3d",f:$M},61:{n:"PtgAreaErr3d",f:dM},255:{}},h9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},d9={1:{n:"PtgElfLel",f:EI},2:{n:"PtgElfRw",f:r9},3:{n:"PtgElfCol",f:XM},6:{n:"PtgElfRwV",f:n9},7:{n:"PtgElfColV",f:JM},10:{n:"PtgElfRadical",f:ZM},11:{n:"PtgElfRadicalS",f:t9},13:{n:"PtgElfColS",f:YM},15:{n:"PtgElfColSV",f:QM},16:{n:"PtgElfRadicalLel",f:e9},25:{n:"PtgList",f:s9},29:{n:"PtgSxName",f:a9},255:{}},p9={0:{n:"PtgAttrNoop",f:f9},1:{n:"PtgAttrSemi",f:xM},2:{n:"PtgAttrIf",f:_M},4:{n:"PtgAttrChoose",f:gM},8:{n:"PtgAttrGoto",f:vM},16:{n:"PtgAttrSum",f:kM},32:{n:"PtgAttrBaxcel",f:Bx},33:{n:"PtgAttrBaxcel",f:Bx},64:{n:"PtgAttrSpace",f:wM},65:{n:"PtgAttrSpaceSemi",f:EM},128:{n:"PtgAttrIfError",f:yM},255:{}};function m9(t,e,r,n){if(n.biff<8)return ai(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=VM(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=MM(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(ai(t,e)),s}function g9(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=jx[s]||jx[h9[s]],(s===24||s===25)&&(i=(s===24?d9:p9)[t[t.l+1]]),!i||!i.f?ai(t,e):a.push([i.n,i.f(t,e,r)]);return a}function v9(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var _9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function y9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function TI(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function zx(t,e,r){var n=TI(t,e,r);return n=="#REF"?n:y9(n,r)}function qo(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,h=0,d=0,m,y="";if(!t[0]||!t[0][0])return"";for(var g=-1,A="",w=0,x=t[0].length;w<x;++w){var I=t[0][w];switch(I[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:A=St(" ",t[0][g][1][1]);break;case 1:A=St("\r",t[0][g][1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}u=u+A,g=-1}o.push(u+_9[I[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=su(I[1][1],a,i),o.push(au(f,s));break;case"PtgRefN":f=r?su(I[1][1],r,i):I[1][1],o.push(au(f,s));break;case"PtgRef3d":h=I[1][1],f=su(I[1][2],a,i),y=zx(n,h,i),o.push(y+"!"+au(f,s));break;case"PtgFunc":case"PtgFuncVar":var L=I[1][0],W=I[1][1];L||(L=0),L&=127;var G=L==0?[]:o.slice(-L);o.length-=L,W==="User"&&(W=G.shift()),o.push(W+"("+G.join(",")+")");break;case"PtgBool":o.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(I[1]);break;case"PtgNum":o.push(String(I[1]));break;case"PtgStr":o.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(I[1]);break;case"PtgAreaN":m=Ix(I[1][1],r?{s:r}:a,i),o.push(V0(m,i));break;case"PtgArea":m=Ix(I[1][1],a,i),o.push(V0(m,i));break;case"PtgArea3d":h=I[1][1],m=I[1][2],y=zx(n,h,i),o.push(y+"!"+V0(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=I[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],T=E?E.Name:"SH33TJSNAME"+String(d);T&&T.slice(0,6)=="_xlfn."&&!i.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var S=I[1][1];d=I[1][2];var R;if(i.biff<=5)S<0&&(S=-S),n[S]&&(R=n[S][d]);else{var N="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][d]&&n[S][d].itab>0&&(N=n.SheetNames[n[S][d].itab-1]+"!"):N=n.SheetNames[d-1]+"!"),n[S]&&n[S][d])N+=n[S][d].Name;else if(n[0]&&n[0][d])N+=n[0][d].Name;else{var M=(TI(n,S,i)||"").split(";;");M[d-1]?N=M[d-1]:N+="SH33TJSERRX"}o.push(N);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var D="(",Re=")";if(g>=0){switch(A="",t[0][g][1][0]){case 2:D=St(" ",t[0][g][1][1])+D;break;case 3:D=St("\r",t[0][g][1][1])+D;break;case 4:Re=St(" ",t[0][g][1][1])+Re;break;case 5:Re=St("\r",t[0][g][1][1])+Re;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(D+o.pop()+Re);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:I[1][1],r:I[1][0]};var Ie={c:r.c,r:r.r};if(n.sharedf[tt(f)]){var nt=n.sharedf[tt(f)];o.push(qo(nt,a,Ie,n,i))}else{var Ke=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(qo(u[1],a,Ie,n,i)),Ke=!0;break}Ke||o.push(I[1])}break;case"PtgArray":o.push("{"+v9(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&he.indexOf(t[0][w][0])==-1){I=t[0][g];var J=!0;switch(I[1][0]){case 4:J=!1;case 0:A=St(" ",I[1][1]);break;case 5:J=!1;case 1:A=St("\r",I[1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}o.push((J?A:"")+o.pop()+(J?"":A)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function x9(t){if(t==null){var e=Z(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ea(t);return Ea(0)}function w9(t,e,r,n,i){var s=Ta(e,r,i),a=x9(t.v),o=Z(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Z(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var h=sr([s,a,o,u]);return h}function Nd(t,e,r){var n=t.read_shift(4),i=g9(t,n,r),s=t.read_shift(4),a=s>0?m9(t,s,i,r):null;return[i,a]}var E9=Nd,Dd=Nd,T9=Nd,S9=Nd,A9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},SI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},I9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function C9(t){var e="of:="+t.replace(R1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function R9(t){return t.replace(/\./,"!")}var ou=typeof Map<"u";function N1(t,e,r){var n=0,i=t.length;if(r){if(ou?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=ou?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(ou?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Od(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ei=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Fh(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=_m(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function AI(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Us(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){xA(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function k9(t,e,r){if(t&&t["!ref"]){var n=mt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function P9(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Mt(t[r])+'"/>';return e+"</mergeCells>"}function N9(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Uu(Ze(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+de("outlinePr",null,u)}!s&&!o||(i[i.length]=de("sheetPr",o,a))}var D9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],O9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function F9(t){var e={sheet:1};return D9.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),O9.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=lI(t.password).toString(16).toUpperCase()),de("sheetProtection",null,e)}function L9(t){return AI(t),de("pageMargins",null,t)}function b9(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=de("col",null,Od(i,n)));return r[r.length]="</cols>",r.join("")}function M9(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Mt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Zr(i);a.s.r==a.e.r&&(a.e.r=Zr(e["!ref"]).e.r,i=Mt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),de("autoFilter",null,{ref:i})}function V9(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),de("sheetViews",de("sheetView",null,i),{})}function U9(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=cc[t.v];break;case"d":n&&n.cellDates?i=Cr(t.v,-1).toISOString():(t=jr(t),t.t="n",i=""+(t.v=Br(Cr(t.v)))),typeof t.z>"u"&&(t.z=At[14]);break;default:i=t.v;break}var o=ar("v",Ze(i)),l={r:e},u=Us(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ar("v",""+N1(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=de("f",Ze(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),de("c",o,l)}function B9(t,e,r,n){var i=[],s=[],a=mt(t["!ref"]),o="",l,u="",f=[],h=0,d=0,m=t["!rows"],y=Array.isArray(t),g={r:u},A,w=-1;for(d=a.s.c;d<=a.e.c;++d)f[d]=_r(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],u=lr(h),d=a.s.c;d<=a.e.c;++d){l=f[d]+u;var x=y?(t[h]||[])[d]:t[l];x!==void 0&&(o=U9(x,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(g={r:u},m&&m[h]&&(A=m[h],A.hidden&&(g.hidden=1),w=-1,A.hpx?w=Lh(A.hpx):A.hpt&&(w=A.hpt),w>-1&&(g.ht=w,g.customHeight=1),A.level&&(g.outlineLevel=A.level)),i[i.length]=de("row",s.join(""),g))}if(m)for(;h<m.length;++h)m&&m[h]&&(g={r:h+1},A=m[h],A.hidden&&(g.hidden=1),w=-1,A.hpx?w=Lh(A.hpx):A.hpt&&(w=A.hpt),w>-1&&(g.ht=w,g.customHeight=1),A.level&&(g.outlineLevel=A.level),i[i.length]=de("row","",g));return i.join("")}function II(t,e,r,n){var i=[Vt,de("worksheet",null,{xmlns:nl[0],"xmlns:r":Xt.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=mt(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Mt(f)}n||(n={}),l["!comments"]=[];var h=[];N9(l,r,t,e,i),i[i.length]=de("dimension",null,{ref:u}),i[i.length]=V9(l,e,t,r),e.sheetFormat&&(i[i.length]=de("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=b9(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=B9(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=F9(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=M9(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=P9(l["!merges"]));var d=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(y=Je(n,-1,Ze(g[1].Target).replace(/#.*$/,""),Ge.HLINK),m["r:id"]="rId"+y),(d=g[1].Target.indexOf("#"))>-1&&(m.location=Ze(g[1].Target.slice(d+1))),g[1].Tooltip&&(m.tooltip=Ze(g[1].Tooltip)),i[i.length]=de("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=L9(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=ar("ignoredErrors",de("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(y=Je(n,-1,"../drawings/drawing"+(t+1)+".xml",Ge.DRAW),i[i.length]=de("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=Je(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ge.VML),i[i.length]=de("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function j9(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function z9(t,e,r){var n=Z(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Lh(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var h=-1,d=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[tt(u)];y&&(h<0&&(h=m),d=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function W9(t,e,r,n){var i=z9(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ae(t,0,i)}var H9=ba,$9=sl;function G9(){}function K9(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=n8(t),r}function q9(t,e,r){r==null&&(r=Z(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Nh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jA(t,r),r.slice(0,r.l)}function X9(t){var e=gn(t);return[e]}function Y9(t,e,r){return r==null&&(r=Z(8)),Oa(e,r)}function Q9(t){var e=Fa(t);return[e]}function J9(t,e,r){return r==null&&(r=Z(4)),La(e,r)}function Z9(t){var e=gn(t),r=t.read_shift(1);return[e,r,"b"]}function eV(t,e,r){return r==null&&(r=Z(9)),Oa(e,r),r.write_shift(1,t.v?1:0),r}function tV(t){var e=Fa(t),r=t.read_shift(1);return[e,r,"b"]}function rV(t,e,r){return r==null&&(r=Z(5)),La(e,r),r.write_shift(1,t.v?1:0),r}function nV(t){var e=gn(t),r=t.read_shift(1);return[e,r,"e"]}function iV(t,e,r){return r==null&&(r=Z(9)),Oa(e,r),r.write_shift(1,t.v),r}function sV(t){var e=Fa(t),r=t.read_shift(1);return[e,r,"e"]}function aV(t,e,r){return r==null&&(r=Z(8)),La(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function oV(t){var e=gn(t),r=t.read_shift(4);return[e,r,"s"]}function lV(t,e,r){return r==null&&(r=Z(12)),Oa(e,r),r.write_shift(4,e.v),r}function uV(t){var e=Fa(t),r=t.read_shift(4);return[e,r,"s"]}function cV(t,e,r){return r==null&&(r=Z(8)),La(e,r),r.write_shift(4,e.v),r}function fV(t){var e=gn(t),r=al(t);return[e,r,"n"]}function hV(t,e,r){return r==null&&(r=Z(16)),Oa(e,r),Ea(t.v,r),r}function dV(t){var e=Fa(t),r=al(t);return[e,r,"n"]}function pV(t,e,r){return r==null&&(r=Z(12)),La(e,r),Ea(t.v,r),r}function mV(t){var e=gn(t),r=zA(t);return[e,r,"n"]}function gV(t,e,r){return r==null&&(r=Z(12)),Oa(e,r),WA(t.v,r),r}function vV(t){var e=Fa(t),r=zA(t);return[e,r,"n"]}function _V(t,e,r){return r==null&&(r=Z(8)),La(e,r),WA(t.v,r),r}function yV(t){var e=gn(t),r=T1(t);return[e,r,"is"]}function xV(t){var e=gn(t),r=yr(t);return[e,r,"str"]}function wV(t,e,r){return r==null&&(r=Z(12+4*t.v.length)),Oa(e,r),Qt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function EV(t){var e=Fa(t),r=yr(t);return[e,r,"str"]}function TV(t,e,r){return r==null&&(r=Z(8+4*t.v.length)),La(e,r),Qt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SV(t,e,r){var n=t.l+e,i=gn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Dd(t,n-t.l,r);a[3]=qo(o,null,i,r.supbooks,r)}else t.l=n;return a}function AV(t,e,r){var n=t.l+e,i=gn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Dd(t,n-t.l,r);a[3]=qo(o,null,i,r.supbooks,r)}else t.l=n;return a}function IV(t,e,r){var n=t.l+e,i=gn(t);i.r=r["!row"];var s=al(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Dd(t,n-t.l,r);a[3]=qo(o,null,i,r.supbooks,r)}else t.l=n;return a}function CV(t,e,r){var n=t.l+e,i=gn(t);i.r=r["!row"];var s=yr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Dd(t,n-t.l,r);a[3]=qo(o,null,i,r.supbooks,r)}else t.l=n;return a}var RV=ba,kV=sl;function PV(t,e){return e==null&&(e=Z(4)),e.write_shift(4,t),e}function NV(t,e){var r=t.l+e,n=ba(t),i=S1(t),s=yr(t),a=yr(t),o=yr(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function DV(t,e){var r=Z(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));sl({s:Yt(t[0]),e:Yt(t[0])},r),A1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Qt(i||"",r),Qt(t[1].Tooltip||"",r),Qt("",r),r.slice(0,r.l)}function OV(){}function FV(t,e,r){var n=t.l+e,i=HA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=E9(t,n-t.l,r);a[1]=o}else t.l=n;return a}function LV(t,e,r){var n=t.l+e,i=ba(t),s=[i];if(r.cellFormula){var a=S9(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function bV(t,e,r){r==null&&(r=Z(18));var n=Od(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var CI=["left","right","top","bottom","header","footer"];function MV(t){var e={};return CI.forEach(function(r){e[r]=al(t)}),e}function VV(t,e){return e==null&&(e=Z(6*8)),AI(t),CI.forEach(function(r){Ea(t[r],e)}),e}function UV(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function BV(t,e,r){r==null&&(r=Z(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function jV(t){var e=Z(24);return e.write_shift(4,4),e.write_shift(4,1),sl(t,e),e}function zV(t,e){return e==null&&(e=Z(16*4+2)),e.write_shift(2,t.password?lI(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function WV(){}function HV(){}function $V(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=jr(e),e.z=e.z||At[14],e.v=Br(Cr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Us(i.cellXfs,e,i),e.l&&s["!links"].push([tt(l),e.l]),e.c&&s["!comments"].push([tt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=N1(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?ae(t,18,cV(e,l)):ae(t,7,lV(e,l))):(l.t="str",a?ae(t,17,TV(e,l)):ae(t,6,wV(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ae(t,13,_V(e,l)):ae(t,2,gV(e,l)):a?ae(t,16,pV(e,l)):ae(t,5,hV(e,l)),!0;case"b":return l.t="b",a?ae(t,15,rV(e,l)):ae(t,4,eV(e,l)),!0;case"e":return l.t="e",a?ae(t,14,aV(e,l)):ae(t,3,iV(e,l)),!0}return a?ae(t,12,J9(e,l)):ae(t,1,Y9(e,l)),!0}function GV(t,e,r,n){var i=mt(e["!ref"]||"A1"),s,a="",o=[];ae(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=lr(f),W9(t,e,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=_r(d)),s=o[d]+a;var m=l?(e[f]||[])[d]:e[s];if(!m){h=!1;continue}h=$V(t,m,f,d,n,e,h)}}ae(t,146)}function KV(t,e){!e||!e["!merges"]||(ae(t,177,PV(e["!merges"].length)),e["!merges"].forEach(function(r){ae(t,176,kV(r))}),ae(t,178))}function qV(t,e){!e||!e["!cols"]||(ae(t,390),e["!cols"].forEach(function(r,n){r&&ae(t,60,bV(n,r))}),ae(t,391))}function XV(t,e){!e||!e["!ref"]||(ae(t,648),ae(t,649,jV(mt(e["!ref"]))),ae(t,650))}function YV(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Je(r,-1,n[1].Target.replace(/#.*$/,""),Ge.HLINK);ae(t,494,DV(n,i))}}),delete e["!links"]}function QV(t,e,r,n){if(e["!comments"].length>0){var i=Je(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML);ae(t,551,A1("rId"+i)),e["!legacy"]=i}}function JV(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Mt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Zr(s);o.s.r==o.e.r&&(o.e.r=Zr(e["!ref"]).e.r,s=Mt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ae(t,161,sl(mt(s))),ae(t,162)}}function ZV(t,e,r){ae(t,133),ae(t,137,BV(e,r)),ae(t,138),ae(t,134)}function e7(t,e){e["!protect"]&&ae(t,535,zV(e["!protect"]))}function t7(t,e,r,n){var i=Ur(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=mt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ae(i,129),(r.vbaraw||a["!outline"])&&ae(i,147,q9(o,a["!outline"])),ae(i,148,$9(l)),ZV(i,a,r.Workbook),qV(i,a),GV(i,a,t,e),e7(i,a),JV(i,a,r,t),KV(i,a),YV(i,a,n),a["!margins"]&&ae(i,476,VV(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&XV(i,a),QV(i,a,t,n),ae(i,130),i.end()}function r7(t,e){t.l+=10;var r=yr(t);return{name:r}}var n7=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function i7(t){return!t.Workbook||!t.Workbook.WBProps?"false":L5(t.Workbook.WBProps.date1904)?"true":"false"}var s7="][*?/\\".split("");function RI(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return s7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function a7(t,e,r){t.forEach(function(n,i){RI(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function o7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];a7(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)k9(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function kI(t){var e=[Vt];e[e.length]=de("workbook",null,{xmlns:nl[0],"xmlns:r":Xt.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(n7.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=de("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Ze(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=de("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=de("definedName",Ze(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function l7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=vm(t),r.name=yr(t),r}function u7(t,e){return e||(e=Z(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),A1(t.strRelID,e),Qt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function c7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?yr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function f7(t,e){e||(e=Z(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),jA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function h7(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=i8(t),a=T9(t,0,r),o=S1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function d7(t,e){ae(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ae(t,156,u7(i))}ae(t,144)}function p7(t,e){e||(e=Z(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Qt("SheetJS",e),Qt(Th.version,e),Qt(Th.version,e),Qt("7262",e),e.length>e.l?e.slice(0,e.l):e}function m7(t,e){e||(e=Z(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function g7(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ae(t,135),ae(t,158,m7(i)),ae(t,136))}}function v7(t,e){var r=Ur();return ae(r,131),ae(r,128,p7()),ae(r,153,f7(t.Workbook&&t.Workbook.WBProps||null)),g7(r,t),d7(r,t),ae(r,132),r.end()}function _7(t,e,r){return(e.slice(-4)===".bin"?v7:kI)(t)}function y7(t,e,r,n,i){return(e.slice(-4)===".bin"?t7:II)(t,r,n,i)}function x7(t,e,r){return(e.slice(-4)===".bin"?Vb:fI)(t,r)}function w7(t,e,r){return(e.slice(-4)===".bin"?fb:oI)(t,r)}function E7(t,e,r){return(e.slice(-4)===".bin"?eM:gI)(t)}function T7(t){return(t.slice(-4)===".bin"?Gb:pI)()}function S7(t,e){var r=[];return t.Props&&r.push(x8(t.Props,e)),t.Custprops&&r.push(w8(t.Props,t.Custprops)),r.join("")}function A7(){return""}function I7(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(de("NumberFormat",null,{"ss:Format":Ze(At[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(de("Style",s.join(""),a))}),de("Styles",r.join(""))}function PI(t){return de("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+k1(t.Ref,{r:0,c:0})})}function C7(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(PI(i)))}return de("Names",r.join(""))}function R7(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(PI(o)))}return s.join("")}function k7(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(de("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(de("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(de("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(de("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(ar("ProtectContents","True")),t["!protect"].objects&&i.push(ar("ProtectObjects","True")),t["!protect"].scenarios&&i.push(ar("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(ar("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(ar("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":de("WorksheetOptions",i.join(""),{xmlns:Gr.x})}function P7(t){return t.map(function(e){var r=F5(e.t||""),n=de("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return de("Comment",n,{"ss:Author":e.a})}).join("")}function N7(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Ze(k1(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Yt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Ze(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Ze(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=cc[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||At[14]);break;case"s":h="String",d=O5(t.v||"");break}var m=Us(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?d:"",g=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(g+=P7(t.c)),de("Cell",g,o)}function D7(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=cI(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function O7(t,e,r,n){if(!t["!ref"])return"";var i=mt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(A,w){C1(A);var x=!!A.width,I=Od(w,A),L={"ss:Index":w+1};x&&(L["ss:Width"]=Oh(I.width)),A.hidden&&(L["ss:Hidden"]="1"),o.push(de("Column",null,L))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[D7(u,(t["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>u)&&!(s[a].e.c<h)&&!(s[a].e.r<u)){(s[a].s.c!=h||s[a].s.r!=u)&&(d=!0);break}if(!d){var m={r:u,c:h},y=tt(m),g=l?(t[u]||[])[h]:t[y];f.push(N7(g,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function F7(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?R7(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?O7(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(k7(s,e,t,r)),n.join("")}function L7(t,e){e||(e={}),t.SSF||(t.SSF=jr(At)),t.SSF&&(Rd(),Cd(t.SSF),e.revssf=kd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Us(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(S7(t,e)),r.push(A7()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(de("Worksheet",F7(n,e,t),{"ss:Name":Ze(t.SheetNames[n])}));return r[2]=I7(t,e),r[3]=C7(t),Vt+de("Workbook",r.join(""),{xmlns:Gr.ss,"xmlns:o":Gr.o,"xmlns:x":Gr.x,"xmlns:ss":Gr.ss,"xmlns:dt":Gr.dt,"xmlns:html":Gr.html})}var j0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function b7(t,e){var r=[],n=[],i=[],s=0,a,o=mx(Rx,"n"),l=mx(kx,"n");if(t.Props)for(a=fr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=fr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)eI.indexOf(i[s][0])>-1||QA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&rt.utils.cfb_add(e,"/SummaryInformation",Fx(n,j0.SI,l,kx)),(r.length||u.length)&&rt.utils.cfb_add(e,"/DocumentSummaryInformation",Fx(r,j0.DSI,o,Rx,u.length?u:null,j0.UDI))}function M7(t,e){var r=e||{},n=rt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return rt.utils.cfb_add(n,i,NI(t,r)),r.biff==8&&(t.Props||t.Custprops)&&b7(t,n),r.biff==8&&t.vbaraw&&tM(n,rt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var V7={0:{f:j9},1:{f:X9},2:{f:mV},3:{f:nV},4:{f:Z9},5:{f:fV},6:{f:xV},7:{f:oV},8:{f:CV},9:{f:IV},10:{f:SV},11:{f:AV},12:{f:Q9},13:{f:vV},14:{f:sV},15:{f:tV},16:{f:dV},17:{f:EV},18:{f:uV},19:{f:T1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:h7},40:{},42:{},43:{f:xb},44:{f:_b},45:{f:Tb},46:{f:Ab},47:{f:Sb},48:{},49:{f:Q5},50:{},51:{f:jb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:J8},62:{f:yV},63:{f:Kb},64:{f:WV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ai,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:UV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:K9},148:{f:H9,p:16},151:{f:OV},152:{},153:{f:c7},154:{},155:{},156:{f:l7},157:{},158:{},159:{T:1,f:lb},160:{T:-1},161:{T:1,f:ba},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:RV},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ub},336:{T:-1},337:{f:Hb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:vm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:G8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:FV},427:{f:LV},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:MV},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:G9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:vm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Jb},633:{T:1},634:{T:-1},635:{T:1,f:Yb},636:{T:-1},637:{f:t8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:r7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:HV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function pe(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&x1(r)&&t.push(r)}}function U7(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return pe(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function hc(t,e,r){return t||(t=Z(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function B7(t,e,r,n){var i=Z(9);return hc(i,t,e),rI(r,n||"b",i),i}function j7(t,e,r){var n=Z(8+2*r.length);return hc(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function z7(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Br(Cr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?pe(t,2,rb(r,n,i)):pe(t,3,tb(r,n,i));return;case"b":case"e":pe(t,5,B7(r,n,e.v,e.t));return;case"s":case"str":pe(t,4,j7(r,n,(e.v||"").slice(0,255)));return}pe(t,1,hc(null,r,n))}function W7(t,e,r,n){var i=Array.isArray(e),s=mt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Mt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=lr(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=_r(f)),a=l[f]+o;var h=i?(e[u]||[])[f]:e[a];h&&z7(t,h,u,f)}}}function H7(t,e){for(var r=e||{},n=Ur(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return pe(n,r.biff==4?1033:r.biff==3?521:9,I1(t,16,r)),W7(n,t.Sheets[t.SheetNames[i]],i,r),pe(n,10),n.end()}function $7(t,e,r){pe(t,49,V8({sz:12,name:"Arial"},r))}function G7(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&pe(t,1054,j8(i,e[i],r))})}function K7(t,e){var r=Z(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),pe(t,2151,r),r=Z(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sI(mt(e["!ref"]||"A1"),r),r.write_shift(4,4),pe(t,2152,r)}function q7(t,e){for(var r=0;r<16;++r)pe(t,224,bx({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){pe(t,224,bx(n,0,e))})}function X7(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];pe(t,440,X8(n)),n[1].Tooltip&&pe(t,2048,Y8(n))}delete e["!links"]}function Y7(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&pe(t,125,Z8(Od(i,n),i))})}}function Q7(t,e,r,n,i){var s=16+Us(i.cellXfs,e,i);if(e.v==null&&!e.bf){pe(t,513,Ta(r,n,s));return}if(e.bf)pe(t,6,w9(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Br(Cr(e.v)):e.v;pe(t,515,$8(r,n,a,s));break;case"b":case"e":pe(t,517,H8(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=N1(i.Strings,e.v,i.revStrings);pe(t,253,U8(r,n,o,s))}else pe(t,516,B8(r,n,(e.v||"").slice(0,255),s,i));break;default:pe(t,513,Ta(r,n,s))}}function J7(t,e,r){var n=Ur(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,h="",d=[],m=mt(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}pe(n,2057,I1(r,16,e)),pe(n,13,sn(1)),pe(n,12,sn(100)),pe(n,15,Sr(!0)),pe(n,17,Sr(!1)),pe(n,16,Ea(.001)),pe(n,95,Sr(!0)),pe(n,42,Sr(!1)),pe(n,43,Sr(!1)),pe(n,130,sn(1)),pe(n,128,W8()),pe(n,131,Sr(!1)),pe(n,132,Sr(!1)),u&&Y7(n,s["!cols"]),pe(n,512,z8(m,e)),u&&(s["!links"]=[]);for(var g=m.s.r;g<=m.e.r;++g){h=lr(g);for(var A=m.s.c;A<=m.e.c;++A){g===m.s.r&&(d[A]=_r(A)),f=d[A]+h;var w=l?(s[g]||[])[A]:s[f];w&&(Q7(n,w,g,A,e),u&&w.l&&s["!links"].push([f,w.l]))}}var x=o.CodeName||o.name||i;return u&&pe(n,574,M8((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&pe(n,229,q8(s["!merges"])),u&&X7(n,s),pe(n,442,iI(x)),u&&K7(n,s),pe(n,10),n.end()}function Z7(t,e,r){var n=Ur(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(pe(n,2057,I1(t,5,r)),r.bookType=="xla"&&pe(n,135),pe(n,225,o?sn(1200):null),pe(n,193,S8(2)),l&&pe(n,191),l&&pe(n,192),pe(n,226),pe(n,92,O8("SheetJS",r)),pe(n,66,sn(o?1200:1252)),o&&pe(n,353,sn(0)),o&&pe(n,448),pe(n,317,eb(t.SheetNames.length)),o&&t.vbaraw&&pe(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";pe(n,442,iI(u))}pe(n,156,sn(17)),pe(n,25,Sr(!1)),pe(n,18,Sr(!1)),pe(n,19,sn(0)),o&&pe(n,431,Sr(!1)),o&&pe(n,444,sn(0)),pe(n,61,b8()),pe(n,64,Sr(!1)),pe(n,141,sn(0)),pe(n,34,Sr(i7(t)=="true")),pe(n,14,Sr(!0)),o&&pe(n,439,Sr(!1)),pe(n,218,sn(0)),$7(n,t,r),G7(n,t.SSF,r),q7(n,r),o&&pe(n,352,Sr(!1));var f=n.end(),h=Ur();o&&pe(h,140,Q8()),o&&r.Strings&&U7(h,252,L8(r.Strings)),pe(h,10);var d=h.end(),m=Ur(),y=0,g=0;for(g=0;g<t.SheetNames.length;++g)y+=(o?12:11)+(o?2:1)*t.SheetNames[g].length;var A=f.length+y+d.length;for(g=0;g<t.SheetNames.length;++g){var w=s[g]||{};pe(m,133,F8({pos:A,hs:w.Hidden||0,dt:0,name:t.SheetNames[g]},r)),A+=e[g].length}var x=m.end();if(y!=x.length)throw new Error("BS8 "+y+" != "+x.length);var I=[];return f.length&&I.push(f),x.length&&I.push(x),d.length&&I.push(d),sr(I)}function eU(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=jr(At)),t&&t.SSF&&(Rd(),Cd(t.SSF),r.revssf=kd(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,D1(r),r.cellXfs=[],Us(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=J7(i,r,t);return n.unshift(Z7(t,n,r)),sr(n)}function NI(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Zr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return eU(t,e);case 4:case 3:case 2:return H7(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function tU(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=tt({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||D5(h.w||(Di(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(de("td",d,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var rU='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nU="</body></html>";function iU(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function DI(t,e){var r=e||{},n=r.header!=null?r.header:rU,i=r.footer!=null?r.footer:nU,s=[n],a=Zr(t["!ref"]);r.dense=Array.isArray(t),s.push(iU(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(tU(t,a,o,r));return s.push("</table>"+i),s.join("")}function OI(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Yt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Zr(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),y=0,g=0,A=0,w=0,x=0,I=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&g<l;++y){var L=o[y];if(Wx(L)){if(n.display)continue;m[g]={hidden:!0}}var W=L.children;for(A=w=0;A<W.length;++A){var G=W[A];if(!(n.display&&Wx(G))){var E=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):b5(G.innerHTML),T=G.getAttribute("data-z")||G.getAttribute("z");for(d=0;d<h.length;++d){var S=h[d];S.s.c==w+s&&S.s.r<g+i&&g+i<=S.e.r&&(w=S.e.c+1-s,d=-1)}I=+G.getAttribute("colspan")||1,((x=+G.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:g+i,c:w+s},e:{r:g+i+(x||1)-1,c:w+s+(I||1)-1}});var R={t:"s",v:E},N=G.getAttribute("data-t")||G.getAttribute("t")||"";E!=null&&(E.length==0?R.t=N||"z":n.raw||E.trim().length==0||N=="s"||(E==="TRUE"?R={t:"b",v:!0}:E==="FALSE"?R={t:"b",v:!1}:isNaN(wi(E))?isNaN(Vu(E).getDate())||(R={t:"d",v:Cr(E)},n.cellDates||(R={t:"n",v:Br(R.v)}),R.z=n.dateNF||At[14]):R={t:"n",v:wi(E)})),R.z===void 0&&T!=null&&(R.z=T);var M="",D=G.getElementsByTagName("A");if(D&&D.length)for(var Re=0;Re<D.length&&!(D[Re].hasAttribute("href")&&(M=D[Re].getAttribute("href"),M.charAt(0)!="#"));++Re);M&&M.charAt(0)!="#"&&(R.l={Target:M}),n.dense?(t[g+i]||(t[g+i]=[]),t[g+i][w+s]=R):t[tt({c:w+s,r:g+i})]=R,u.e.c<w+s&&(u.e.c=w+s),w+=I}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+i),t["!ref"]=Mt(u),g>=l&&(t["!fullref"]=Mt((u.e.r=o.length-y+g-1+i,u))),t}function FI(t,e){var r=e||{},n=r.dense?[]:{};return OI(n,t,e)}function sU(t,e){return Da(FI(t,e),e)}function Wx(t){var e="",r=aU(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function aU(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var oU=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Bu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Vt+e}}(),Hx=function(){var t=function(s){return Ze(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Ze(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,h=Zr(s["!ref"]||"A1"),d=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",A=s["!rows"]||[];for(u=0;u<h.s.r;++u)g=A[u]?' table:style-name="ro'+A[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=A[u]?' table:style-name="ro'+A[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),f=0;f<h.s.c;++f)l.push(e);for(;f<=h.e.c;++f){var w=!1,x={},I="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>f)&&!(d[m].s.r>u)&&!(d[m].e.c<f)&&!(d[m].e.r<u)){(d[m].s.c!=f||d[m].s.r!=u)&&(w=!0),x["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,x["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(w){l.push(r);continue}var L=tt({r:u,c:f}),W=y?(s[u]||[])[f]:s[L];if(W&&W.f&&(x["table:formula"]=Ze(C9(W.f)),W.F&&W.F.slice(0,L.length)==L)){var G=Zr(W.F);x["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,x["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!W){l.push(e);continue}switch(W.t){case"b":I=W.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=W.v?"true":"false";break;case"n":I=W.w||String(W.v||0),x["office:value-type"]="float",x["office:value"]=W.v||0;break;case"s":case"str":I=W.v==null?"":W.v,x["office:value-type"]="string";break;case"d":I=W.w||Cr(W.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Cr(W.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(e);continue}var E=t(I);if(W.l&&W.l.Target){var T=W.l.Target;T=T.charAt(0)=="#"?"#"+R9(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),E=de("text:a",E,{"xlink:href":T.replace(/&/g,"&amp;")})}l.push("          "+de("table:table-cell",de("text:p",E,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var h=u["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;C1(h),h.ods=o;var d=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var h=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Vt],u=Bu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Bu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(XA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function LI(t,e){if(e.bookType=="fods")return Hx(t,e);var r=g1(),n="",i=[],s=[];return n="mimetype",Me(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Me(r,n,Hx(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Me(r,n,oU(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Me(r,n,Vt+XA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Me(r,n,y8(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Me(r,n,v8(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function lU(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Rn(Uu(t))}function uU(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Ps(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function cU(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function ju(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Qe(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Do(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function jt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=ju(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=ju(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function er(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Qe(n*8+i.type)),i.type==2&&e.push(Qe(i.data.length)),e.push(i.data))})}),Ps(e)}function Tn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=ju(t,n),s=jt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Do(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=jt(o.data),u=Do(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Do(s[3][0].data)>>>0>0),r.push(a)}return r}function Ya(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Qe(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Qe(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Qe(a.data.length)}],n[2].push({data:er(a.meta),type:2})});var s=er(n);e.push(Qe(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Ps(e)}function fU(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ju(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ps(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=Ps(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Sn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(fU(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ps(e)}function Qa(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Qe(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Ps(e)}function z0(t,e){var r=new Uint8Array(32),n=bh(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,cU(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function W0(t,e){var r=new Uint8Array(32),n=bh(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Ki(t){var e=jt(t);return ju(e[1][0].data)}function hU(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Do(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=bh(t[7][0].data),f=0,h=[],d=bh(t[4][0].data),m=0,y=[],g=0;g<e.length;++g){if(e[g]==null){u.setUint16(g*2,65535,!0),d.setUint16(g*2,65535);continue}u.setUint16(g*2,f,!0),d.setUint16(g*2,m,!0);var A,w;switch(typeof e[g]){case"string":A=z0({t:"s",v:e[g]},r),w=W0({t:"s",v:e[g]},r);break;case"number":A=z0({t:"n",v:e[g]},r),w=W0({t:"n",v:e[g]},r);break;case"boolean":A=z0({t:"b",v:e[g]},r),w=W0({t:"b",v:e[g]},r);break;default:throw new Error("Unsupported value "+e[g])}h.push(A),f+=A.length,y.push(w),m+=w.length,++l}for(t[2][0].data=Qe(l);g<t[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),d.setUint16(g*2,65535,!0);return t[6][0].data=Ps(h),t[3][0].data=Ps(y),l}function dU(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Zr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Mt(n)));var s=Mh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(B){typeof B=="string"&&a.push(B)})});var o={},l=[],u=rt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(z,B){return[z,u.FullPaths[B]]}).forEach(function(z){var B=z[0],j=z[1];if(B.type==2&&B.name.match(/\.iwa/)){var re=B.content,ye=Sn(re),Ae=Tn(ye);Ae.forEach(function(Te){l.push(Te.id),o[Te.id]={deps:[],location:j,type:Do(Te.messages[0].meta[1][0].data)}})}}),l.sort(function(z,B){return z-B});var f=l.filter(function(z){return z>1}).map(function(z){return[z,Qe(z)]});u.FileIndex.map(function(z,B){return[z,u.FullPaths[B]]}).forEach(function(z){var B=z[0];if(z[1],!!B.name.match(/\.iwa/)){var j=Tn(Sn(B.content));j.forEach(function(re){re.messages.forEach(function(ye){f.forEach(function(Ae){re.messages.some(function(Te){return Do(Te.meta[1][0].data)!=11006&&uU(Te.data,Ae[1])})&&o[Ae[0]].deps.push(re.id)})})})}});for(var h=rt.find(u,o[1].location),d=Tn(Sn(h.content)),m,y=0;y<d.length;++y){var g=d[y];g.id==1&&(m=g)}var A=Ki(jt(m.messages[0].data)[1][0].data);for(h=rt.find(u,o[A].location),d=Tn(Sn(h.content)),y=0;y<d.length;++y)g=d[y],g.id==A&&(m=g);for(A=Ki(jt(m.messages[0].data)[2][0].data),h=rt.find(u,o[A].location),d=Tn(Sn(h.content)),y=0;y<d.length;++y)g=d[y],g.id==A&&(m=g);for(A=Ki(jt(m.messages[0].data)[2][0].data),h=rt.find(u,o[A].location),d=Tn(Sn(h.content)),y=0;y<d.length;++y)g=d[y],g.id==A&&(m=g);var w=jt(m.messages[0].data);{w[6][0].data=Qe(n.e.r+1),w[7][0].data=Qe(n.e.c+1);var x=Ki(w[46][0].data),I=rt.find(u,o[x].location),L=Tn(Sn(I.content));{for(var W=0;W<L.length&&L[W].id!=x;++W);if(L[W].id!=x)throw"Bad ColumnRowUIDMapArchive";var G=jt(L[W].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var E=0;E<=n.e.c;++E){var T=[];T[1]=T[2]=[{type:0,data:Qe(E+420690)}],G[1].push({type:2,data:er(T)}),G[2].push({type:0,data:Qe(E)}),G[3].push({type:0,data:Qe(E)})}G[4]=[],G[5]=[],G[6]=[];for(var S=0;S<=n.e.r;++S)T=[],T[1]=T[2]=[{type:0,data:Qe(S+726270)}],G[4].push({type:2,data:er(T)}),G[5].push({type:0,data:Qe(S)}),G[6].push({type:0,data:Qe(S)});L[W].messages[0].data=er(G)}I.content=Qa(Ya(L)),I.size=I.content.length,delete w[46];var R=jt(w[4][0].data);{R[7][0].data=Qe(n.e.r+1);var N=jt(R[1][0].data),M=Ki(N[2][0].data);I=rt.find(u,o[M].location),L=Tn(Sn(I.content));{if(L[0].id!=M)throw"Bad HeaderStorageBucket";var D=jt(L[0].messages[0].data);for(S=0;S<s.length;++S){var Re=jt(D[2][0].data);Re[1][0].data=Qe(S),Re[4][0].data=Qe(s[S].length),D[2][S]={type:D[2][0].type,data:er(Re)}}L[0].messages[0].data=er(D)}I.content=Qa(Ya(L)),I.size=I.content.length;var Ie=Ki(R[2][0].data);I=rt.find(u,o[Ie].location),L=Tn(Sn(I.content));{if(L[0].id!=Ie)throw"Bad HeaderStorageBucket";for(D=jt(L[0].messages[0].data),E=0;E<=n.e.c;++E)Re=jt(D[2][0].data),Re[1][0].data=Qe(E),Re[4][0].data=Qe(n.e.r+1),D[2][E]={type:D[2][0].type,data:er(Re)};L[0].messages[0].data=er(D)}I.content=Qa(Ya(L)),I.size=I.content.length;var nt=Ki(R[4][0].data);(function(){for(var z=rt.find(u,o[nt].location),B=Tn(Sn(z.content)),j,re=0;re<B.length;++re){var ye=B[re];ye.id==nt&&(j=ye)}var Ae=jt(j.messages[0].data);{Ae[3]=[];var Te=[];a.forEach(function(ue,it){Te[1]=[{type:0,data:Qe(it)}],Te[2]=[{type:0,data:Qe(1)}],Te[3]=[{type:2,data:lU(ue)}],Ae[3].push({type:2,data:er(Te)})})}j.messages[0].data=er(Ae);var ve=Ya(B),$e=Qa(ve);z.content=$e,z.size=z.content.length})();var Ke=jt(R[3][0].data);{var he=Ke[1][0];delete Ke[2];var J=jt(he.data);{var te=Ki(J[2][0].data);(function(){for(var z=rt.find(u,o[te].location),B=Tn(Sn(z.content)),j,re=0;re<B.length;++re){var ye=B[re];ye.id==te&&(j=ye)}var Ae=jt(j.messages[0].data);{delete Ae[6],delete Ke[7];var Te=new Uint8Array(Ae[5][0].data);Ae[5]=[];for(var ve=0,$e=0;$e<=n.e.r;++$e){var ue=jt(Te);ve+=hU(ue,s[$e],a),ue[1][0].data=Qe($e),Ae[5].push({data:er(ue),type:2})}Ae[1]=[{type:0,data:Qe(n.e.c+1)}],Ae[2]=[{type:0,data:Qe(n.e.r+1)}],Ae[3]=[{type:0,data:Qe(ve)}],Ae[4]=[{type:0,data:Qe(n.e.r+1)}]}j.messages[0].data=er(Ae);var it=Ya(B),Ve=Qa(it);z.content=Ve,z.size=z.content.length})()}he.data=er(J)}R[3][0].data=er(Ke)}w[4][0].data=er(R)}m.messages[0].data=er(w);var ce=Ya(d),V=Qa(ce);return h.content=V,h.size=h.content.length,u}function pU(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function D1(t){pU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function mU(t,e){return e.bookType=="ods"?LI(t,e):e.bookType=="numbers"?dU(t,e):e.bookType=="xlsb"?gU(t,e):vU(t,e)}function gU(t,e){vo=1024,t&&!t.SSF&&(t.SSF=jr(At)),t&&t.SSF&&(Rd(),Cd(t.SSF),e.revssf=kd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ou?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=vI.indexOf(e.bookType)>-1,i=GA();D1(e=e||{});var s=g1(),a="",o=0;if(e.cellXfs=[],Us(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Me(s,a,YA(t.Props,e)),i.coreprops.push(a),Je(e.rels,2,a,Ge.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Me(s,a,JA(t.Props)),i.extprops.push(a),Je(e.rels,3,a,Ge.EXT_PROPS),t.Custprops!==t.Props&&fr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Me(s,a,ZA(t.Custprops)),i.custprops.push(a),Je(e.rels,4,a,Ge.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Me(s,a,y7(o-1,a,e,t,f)),i.sheets.push(a),Je(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(h){var m=h["!comments"],y=!1,g="";m&&m.length>0&&(g="xl/comments"+o+"."+r,Me(s,g,E7(m,g)),i.comments.push(g),Je(f,-1,"../comments"+o+"."+r,Ge.CMNT),y=!0),h["!legacy"]&&y&&Me(s,"xl/drawings/vmlDrawing"+o+".vml",mI(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Me(s,qA(a),Po(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Me(s,a,w7(e.Strings,a,e)),i.strs.push(a),Je(e.wbrels,-1,"sharedStrings."+r,Ge.SST)),a="xl/workbook."+r,Me(s,a,_7(t,a)),i.workbooks.push(a),Je(e.rels,1,a,Ge.WB),a="xl/theme/theme1.xml",Me(s,a,dI(t.Themes,e)),i.themes.push(a),Je(e.wbrels,-1,"theme/theme1.xml",Ge.THEME),a="xl/styles."+r,Me(s,a,x7(t,a,e)),i.styles.push(a),Je(e.wbrels,-1,"styles."+r,Ge.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Me(s,a,t.vbaraw),i.vba.push(a),Je(e.wbrels,-1,"vbaProject.bin",Ge.VBA)),a="xl/metadata."+r,Me(s,a,T7(a)),i.metadata.push(a),Je(e.wbrels,-1,"metadata."+r,Ge.XLMETA),Me(s,"[Content_Types].xml",KA(i,e)),Me(s,"_rels/.rels",Po(e.rels)),Me(s,"xl/_rels/workbook."+r+".rels",Po(e.wbrels)),delete e.revssf,delete e.ssf,s}function vU(t,e){vo=1024,t&&!t.SSF&&(t.SSF=jr(At)),t&&t.SSF&&(Rd(),Cd(t.SSF),e.revssf=kd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ou?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=vI.indexOf(e.bookType)>-1,i=GA();D1(e=e||{});var s=g1(),a="",o=0;if(e.cellXfs=[],Us(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Me(s,a,YA(t.Props,e)),i.coreprops.push(a),Je(e.rels,2,a,Ge.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Me(s,a,JA(t.Props)),i.extprops.push(a),Je(e.rels,3,a,Ge.EXT_PROPS),t.Custprops!==t.Props&&fr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Me(s,a,ZA(t.Custprops)),i.custprops.push(a),Je(e.rels,4,a,Ge.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Me(s,a,II(o-1,e,t,h)),i.sheets.push(a),Je(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(d){var y=d["!comments"],g=!1,A="";if(y&&y.length>0){var w=!1;y.forEach(function(x){x[1].forEach(function(I){I.T==!0&&(w=!0)})}),w&&(A="xl/threadedComments/threadedComment"+o+"."+r,Me(s,A,qb(y,f,e)),i.threadedcomments.push(A),Je(h,-1,"../threadedComments/threadedComment"+o+"."+r,Ge.TCMNT)),A="xl/comments"+o+"."+r,Me(s,A,gI(y)),i.comments.push(A),Je(h,-1,"../comments"+o+"."+r,Ge.CMNT),g=!0}d["!legacy"]&&g&&Me(s,"xl/drawings/vmlDrawing"+o+".vml",mI(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Me(s,qA(a),Po(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Me(s,a,oI(e.Strings,e)),i.strs.push(a),Je(e.wbrels,-1,"sharedStrings."+r,Ge.SST)),a="xl/workbook."+r,Me(s,a,kI(t)),i.workbooks.push(a),Je(e.rels,1,a,Ge.WB),a="xl/theme/theme1.xml",Me(s,a,dI(t.Themes,e)),i.themes.push(a),Je(e.wbrels,-1,"theme/theme1.xml",Ge.THEME),a="xl/styles."+r,Me(s,a,fI(t,e)),i.styles.push(a),Je(e.wbrels,-1,"styles."+r,Ge.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Me(s,a,t.vbaraw),i.vba.push(a),Je(e.wbrels,-1,"vbaProject.bin",Ge.VBA)),a="xl/metadata."+r,Me(s,a,pI()),i.metadata.push(a),Je(e.wbrels,-1,"metadata."+r,Ge.XLMETA),f.length>1&&(a="xl/persons/person.xml",Me(s,a,Xb(f)),i.people.push(a),Je(e.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),Me(s,"[Content_Types].xml",KA(i,e)),Me(s,"_rels/.rels",Po(e.rels)),Me(s,"xl/_rels/workbook."+r+".rels",Po(e.wbrels)),delete e.revssf,delete e.ssf,s}function _U(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ni(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function bI(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return lc(e.file,rt.write(t,{type:qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return rt.write(t,e)}function yU(t,e){var r=jr(e||{}),n=mU(t,r);return xU(n,r)}function xU(t,e){var r={},n=qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?rt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Id(i))}return e.password&&typeof encrypt_agile<"u"?bI(encrypt_agile(i,e.password),e):e.type==="file"?lc(e.file,i):e.type=="string"?nu(i):i}function wU(t,e){var r=e||{},n=M7(t,r);return bI(n,r)}function $n(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Mu(Uu(n));case"binary":return Uu(n);case"string":return t;case"file":return lc(e.file,n,"utf8");case"buffer":return qe?Li(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$n(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function EU(t,e){switch(e.type){case"base64":return Mu(t);case"binary":return t;case"string":return t;case"file":return lc(e.file,t,"binary");case"buffer":return qe?Li(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function of(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Mu(r):e.type=="string"?nu(r):r;case"file":return lc(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function MI(t,e){YL(),o7(t);var r=jr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=MI(t,r);return r.type="array",Id(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $n(L7(t,r),r);case"slk":case"sylk":return $n(ib.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return $n(DI(t.Sheets[t.SheetNames[i]],r),r);case"txt":return EU(VI(t.Sheets[t.SheetNames[i]],r),r);case"csv":return $n(O1(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return $n(sb.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return of(nb.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return $n(ab.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return $n(db.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return $n(aI.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return $n(LI(t,r),r);case"wk1":return of(Mx.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return of(Mx.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),of(NI(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),wU(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return yU(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function TU(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function $x(t,e,r){var n=r||{};return n.type="file",n.file=e,TU(n),MI(t,n)}function SU(t,e,r,n,i,s,a,o){var l=lr(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(d[s[m]]=u);continue}var g=y.v;switch(y.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(g==null)if(y.t=="e"&&g===null)d[s[m]]=null;else if(u!==void 0)d[s[m]]=u;else if(f&&g===null)d[s[m]]=null;else continue;else d[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?g:Di(y,g,o);g!=null&&(h=!1)}}return{row:d,isempty:h}}function Mh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=mt(f);break;case"number":l=mt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var h=lr(l.s.r),d=[],m=[],y=0,g=0,A=Array.isArray(t),w=l.s.r,x=0,I={};A&&!t[w]&&(t[w]=[]);var L=u.skipHidden&&t["!cols"]||[],W=u.skipHidden&&t["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(L[x]||{}).hidden)switch(d[x]=_r(x),r=A?t[w][x]:t[d[x]+h],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=d[x];break;case 3:s[x]=u.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Di(r,null,u),g=I[a]||0,!g)I[a]=1;else{do o=a+"_"+g++;while(I[o]);I[a]=g,I[o]=1}s[x]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(W[w]||{}).hidden){var G=SU(t,l,w,d,n,s,A,u);(G.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=G.row)}return m.length=y,m}var Gx=/"/g;function AU(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",h=lr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Di(m,null,o));for(var y=0,g=0;y!==f.length;++y)if((g=f.charCodeAt(y))===i||g===s||g===34||o.forceQuotes){f='"'+f.replace(Gx,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(Gx,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function O1(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=mt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(d[y]||{}).hidden||(h[y]=_r(y));for(var g=0,A=i.s.r;A<=i.e.r;++A)(m[A]||{}).hidden||(f=AU(t,i,A,h,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function VI(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=O1(t,e);return r}function IU(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=mt(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=_r(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=lr(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function UI(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Yt(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=mt(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],m=0;e.forEach(function(g,A){fr(g).forEach(function(w){(m=d.indexOf(w))==-1&&(d[m=d.length]=w);var x=g[w],I="z",L="",W=tt({c:o+m,r:a+A+i});u=zu(s,W),x&&typeof x=="object"&&!(x instanceof Date)?s[W]=x:(typeof x=="number"?I="n":typeof x=="boolean"?I="b":typeof x=="string"?I="s":x instanceof Date?(I="d",n.cellDates||(I="n",x=Br(x)),L=n.dateNF||At[14]):x===null&&n.nullError&&(I="e",x=0),u?(u.t=I,u.v=x,delete u.w,delete u.R,L&&(u.z=L)):s[W]=u={t:I,v:x},L&&(u.z=L))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var y=lr(a);if(i)for(m=0;m<d.length;++m)s[_r(m+o)+y]={t:"s",v:d[m]};return s["!ref"]=Mt(f),s}function CU(t,e){return UI(null,t,e)}function zu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Yt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?zu(t,tt(e)):zu(t,tt({r:e,c:r||0}))}function RU(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function kU(){return{SheetNames:[],Sheets:{}}}function PU(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(RI(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function NU(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=RU(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function DU(t,e){return t.z=e,t}function BI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function OU(t,e,r){return BI(t,"#"+e,r)}function FU(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function LU(t,e,r,n){for(var i=typeof e!="string"?e:mt(e),s=typeof e=="string"?e:Mt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=zu(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Ja={encode_col:_r,encode_row:lr,encode_cell:tt,encode_range:Mt,decode_col:E1,decode_row:w1,split_cell:Y5,decode_cell:Yt,decode_range:Zr,format_cell:Di,sheet_add_aoa:BA,sheet_add_json:UI,sheet_add_dom:OI,aoa_to_sheet:il,json_to_sheet:CU,table_to_sheet:FI,table_to_book:sU,sheet_to_csv:O1,sheet_to_txt:VI,sheet_to_json:Mh,sheet_to_html:DI,sheet_to_formulae:IU,sheet_to_row_object_array:Mh,sheet_get_cell:zu,book_new:kU,book_append_sheet:PU,book_set_sheet_visibility:NU,cell_set_number_format:DU,cell_set_hyperlink:BI,cell_set_internal_link:OU,cell_add_comment:FU,sheet_set_array_formula:LU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Kx={exportToExcel:(t,e="submissions")=>{const r=t.map(l=>({"-":l.studentName,:l.studentId,:l.grade,:l.subjectCode,:l.subjectName,:l.type,"-":l.gradeYear,:new Date(l.date).toLocaleDateString("th-TH"),:l.status,:new Date(l.submittedAt).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),:l.completedAt?new Date(l.completedAt).toLocaleDateString("th-TH"):"-",:l.adminNote||"-"})),n=Ja.json_to_sheet(r),i=[{wch:20},{wch:15},{wch:10},{wch:12},{wch:25},{wch:10},{wch:20},{wch:15},{wch:12},{wch:25},{wch:15},{wch:30}];n["!cols"]=i;const s=Ja.book_new();Ja.book_append_sheet(s,n,"");const a=new Date().toISOString().split("T")[0],o=`${e}_${a}.xlsx`;$x(s,o)},exportToCSV:(t,e="submissions")=>{const r=t.map(o=>({"-":o.studentName,:o.studentId,:o.grade,:o.subjectCode,:o.subjectName,:o.type,"-":o.gradeYear,:new Date(o.date).toLocaleDateString("th-TH"),:o.status,:new Date(o.submittedAt).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),:o.completedAt?new Date(o.completedAt).toLocaleDateString("th-TH"):"-",:o.adminNote||"-"})),n=Ja.json_to_sheet(r),i=Ja.book_new();Ja.book_append_sheet(i,n,"");const s=new Date().toISOString().split("T")[0],a=`${e}_${s}.csv`;$x(i,a,{bookType:"csv"})}},bU=new di,MU=async()=>{try{const e=(await A6(ac,bU)).user;return{uid:e.uid,email:e.email,name:e.displayName,photoURL:e.photoURL,emailVerified:e.emailVerified}}catch(t){throw console.error("Google Sign-In Error:",t),t}},VU=async(t,e,r)=>{try{const i=(await JF(ac,t,e)).user;return await t6(i,{displayName:r}),{uid:i.uid,email:i.email,name:r,photoURL:null,emailVerified:i.emailVerified}}catch(n){throw console.error("Email Registration Error:",n),n}},UU=async(t,e)=>{try{const n=(await ZF(ac,t,e)).user;return{uid:n.uid,email:n.email,name:n.displayName,photoURL:n.photoURL,emailVerified:n.emailVerified}}catch(r){throw console.error("Email Login Error:",r),r}},BU=async()=>{try{await s6(ac)}catch(t){throw console.error("Sign Out Error:",t),t}},jU=t=>i6(ac,e=>{t(e?{uid:e.uid,email:e.email,name:e.displayName,photoURL:e.photoURL,emailVerified:e.emailVerified}:null)}),kl={signInWithGoogle:MU,registerWithEmail:VU,loginWithEmail:UU,signOutUser:BU,onAuthStateChange:jU};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WU=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),It=(t,e)=>{const r=ke.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ke.createElement("svg",{ref:f,...zU,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${WU(t)}`,o].join(" "),...u},[...e.map(([h,d])=>ke.createElement(h,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HU=It("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=It("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=It("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=It("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=It("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=It("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=It("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=It("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qU=It("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=It("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F1=It("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=It("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=It("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=It("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=It("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XU=It("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YU=It("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=It("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=It("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=It("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=It("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=It("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),QU=({currentUser:t,onNavigateToProfile:e})=>v.jsxs("header",{style:{backgroundColor:"white",padding:"15px 20px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.jsx("div",{style:{width:"32px",height:"32px",backgroundColor:"#4CAF50",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold"},children:"R+"}),v.jsxs("div",{children:[v.jsx("h1",{style:{fontSize:"20px",fontWeight:"bold",color:"#333",margin:0},children:"RegradePlus"}),v.jsx("p",{style:{fontSize:"12px",color:"#7f8c8d",margin:"2px 0 0 0"},children:"  & "})]})]}),t&&e&&v.jsxs("button",{onClick:e,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"white",border:"1px solid var(--border-color)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.backgroundColor="#f8f9fa",onMouseLeave:r=>r.target.style.backgroundColor="white",children:[v.jsx("div",{style:{width:"32px",height:"32px",backgroundColor:"#4CAF50",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:v.jsx(HI,{size:18})}),v.jsxs("div",{style:{textAlign:"left"},children:[v.jsx("div",{style:{fontSize:"14px",fontWeight:"500",color:"var(--text-primary)"},children:t.name}),v.jsx("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:t.isAdmin?"Admin":"Student"})]})]})]}),JU=({image:t,onClose:e})=>t?v.jsx("div",{className:"image-viewer-overlay",onClick:e,children:v.jsxs("div",{className:"image-viewer-content",onClick:r=>r.stopPropagation(),children:[v.jsx("img",{src:t,alt:"Full view",className:"image-viewer-img"}),v.jsx("button",{onClick:e,className:"image-viewer-close",type:"button",children:""})]})}):null,ZU=({popup:t,onClose:e})=>t.show?v.jsx("div",{className:"popup-container",children:v.jsxs("div",{className:`popup-content ${t.type==="error"?"error":""}`,children:[t.type==="success"?v.jsx(GU,{size:24}):v.jsx(HU,{size:24}),v.jsx("div",{style:{flex:1,fontSize:"15px",fontWeight:"500"},children:t.message}),v.jsx("button",{onClick:e,className:"popup-close-btn",type:"button",children:v.jsx($I,{size:20})})]})}):null,eB=({show:t,onConfirm:e,onCancel:r})=>t?v.jsx("div",{className:"modal-overlay",onClick:r,children:v.jsxs("div",{className:"modal-content",style:{maxWidth:"400px"},onClick:n=>n.stopPropagation(),children:[v.jsx("h3",{style:{marginTop:0,color:"var(--text-primary)"},children:""}),v.jsx("p",{style:{margin:"15px 0",color:"var(--text-secondary)"},children:"?"}),v.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[v.jsx("button",{onClick:e,className:"btn btn-danger",style:{flex:1},children:""}),v.jsx("button",{onClick:r,className:"btn btn-secondary",style:{flex:1},children:""})]})]})}):null,tB=({onLogin:t,onRegister:e,onGoogleSignIn:r})=>{const[n,i]=ke.useState(!1),[s,a]=ke.useState({email:"",password:"",name:"",adminCode:""}),[o,l]=ke.useState(!1),[u,f]=ke.useState(!1),[h,d]=ke.useState(!1),m=y=>{y.preventDefault(),n?e(s):t(s.email,s.password)};return v.jsx("div",{className:"login-container",children:v.jsxs("div",{className:"form-container",children:[v.jsxs("div",{className:"text-center",style:{marginBottom:"30px"},children:[v.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:"28px",color:"var(--text-primary)"},children:n?"":""}),v.jsx("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"14px"},children:n?"":""})]}),v.jsxs("form",{onSubmit:m,children:[n&&v.jsxs("div",{className:"form-group",style:{animation:"fadeIn 0.3s ease-out"},children:[v.jsx("label",{className:"form-label",children:"-"}),v.jsx("input",{type:"text",value:s.name,onChange:y=>a({...s,name:y.target.value}),required:!0,className:"form-input"})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:"Email"}),v.jsx("input",{type:"email",value:s.email,onChange:y=>a({...s,email:y.target.value}),placeholder:"yourname@taweethapisek.ac.th",required:!0,className:"form-input"})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:"Password"}),v.jsxs("div",{style:{position:"relative"},children:[v.jsx("input",{type:u?"text":"password",value:s.password,onChange:y=>a({...s,password:y.target.value}),required:!0,className:"form-input",style:{paddingRight:"45px"}}),v.jsx("button",{type:"button",onClick:()=>f(!u),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-secondary)",padding:"4px",display:"flex",alignItems:"center"},children:u?v.jsx(lu,{size:18}):v.jsx(uu,{size:18})})]})]}),n&&v.jsxs("div",{className:"form-group",style:{animation:"fadeIn 0.3s ease-out"},children:[v.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"12px",backgroundColor:"#f8f9fa",borderRadius:"8px",transition:"all 0.3s"},children:[v.jsx("input",{type:"checkbox",checked:o,onChange:y=>l(y.target.checked),style:{marginRight:"10px",width:"18px",height:"18px",cursor:"pointer"}}),v.jsx("span",{style:{fontSize:"14px",color:"var(--text-primary)",fontWeight:"500"},children:" Admin ( Admin)"})]}),o&&v.jsxs("div",{style:{marginTop:"12px",animation:"fadeIn 0.3s ease-out"},children:[v.jsx("label",{className:"form-label",children:" Admin"}),v.jsxs("div",{style:{position:"relative"},children:[v.jsx("input",{type:h?"text":"password",value:s.adminCode,onChange:y=>a({...s,adminCode:y.target.value}),placeholder:" Admin",className:"form-input",style:{paddingRight:"45px"}}),v.jsx("button",{type:"button",onClick:()=>d(!h),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-secondary)",padding:"4px",display:"flex",alignItems:"center"},children:h?v.jsx(lu,{size:18}):v.jsx(uu,{size:18})})]})]})]}),v.jsx("button",{type:"submit",className:"btn btn-primary btn-full",style:{marginTop:"10px"},children:n?"":""})]}),!n&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"24px 0",gap:"12px"},children:[v.jsx("div",{style:{flex:1,height:"1px",backgroundColor:"var(--border-color)"}}),v.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"14px",fontWeight:"500"},children:""}),v.jsx("div",{style:{flex:1,height:"1px",backgroundColor:"var(--border-color)"}})]}),v.jsxs("button",{type:"button",onClick:r,className:"btn btn-full",style:{backgroundColor:"white",color:"#333",border:"1px solid var(--border-color)",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",fontWeight:"500",transition:"all 0.3s"},onMouseEnter:y=>{y.target.style.backgroundColor="#f8f9fa",y.target.style.borderColor="#999"},onMouseLeave:y=>{y.target.style.backgroundColor="white",y.target.style.borderColor="var(--border-color)"},children:[v.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 18 18",xmlns:"http://www.w3.org/2000/svg",children:[v.jsx("path",{d:"M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z",fill:"#4285F4"}),v.jsx("path",{d:"M9.003 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332C2.44 15.983 5.485 18 9.003 18z",fill:"#34A853"}),v.jsx("path",{d:"M3.964 10.712c-.18-.54-.282-1.117-.282-1.71 0-.593.102-1.17.282-1.71V4.96H.957C.347 6.175 0 7.55 0 9.002c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05"}),v.jsx("path",{d:"M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.426 0 9.003 0 5.485 0 2.44 2.017.96 4.958L3.967 7.29c.708-2.127 2.692-3.71 5.036-3.71z",fill:"#EA4335"})]})," Google"]})]}),v.jsxs("div",{className:"text-center",style:{marginTop:"24px",padding:"20px 0",borderTop:"1px solid var(--border-color)"},children:[v.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:n?"?":"?"}),v.jsx("button",{onClick:()=>{i(!n),a({email:"",password:"",name:"",adminCode:""}),l(!1),f(!1),d(!1)},className:"btn-outline",type:"button",children:n?"":""})]})]})})},rB=({onSubmit:t,onNavigate:e,currentUser:r,onLogout:n})=>{const[i,s]=ke.useState({studentName:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",grade:"",studentId:"",subjectCode:"",subjectName:"",type:"",gradeYear:"",images:[]}),[a,o]=ke.useState(!1),l=f=>{const h=Array.from(f).filter(d=>d.type.startsWith("image/"));Promise.all(h.map(d=>new Promise(m=>{const y=new FileReader;y.onload=g=>m(g.target.result),y.readAsDataURL(d)}))).then(d=>s({...i,images:[...i.images,...d]}))},u=f=>{f.preventDefault(),t(i),s({studentName:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",grade:"",studentId:"",subjectCode:"",subjectName:"",type:"",gradeYear:"",images:[]})};return v.jsxs("div",{style:{maxWidth:"900px",margin:"20px auto",padding:"20px"},children:[v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[v.jsx("h2",{children:""}),v.jsxs("div",{children:[v.jsxs("button",{onClick:()=>e("history"),className:"btn btn-secondary btn-animate",style:{marginRight:"10px"},children:[v.jsx(WI,{size:16})," "]}),v.jsxs("button",{onClick:n,className:"btn btn-danger",type:"button",children:[v.jsx(F1,{size:16})," "]})]})]}),v.jsxs("form",{onSubmit:u,style:{backgroundColor:"white",padding:"30px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.05)"},children:[v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"-: *"}),v.jsx("input",{type:"text",value:i.studentName,onChange:f=>s({...i,studentName:f.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"}})]}),v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsx("input",{type:"email",value:i.email,disabled:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f5f5f5",color:"#666",cursor:"not-allowed"}})]})]}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsx("input",{type:"text",value:i.grade,onChange:f=>s({...i,grade:f.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"}})]}),v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsx("input",{type:"text",value:i.studentId,onChange:f=>s({...i,studentId:f.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"}})]})]}),v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsx("input",{type:"text",value:i.subjectCode,onChange:f=>s({...i,subjectCode:f.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"}})]}),v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsx("input",{type:"text",value:i.subjectName,onChange:f=>s({...i,subjectName:f.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"}})]}),v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsxs("select",{value:i.type,onChange:f=>s({...i,type:f.target.value}),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"},children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:".",children:"."}),v.jsx("option",{value:".",children:"."}),v.jsx("option",{value:".",children:"."})]})]}),v.jsxs("div",{children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"-- ( .4/5 1/2567): *"}),v.jsx("input",{type:"text",value:i.gradeYear,onChange:f=>s({...i,gradeYear:f.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px"}})]}),v.jsxs("div",{style:{marginTop:"20px"},children:[v.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:": *"}),v.jsxs("div",{onDragOver:f=>{f.preventDefault(),o(!0)},onDragLeave:f=>{f.preventDefault(),o(!1)},onDrop:f=>{f.preventDefault(),o(!1),l(f.dataTransfer.files)},style:{border:`2px dashed ${a?"var(--primary-green)":"var(--border-color)"}`,borderRadius:"8px",padding:"40px",textAlign:"center",backgroundColor:a?"var(--primary-green-light)":"transparent",cursor:"pointer",marginBottom:"15px"},onClick:()=>document.getElementById("file-upload").click(),children:[v.jsx(Yx,{size:48,style:{margin:"0 auto 15px",color:"var(--primary-green)",opacity:.6}}),v.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"10px"},children:a?"":" "}),v.jsx("input",{id:"file-upload",type:"file",multiple:!0,accept:"image/*",onChange:f=>l(f.target.files),style:{display:"none"}})]}),i.images.length>0&&v.jsx("div",{style:{marginTop:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"10px"},children:i.images.map((f,h)=>v.jsxs("div",{style:{position:"relative"},children:[v.jsx("img",{src:f,alt:`preview ${h}`,style:{width:"100%",height:"120px",objectFit:"cover",border:"2px solid var(--border-color)",borderRadius:"4px"}}),v.jsx("button",{type:"button",onClick:d=>{d.stopPropagation(),s({...i,images:i.images.filter((m,y)=>y!==h)})},style:{position:"absolute",top:"5px",right:"5px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"50%",width:"25px",height:"25px",cursor:"pointer"},children:""})]},h))})]}),v.jsxs("button",{type:"submit",style:{marginTop:"25px",padding:"12px 20px",backgroundColor:"#4CAF50",color:"white",border:"none",cursor:"pointer",width:"100%",borderRadius:"4px",fontWeight:"bold",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[v.jsx(Yx,{size:18})," "]})]})]})},nB=({submissions:t,onNavigate:e,onLogout:r,onViewImage:n})=>{const[i,s]=ke.useState(""),[a,o]=ke.useState("subject"),[l,u]=ke.useState({}),[f,h]=ke.useState("all"),[d,m]=ke.useState("date-desc");let y=t.filter(w=>!(i&&(a==="subject"&&!w.subjectName.toLowerCase().includes(i.toLowerCase())||a==="code"&&!w.subjectCode.toLowerCase().includes(i.toLowerCase()))||f!=="all"&&w.status!==f));y=y.sort((w,x)=>d==="date-desc"?new Date(x.submittedAt)-new Date(w.submittedAt):d==="date-asc"?new Date(w.submittedAt)-new Date(x.submittedAt):d==="subject"?w.subjectName.localeCompare(x.subjectName,"th"):0);const g=w=>u(x=>({...x,[w]:!x[w]})),A=w=>w===""?"status-completed":w===""?"status-checking":"status-pending";return v.jsxs("div",{style:{maxWidth:"1400px",margin:"20px auto",padding:"20px 30px"},children:[v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[v.jsxs("h2",{className:"page-title",children:[" (",y.length," )"]}),v.jsxs("div",{style:{display:"flex",gap:"10px"},children:[v.jsx("button",{onClick:()=>e("submit"),className:"btn btn-primary",children:""}),v.jsxs("button",{onClick:r,className:"btn btn-danger",type:"button",children:[v.jsx(F1,{size:16})," "]})]})]}),v.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",flexWrap:"wrap",alignItems:"center"},children:[v.jsxs("select",{value:a,onChange:w=>o(w.target.value),className:"form-select",style:{width:"auto",minWidth:"150px"},children:[v.jsx("option",{value:"subject",children:""}),v.jsx("option",{value:"code",children:""})]}),v.jsx("div",{className:"search-input-wrapper",style:{flex:1,minWidth:"200px"},children:v.jsx("input",{type:"text",placeholder:`${a==="subject"?"":""}...`,value:i,onChange:w=>s(w.target.value),className:"search-input"})})]}),y.length===0?v.jsx("div",{className:"empty-state",children:v.jsx("p",{className:"empty-state-text",children:i||f!=="all"?"":""})}):v.jsx("div",{style:{display:"grid",gap:"15px"},children:y.map(w=>{var x;return v.jsxs("div",{className:"card card-border",children:[v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[v.jsxs("div",{style:{flex:1},children:[v.jsxs("h3",{style:{margin:"0 0 10px 0",fontSize:"18px",color:"var(--text-primary)"},children:[w.subjectName," (",w.subjectCode,")"]}),v.jsxs("p",{style:{margin:"5px 0",color:"var(--text-secondary)"},children:[" ",w.type," |  ",new Date(w.submittedAt).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),w.completedAt&&v.jsxs("p",{style:{margin:"5px 0",color:"#4CAF50",fontWeight:"500"},children:["  ",new Date(w.completedAt).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),v.jsx("div",{className:`status-badge ${A(w.status)}`,style:{padding:"8px 16px"},children:w.status})]}),w.adminNote&&v.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#f0f9ff",borderLeft:"3px solid #4CAF50",borderRadius:"6px"},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px"},children:[v.jsx(zI,{size:16,style:{color:"#4CAF50"}}),v.jsx("strong",{style:{color:"#4CAF50",fontSize:"14px"},children:":"})]}),v.jsx("p",{style:{margin:0,color:"var(--text-primary)",fontSize:"14px",lineHeight:"1.5"},children:w.adminNote})]}),w.gradingStatus&&v.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:w.gradingStatus===""?"#f0fdf4":"#fef2f2",borderLeft:`3px solid ${w.gradingStatus===""?"#4CAF50":"#f44336"}`,borderRadius:"6px"},children:[v.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px"},children:v.jsx("span",{style:{display:"inline-block",padding:"4px 10px",borderRadius:"4px",backgroundColor:w.gradingStatus===""?"#4CAF50":"#f44336",color:"white",fontWeight:"bold",fontSize:"13px"},children:w.gradingStatus})}),w.gradingComment&&v.jsx("p",{style:{margin:0,color:"var(--text-primary)",fontSize:"14px",lineHeight:"1.5"},children:w.gradingComment})]}),v.jsx("button",{onClick:I=>{I.stopPropagation(),g(w.id)},className:`detail-toggle ${l[w.id]?"active":""}`,type:"button",children:l[w.id]?" ":" "}),l[w.id]&&v.jsxs("div",{className:"detail-content",children:[v.jsxs("div",{className:"grid-2",style:{marginBottom:"20px"},children:[v.jsxs("div",{children:[v.jsx("strong",{children:":"})," ",w.studentName]}),v.jsxs("div",{children:[v.jsx("strong",{children:":"})," ",w.grade]}),v.jsxs("div",{children:[v.jsx("strong",{children:":"})," ",w.studentId]}),v.jsxs("div",{children:[v.jsx("strong",{children:":"})," ",w.subjectCode]}),v.jsxs("div",{style:{gridColumn:"1 / -1"},children:[v.jsx("strong",{children:":"})," ",w.subjectName]}),v.jsxs("div",{children:[v.jsx("strong",{children:":"})," ",w.type]}),v.jsxs("div",{children:[v.jsx("strong",{children:"--:"})," ",w.gradeYear]}),v.jsxs("div",{style:{gridColumn:"1 / -1"},children:[v.jsx("strong",{children:":"})," ",new Date(w.submittedAt).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),w.completedAt&&v.jsxs("div",{style:{gridColumn:"1 / -1",backgroundColor:"var(--primary-green-light)",padding:"10px",borderRadius:"4px"},children:[v.jsx("strong",{children:":"})," ",new Date(w.completedAt).toLocaleDateString("th-TH")]})]}),((x=w.images)==null?void 0:x.length)>0&&v.jsxs("div",{style:{marginTop:"20px"},children:[v.jsxs("strong",{style:{display:"block",marginBottom:"10px"},children:[" (",w.images.length," ):"]}),v.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:w.images.map((I,L)=>v.jsxs("div",{className:"image-preview",onClick:()=>n(I),children:[v.jsx("img",{src:I,alt:`work ${L+1}`,style:{width:"100%",height:"200px",objectFit:"cover"}}),v.jsx("div",{className:"zoom-icon",children:v.jsx(GI,{size:24})})]},L))})]})]})]},w.id)})})]})},iB=({submission:t,onSave:e,onCancel:r})=>{const[n,i]=ke.useState({...t}),s=o=>{const{name:l,value:u}=o.target;i(f=>({...f,[l]:u}))},a=o=>{o.preventDefault(),e(n.id,n)};return v.jsx("div",{className:"modal-overlay",children:v.jsxs("div",{className:"modal-content",children:[v.jsx("h3",{className:"modal-title",children:""}),v.jsxs("form",{onSubmit:a,children:[v.jsxs("div",{className:"grid-2",children:[v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:"-"}),v.jsx("input",{name:"studentName",value:n.studentName,onChange:s,className:"form-input",required:!0})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsx("input",{name:"studentId",value:n.studentId,onChange:s,className:"form-input",required:!0})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsx("input",{name:"grade",value:n.grade,onChange:s,className:"form-input",required:!0})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsx("input",{name:"subjectCode",value:n.subjectCode,onChange:s,className:"form-input",required:!0})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsx("input",{name:"subjectName",value:n.subjectName,onChange:s,className:"form-input",required:!0})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsxs("select",{name:"type",value:n.type,onChange:s,className:"form-select",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:".",children:"."}),v.jsx("option",{value:".",children:"."}),v.jsx("option",{value:".",children:"."})]})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:"-"}),v.jsx("input",{name:"gradeYear",value:n.gradeYear,onChange:s,className:"form-input",required:!0})]})]}),v.jsxs("div",{className:"modal-buttons",children:[v.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:""}),v.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary btn-full",children:""})]})]})]})})},sB=({data:t,filename:e="submissions",onExport:r})=>{const[n,i]=ke.useState(!1),s=a=>{r(t,e,a),i(!1)};return v.jsxs("div",{style:{position:"relative"},children:[v.jsxs("button",{onClick:()=>i(!n),className:"btn btn-outline",style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"white",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"8px 16px"},children:[v.jsx(H0,{size:16}),"",v.jsx(jI,{size:16})]}),n&&v.jsxs(v.Fragment,{children:[v.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>i(!1)}),v.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",backgroundColor:"white",border:"1px solid var(--border-color)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",minWidth:"200px",zIndex:1e3,overflow:"hidden"},children:[v.jsxs("button",{onClick:()=>s("excel"),style:{width:"100%",padding:"12px 16px",border:"none",backgroundColor:"white",textAlign:"left",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",transition:"background-color 0.2s"},onMouseEnter:a=>a.target.style.backgroundColor="#f8f9fa",onMouseLeave:a=>a.target.style.backgroundColor="white",children:[v.jsx(H0,{size:16,style:{color:"#4CAF50"}}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:"500",color:"var(--text-primary)"},children:"Excel (.xlsx)"}),v.jsx("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:""})]})]}),v.jsx("div",{style:{height:"1px",backgroundColor:"var(--border-color)"}}),v.jsxs("button",{onClick:()=>s("csv"),style:{width:"100%",padding:"12px 16px",border:"none",backgroundColor:"white",textAlign:"left",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",transition:"background-color 0.2s"},onMouseEnter:a=>a.target.style.backgroundColor="#f8f9fa",onMouseLeave:a=>a.target.style.backgroundColor="white",children:[v.jsx(H0,{size:16,style:{color:"#2196F3"}}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:"500",color:"var(--text-primary)"},children:"CSV (.csv)"}),v.jsx("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:""})]})]})]})]})]})},aB=({submissions:t,onLogout:e,onUpdateStatus:r,onDelete:n,onRestore:i,onPermanentDelete:s,onViewImage:a,onUpdateSubmission:o,onUpdateNote:l,onUpdateGrading:u,onExport:f})=>{const[h,d]=ke.useState(""),[m,y]=ke.useState("name"),[g,A]=ke.useState("active"),[w,x]=ke.useState(null),[I,L]=ke.useState(null),[W,G]=ke.useState(null),[E,T]=ke.useState({}),[S,R]=ke.useState(null),[N,M]=ke.useState(null),[D,Re]=ke.useState(""),[Ie,nt]=ke.useState("all"),[Ke,he]=ke.useState(null),[J,te]=ke.useState({status:null,comment:""}),ce=(ue,it)=>{const Ve=`${ue}-${it}`;T(Nt=>({...Nt,[Ve]:!Nt[Ve]}))},V=ue=>{M(ue.id),Re(ue.adminNote||"")},z=ue=>{l(ue,D),M(null),Re("")},B=ue=>{he(ue.id),te({status:ue.gradingStatus||null,comment:ue.gradingComment||""})},j=ue=>{u(ue,J.status,J.comment),he(null),te({status:null,comment:""})},re=t.filter(ue=>ue.isPermanentlyDeleted||g==="active"&&ue.isDeleted||g==="trash"&&!ue.isDeleted||Ie!=="all"&&ue.status!==Ie?!1:h?m==="name"?ue.studentName.toLowerCase().includes(h.toLowerCase()):ue.studentId.includes(h):!0),ye={};re.forEach(ue=>{ye[ue.studentId]||(ye[ue.studentId]=[]),ye[ue.studentId].push(ue)});const Ae=t.filter(ue=>!ue.isDeleted&&!ue.isPermanentlyDeleted).length,Te=t.filter(ue=>!ue.isDeleted&&!ue.isPermanentlyDeleted&&(ue.status===""||ue.status==="")).length,ve=t.filter(ue=>!ue.isDeleted&&!ue.isPermanentlyDeleted&&ue.status==="").length,$e=t.filter(ue=>ue.isDeleted&&!ue.isPermanentlyDeleted).length;return v.jsxs("div",{style:{maxWidth:"1400px",margin:"20px auto",padding:"20px 30px",animation:"fadeIn 0.5s ease-out"},children:[v.jsxs("div",{style:{marginBottom:"30px"},children:[v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[v.jsx("h2",{className:"page-title",children:"Admin Dashboard"}),v.jsxs("div",{style:{display:"flex",gap:"10px"},children:[v.jsx(sB,{data:re,filename:"admin_submissions",onExport:f}),v.jsxs("button",{onClick:e,className:"btn btn-danger",children:[v.jsx(F1,{size:18})," "]})]})]}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"20px"},children:[v.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",border:"1px solid #e0e0e0"},children:[v.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"8px"},children:""}),v.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"var(--text-primary)"},children:Ae})]}),v.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",border:"1px solid #e0e0e0"},children:[v.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"8px"},children:""}),v.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#ff9800"},children:Te})]}),v.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",border:"1px solid #e0e0e0"},children:[v.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"8px"},children:""}),v.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#4CAF50"},children:ve})]}),v.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",border:"1px solid #e0e0e0"},children:[v.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"8px"},children:""}),v.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#f44336"},children:$e})]})]})]}),v.jsxs("div",{className:"tabs-container",children:[v.jsxs("button",{onClick:()=>A("active"),className:`tab-btn ${g==="active"?"active":""}`,children:[" ",v.jsx("span",{className:"tab-badge",children:Ae})]}),v.jsxs("button",{onClick:()=>A("trash"),className:`tab-btn ${g==="trash"?"active":""}`,children:[v.jsx(Xx,{size:18}),"  ",v.jsx("span",{className:"tab-badge",children:$e})]})]}),v.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",flexWrap:"wrap"},children:[v.jsxs("select",{value:m,onChange:ue=>y(ue.target.value),className:"form-select",style:{width:"auto",minWidth:"150px"},children:[v.jsx("option",{value:"name",children:""}),v.jsx("option",{value:"id",children:""})]}),v.jsxs("div",{className:"search-input-wrapper",style:{flex:1,minWidth:"200px"},children:[v.jsx("input",{type:"text",placeholder:`${m==="name"?"":""}...`,value:h,onChange:ue=>d(ue.target.value),className:"search-input"}),v.jsx(XU,{size:20,className:"search-icon"})]}),g==="active"&&v.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[v.jsx(qU,{size:16,style:{color:"var(--text-secondary)"}}),v.jsxs("select",{value:Ie,onChange:ue=>nt(ue.target.value),className:"form-select",style:{width:"auto",minWidth:"130px"},children:[v.jsx("option",{value:"all",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]})]})]}),Object.keys(ye).length===0?v.jsxs("div",{className:"empty-state",children:[v.jsx("div",{className:"empty-state-icon",children:""}),v.jsx("p",{className:"empty-state-text",children:h||Ie!=="all"?"":""})]}):v.jsx("div",{className:"grid-auto-fill",children:Object.entries(ye).map(([ue,it],Ve)=>{const Nt=w===ue,Ye=it[0];return v.jsxs("div",{className:`card ${Nt?"card-selected":""}`,style:{cursor:"pointer",animation:`fadeInUp 0.4s ease-out ${Ve*.05}s both`},onClick:()=>x(Nt?null:ue),children:[v.jsxs("div",{style:{padding:"20px"},children:[v.jsxs("div",{style:{borderBottom:"2px solid var(--border-color)",paddingBottom:"12px",marginBottom:"12px"},children:[v.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",color:"var(--text-primary)"},children:Ye.studentName}),v.jsxs("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"14px"},children:[": ",ue," | : ",Ye.grade]})]}),v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("span",{className:"status-badge status-completed",children:[it.length," "]}),v.jsx("button",{className:`detail-toggle ${Nt?"active":""}`,style:{width:"auto",margin:0,padding:"8px 16px"},children:Nt?"":""})]})]}),Nt&&v.jsx("div",{className:"detail-content",onClick:se=>se.stopPropagation(),style:{padding:"20px",backgroundColor:"#f8f9fa",cursor:"default"},children:it.map(se=>{var $t;return v.jsxs("div",{className:"submission-item",style:{padding:0,overflow:"hidden",backgroundColor:"white",marginBottom:"8px",borderRadius:"8px",border:"1px solid var(--border-color)"},children:[v.jsxs("div",{onClick:()=>ce(ue,se.id),style:{padding:"10px 15px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:E[`${ue}-${se.id}`]?"#f8f9fa":"white",borderBottom:E[`${ue}-${se.id}`]?"1px solid var(--border-color)":"none"},children:[v.jsxs("strong",{style:{color:"var(--text-primary)"},children:[se.subjectName," (",se.subjectCode,")"]}),E[`${ue}-${se.id}`]?v.jsx(KU,{size:20,color:"var(--text-secondary)"}):v.jsx(jI,{size:20,color:"var(--text-secondary)"})]}),E[`${ue}-${se.id}`]&&v.jsxs("div",{style:{padding:"20px",backgroundColor:"#f8f9fa"},children:[v.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:v.jsxs("div",{style:{flex:1},children:[v.jsxs("div",{style:{marginBottom:"8px",color:"var(--text-secondary)"},children:[": ",v.jsx("span",{style:{color:"var(--text-primary)"},children:new Date(se.submittedAt).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),v.jsxs("div",{style:{marginBottom:"8px",color:"var(--text-secondary)"},children:[": ",v.jsx("span",{style:{color:"var(--text-primary)"},children:se.type})]}),v.jsxs("div",{style:{marginBottom:"8px",color:"var(--text-secondary)",wordBreak:"break-word"},children:["--: ",v.jsx("span",{style:{color:"var(--text-primary)"},children:se.gradeYear})]}),se.email&&v.jsxs("div",{style:{marginBottom:"8px",color:"var(--text-secondary)",wordBreak:"break-word"},children:[": ",v.jsx("span",{style:{color:"var(--text-primary)"},children:se.email})]}),v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"15px"},children:[v.jsx("strong",{style:{color:"var(--text-primary)"},children:":"}),v.jsxs("select",{value:se.status,onChange:De=>r(se.id,De.target.value),className:"form-select",style:{width:"auto",padding:"6px 30px 6px 12px",minWidth:"140px",height:"36px"},onClick:De=>De.stopPropagation(),children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]})]})]})}),!se.isDeleted&&v.jsxs("div",{style:{marginBottom:"15px",padding:"15px",backgroundColor:"white",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px"},children:[v.jsx(zI,{size:16,style:{color:"#4CAF50"}}),v.jsx("strong",{style:{color:"var(--text-primary)",fontSize:"14px"},children:":"})]}),N===se.id?v.jsxs("div",{children:[v.jsx("textarea",{value:D,onChange:De=>Re(De.target.value),placeholder:"...",style:{width:"100%",minHeight:"80px",padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",resize:"vertical"},onClick:De=>De.stopPropagation()}),v.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"10px"},children:[v.jsx("button",{onClick:()=>z(se.id),className:"btn btn-sm btn-primary",children:""}),v.jsx("button",{onClick:()=>{M(null),Re("")},className:"btn btn-sm btn-secondary",children:""})]})]}):v.jsxs("div",{children:[se.adminNote?v.jsx("p",{style:{margin:"0 0 10px 0",color:"var(--text-primary)",fontSize:"14px",lineHeight:"1.6",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:se.adminNote}):v.jsx("p",{style:{margin:"0 0 10px 0",color:"var(--text-secondary)",fontSize:"14px",fontStyle:"italic"},children:""}),v.jsxs("button",{onClick:()=>V(se),className:"btn btn-sm btn-outline",style:{display:"flex",alignItems:"center",gap:"5px"},children:[v.jsx(G0,{size:14})," ",se.adminNote?"":""]})]})]}),!se.isDeleted&&v.jsxs("div",{style:{marginBottom:"15px",padding:"15px",backgroundColor:"white",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[v.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px"},children:v.jsx("strong",{style:{color:"var(--text-primary)",fontSize:"14px"},children:":"})}),Ke===se.id?v.jsxs("div",{children:[v.jsxs("select",{value:J.status||"",onChange:De=>te({...J,status:De.target.value||null}),className:"form-select",style:{width:"100%",marginBottom:"10px",padding:"8px"},onClick:De=>De.stopPropagation(),children:[v.jsx("option",{value:"",children:"--  --"}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]}),v.jsx("textarea",{value:J.comment,onChange:De=>te({...J,comment:De.target.value}),placeholder:"...",style:{width:"100%",minHeight:"80px",padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",resize:"vertical"},onClick:De=>De.stopPropagation()}),v.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"10px"},children:[v.jsx("button",{onClick:()=>j(se.id),className:"btn btn-sm btn-primary",children:""}),v.jsx("button",{onClick:()=>{he(null),te({status:null,comment:""})},className:"btn btn-sm btn-secondary",children:""})]})]}):v.jsxs("div",{children:[se.gradingStatus?v.jsxs("div",{children:[v.jsx("div",{style:{marginBottom:"10px"},children:v.jsx("span",{style:{display:"inline-block",padding:"6px 12px",borderRadius:"6px",backgroundColor:se.gradingStatus===""?"#4CAF50":"#f44336",color:"white",fontWeight:"bold",fontSize:"14px"},children:se.gradingStatus})}),se.gradingComment&&v.jsx("p",{style:{margin:"0 0 10px 0",color:"var(--text-primary)",fontSize:"14px",lineHeight:"1.6",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:se.gradingComment})]}):v.jsx("p",{style:{margin:"0 0 10px 0",color:"var(--text-secondary)",fontSize:"14px",fontStyle:"italic"},children:""}),v.jsxs("button",{onClick:()=>B(se),className:"btn btn-sm btn-outline",style:{display:"flex",alignItems:"center",gap:"5px"},children:[v.jsx(G0,{size:14})," ",se.gradingStatus?"":""]})]})]}),(($t=se.images)==null?void 0:$t.length)>0&&v.jsxs("div",{style:{marginTop:"15px"},children:[v.jsxs("div",{style:{marginBottom:"8px",fontWeight:"bold",color:"var(--text-primary)"},children:[" (",se.images.length," ):"]}),v.jsx("div",{className:"image-grid",children:se.images.map((De,at)=>v.jsxs("div",{className:"image-preview",onClick:()=>a(De),children:[v.jsx("img",{src:De,alt:`work ${at+1}`}),v.jsx("div",{className:"zoom-icon",children:v.jsx(GI,{size:20})})]},at))})]}),v.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"20px",borderTop:"1px solid var(--border-color)",paddingTop:"15px"},children:se.isDeleted?v.jsxs(v.Fragment,{children:[v.jsxs("button",{onClick:()=>i(se.id),className:"btn btn-sm btn-primary",children:[v.jsx(WI,{size:14})," "]}),v.jsxs("button",{onClick:()=>G(se.id),className:"btn btn-sm btn-danger",children:[v.jsx(Xx,{size:14})," "]})]}):v.jsxs(v.Fragment,{children:[v.jsxs("button",{onClick:()=>R(se),className:"btn btn-sm btn-outline",style:{display:"flex",alignItems:"center",gap:"5px",backgroundColor:"white",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"6px 12px"},children:[v.jsx(G0,{size:14})," "]}),v.jsxs("button",{onClick:()=>L(se.id),className:"btn btn-sm btn-danger",style:{display:"flex",alignItems:"center",gap:"5px"},children:[v.jsx(YU,{size:14})," "]})]})})]})]},se.id)})})]},ue)})}),I&&v.jsx("div",{className:"modal-overlay",children:v.jsxs("div",{className:"modal-content",style:{maxWidth:"400px"},children:[v.jsx("h3",{className:"modal-title",style:{color:"#f44336",borderColor:"#f44336"},children:""}),v.jsx("p",{children:"?"}),v.jsxs("div",{className:"modal-buttons",children:[v.jsx("button",{onClick:()=>{n(I),L(null)},className:"btn btn-danger btn-full",children:""}),v.jsx("button",{onClick:()=>L(null),className:"btn btn-secondary btn-full",children:""})]})]})}),W&&v.jsx("div",{className:"modal-overlay",children:v.jsxs("div",{className:"modal-content",style:{maxWidth:"400px",border:"2px solid #d32f2f"},children:[v.jsx("h3",{className:"modal-title",style:{color:"#d32f2f",borderColor:"#d32f2f"},children:""}),v.jsx("p",{style:{fontWeight:"bold",color:"#d32f2f"},children:"!  Admin "}),v.jsxs("div",{className:"modal-buttons",children:[v.jsx("button",{onClick:()=>{s(W),G(null)},className:"btn btn-danger btn-full",children:""}),v.jsx("button",{onClick:()=>G(null),className:"btn btn-secondary btn-full",children:""})]})]})}),S&&v.jsx(iB,{submission:S,onSave:(ue,it)=>{o(ue,it),R(null)},onCancel:()=>R(null)})]})},oB=({user:t,onUpdate:e,onChangePassword:r,onNavigate:n,previousPage:i})=>{const[s,a]=ke.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||""}),[o,l]=ke.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[u,f]=ke.useState(!1),[h,d]=ke.useState(!1),[m,y]=ke.useState(!1),[g,A]=ke.useState(!1),[w,x]=ke.useState(""),[I,L]=ke.useState(""),W=!(t!=null&&t.password)||(t==null?void 0:t.password)==="",G=S=>{if(S.preventDefault(),s.name.trim()===""){x("-");return}e(s),L(""),setTimeout(()=>L(""),3e3)},E=S=>{if(S.preventDefault(),x(""),o.newPassword!==o.confirmPassword){x("");return}if(o.newPassword.length<6){x(" 6 ");return}r(o.oldPassword,o.newPassword),l({oldPassword:"",newPassword:"",confirmPassword:""}),f(!1),L(""),setTimeout(()=>L(""),3e3)},T=S=>{S.preventDefault(),S.stopPropagation(),n(i||(t!=null&&t.isAdmin?"admin":"history"))};return v.jsx("div",{className:"login-container",children:v.jsxs("div",{className:"form-container",style:{maxWidth:"500px",position:"relative",paddingTop:"60px"},children:[v.jsxs("button",{type:"button",onClick:T,className:"back-button",style:{position:"absolute",top:"20px",left:"20px",display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"8px",cursor:"pointer",color:"var(--text-secondary)",fontSize:"14px",transition:"all 0.2s",zIndex:10},children:[v.jsx($U,{size:16}),""]}),v.jsxs("div",{className:"text-center",style:{marginBottom:"30px"},children:[v.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:"#4CAF50",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},children:v.jsx(HI,{size:40,style:{color:"white"}})}),v.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:"28px",color:"var(--text-primary)"},children:""}),v.jsx("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"14px"},children:""})]}),I&&v.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#d4edda",color:"#155724",borderRadius:"8px",marginBottom:"20px",border:"1px solid #c3e6cb",animation:"fadeIn 0.3s ease-out"},children:[" ",I]}),w&&v.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"8px",marginBottom:"20px",border:"1px solid #f5c6cb",animation:"fadeIn 0.3s ease-out"},children:[" ",w]}),v.jsxs("form",{onSubmit:G,children:[v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:"-"}),v.jsx("input",{type:"text",value:s.name,onChange:S=>a({...s,name:S.target.value}),className:"form-input",required:!0})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsx("input",{type:"email",value:s.email,className:"form-input",disabled:!0,style:{backgroundColor:"#f8f9fa",cursor:"not-allowed",opacity:.7}}),v.jsx("small",{style:{color:"var(--text-secondary)",fontSize:"12px",display:"block",marginTop:"4px"},children:"* "})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsx("div",{style:{padding:"12px 16px",backgroundColor:t!=null&&t.isAdmin?"#e8f5e9":"#e3f2fd",border:`1px solid ${t!=null&&t.isAdmin?"#4CAF50":"#2196F3"}`,borderRadius:"8px",color:t!=null&&t.isAdmin?"#2e7d32":"#1565c0",fontWeight:"500",textAlign:"center"},children:t!=null&&t.isAdmin?"  (Admin)":"  (Student)"})]}),v.jsxs("button",{type:"submit",className:"btn btn-primary btn-full",style:{marginTop:"10px"},children:[v.jsx(qx,{size:18,style:{marginRight:"8px"}}),""]})]}),v.jsx("div",{style:{margin:"30px 0",borderTop:"1px solid var(--border-color)",position:"relative"},children:v.jsx("span",{style:{position:"absolute",top:"-12px",left:"50%",transform:"translateX(-50%)",backgroundColor:"white",padding:"0 16px",color:"var(--text-secondary)",fontSize:"14px"},children:""})}),W?v.jsxs("div",{style:{padding:"20px",backgroundColor:"#e3f2fd",border:"1px solid #2196F3",borderRadius:"8px",display:"flex",alignItems:"center",gap:"12px"},children:[v.jsx($0,{size:24,style:{color:"#2196F3"}}),v.jsxs("div",{children:[v.jsx("h3",{style:{margin:0,fontSize:"16px",color:"#1565c0"},children:" Google"}),v.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"13px",color:"#1976d2"},children:" Google Account "})]})]}):v.jsxs("div",{children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"8px"},children:[v.jsx($0,{size:24,style:{color:"#4CAF50"}}),v.jsxs("div",{style:{flex:1},children:[v.jsx("h3",{style:{margin:0,fontSize:"16px",color:"var(--text-primary)"},children:""}),v.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"13px",color:"var(--text-secondary)"},children:""})]})]}),u?v.jsxs("form",{onSubmit:E,style:{animation:"fadeIn 0.3s ease-out"},children:[v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsxs("div",{style:{position:"relative"},children:[v.jsx("input",{type:h?"text":"password",value:o.oldPassword,onChange:S=>l({...o,oldPassword:S.target.value}),className:"form-input",style:{paddingRight:"45px"},required:!0}),v.jsx("button",{type:"button",onClick:()=>d(!h),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-secondary)",padding:"4px",display:"flex",alignItems:"center"},children:h?v.jsx(lu,{size:18}):v.jsx(uu,{size:18})})]})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsxs("div",{style:{position:"relative"},children:[v.jsx("input",{type:m?"text":"password",value:o.newPassword,onChange:S=>l({...o,newPassword:S.target.value}),className:"form-input",style:{paddingRight:"45px"},required:!0,minLength:6}),v.jsx("button",{type:"button",onClick:()=>y(!m),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-secondary)",padding:"4px",display:"flex",alignItems:"center"},children:m?v.jsx(lu,{size:18}):v.jsx(uu,{size:18})})]}),v.jsx("small",{style:{color:"var(--text-secondary)",fontSize:"12px",display:"block",marginTop:"4px"},children:"*  6 "})]}),v.jsxs("div",{className:"form-group",children:[v.jsx("label",{className:"form-label",children:""}),v.jsxs("div",{style:{position:"relative"},children:[v.jsx("input",{type:g?"text":"password",value:o.confirmPassword,onChange:S=>l({...o,confirmPassword:S.target.value}),className:"form-input",style:{paddingRight:"45px"},required:!0}),v.jsx("button",{type:"button",onClick:()=>A(!g),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-secondary)",padding:"4px",display:"flex",alignItems:"center"},children:g?v.jsx(lu,{size:18}):v.jsx(uu,{size:18})})]})]}),v.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[v.jsxs("button",{type:"submit",className:"btn btn-primary",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[v.jsx(qx,{size:16}),""]}),v.jsxs("button",{type:"button",onClick:()=>{f(!1),l({oldPassword:"",newPassword:"",confirmPassword:""}),x(""),d(!1),y(!1),A(!1)},className:"btn btn-secondary",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[v.jsx($I,{size:16}),""]})]})]}):v.jsxs("button",{onClick:()=>f(!0),className:"btn btn-outline btn-full",type:"button",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[v.jsx($0,{size:16}),""]})]})]})})},lB=()=>v.jsx("div",{className:"spinner"}),uB=()=>{const[t,e]=ke.useState(null),[r,n]=ke.useState("login"),[i,s]=ke.useState(null),[a,o]=ke.useState([]),[l,u]=ke.useState([]),[f,h]=ke.useState(null),[d,m]=ke.useState({show:!1,message:"",type:""}),[y,g]=ke.useState(!1),[A,w]=ke.useState(!0);ke.useEffect(()=>{(async()=>{try{w(!0);const[ce,V]=await Promise.all([Ct.getUsers(),Ct.getSubmissions()]);o(ce),u(V)}catch(ce){console.error("Error loading data:",ce),x("","error")}finally{w(!1)}})();const te=Ct.subscribeToSubmissions(ce=>{u(ce)});return()=>{te&&te()}},[]),ke.useEffect(()=>{(async()=>{try{const ce=localStorage.getItem("currentUser"),V=localStorage.getItem("currentPage");if(ce){const z=JSON.parse(ce);e(z),n(V||(z.isAdmin?"admin":"submit"))}}catch(ce){console.error("Error restoring session:",ce),localStorage.removeItem("currentUser"),localStorage.removeItem("currentPage")}})();const te=kl.onAuthStateChange(async ce=>{if(ce)try{const V=await Ct.getUserByEmail(ce.email);if(V&&(e(V),localStorage.setItem("currentUser",JSON.stringify(V)),!localStorage.getItem("currentPage"))){const B=V.isAdmin?"admin":"submit";n(B),localStorage.setItem("currentPage",B)}}catch(V){console.error("Error loading user from Firestore:",V)}});return()=>{te&&te()}},[]);const x=(J,te="success")=>{m({show:!0,message:J,type:te}),setTimeout(()=>m(ce=>({...ce,show:!1})),3e3)},I=async(J,te)=>{try{const ce=J.toLowerCase().trim(),V=await kl.loginWithEmail(ce,te);let z=await Ct.getUserByEmail(ce);if(!z){z={email:ce,name:V.name||J.split("@")[0],password:te,isAdmin:!1},await Ct.saveUser(z);const j=[...a,z];o(j)}e(z),localStorage.setItem("currentUser",JSON.stringify(z));const B=z.isAdmin?"admin":"submit";n(B),localStorage.setItem("currentPage",B),x("")}catch(ce){console.error("Login error:",ce);const V=J.toLowerCase().trim(),z=a.find(B=>B.email.toLowerCase()===V&&B.password===te);if(z){e(z),localStorage.setItem("currentUser",JSON.stringify(z));const B=z.isAdmin?"admin":"submit";n(B),localStorage.setItem("currentPage",B),x("")}else x("","error")}},L=async J=>{try{const te=J.email.toLowerCase().trim();if(a.some(j=>j.email.toLowerCase()===te)){x("","error");return}if(J.adminCode&&J.adminCode!=="ADMIN_TAWEETHAPISEK"){x(" Admin ","error");return}const ce=await kl.registerWithEmail(te,J.password,J.name),V={...J,email:te,isAdmin:!!J.adminCode,uid:ce.uid};await Ct.saveUser(V);const z=[...a,V];o(z),e(V),localStorage.setItem("currentUser",JSON.stringify(V));const B=V.isAdmin?"admin":"submit";n(B),localStorage.setItem("currentPage",B),x("")}catch(te){console.error("Registration error:",te),te.code==="auth/email-already-in-use"?x(" Firebase Authentication","error"):x("","error")}},W=async()=>{try{const J=await kl.signInWithGoogle();let te=await Ct.getUserByEmail(J.email);if(te){te={...te,photoURL:J.photoURL,uid:J.uid},await Ct.saveUser(te);const V=a.map(z=>z.email===te.email?te:z);o(V)}else{te={email:J.email,name:J.name,photoURL:J.photoURL,isAdmin:!1,password:"",uid:J.uid},await Ct.saveUser(te);const V=[...a,te];o(V)}e(te),localStorage.setItem("currentUser",JSON.stringify(te));const ce=te.isAdmin?"admin":"submit";n(ce),localStorage.setItem("currentPage",ce),x(" Google ")}catch(J){console.error("Google Sign-In Error:",J),x(" Google ","error")}},G=async()=>{try{await kl.signOutUser()}catch(J){console.error("Logout error:",J)}e(null),n("login"),g(!1),localStorage.removeItem("currentUser"),localStorage.removeItem("currentPage")},E=async J=>{try{const te={id:Date.now().toString(),...J,userEmail:t==null?void 0:t.email,status:"",gradingStatus:null,gradingComment:"",submittedAt:new Date().toISOString(),isDeleted:!1,isPermanentlyDeleted:!1,adminNote:""};await Ct.addSubmission(te),x("");const ce="history";n(ce),localStorage.setItem("currentPage",ce)}catch(te){console.error("Submit work error:",te),x("","error")}},T=async(J,te)=>{try{const ce={status:te,completedAt:te===""?new Date().toISOString():null};await Ct.updateSubmission(J,ce),x("")}catch(ce){console.error("Update status error:",ce),x("","error")}},S=async(J,te)=>{try{await Ct.updateSubmission(J,te),x("")}catch(ce){console.error("Update submission error:",ce),x("","error")}},R=async(J,te)=>{try{await Ct.updateSubmission(J,{adminNote:te}),x("")}catch(ce){console.error("Update note error:",ce),x("","error")}},N=async(J,te,ce)=>{try{await Ct.updateSubmission(J,{gradingStatus:te,gradingComment:ce}),x("")}catch(V){console.error("Update grading error:",V),x("","error")}},M=async J=>{try{await Ct.deleteSubmission(J),x("")}catch(te){console.error("Delete submission error:",te),x("","error")}},D=async J=>{try{await Ct.restoreSubmission(J),x("")}catch(te){console.error("Restore submission error:",te),x("","error")}},Re=async J=>{try{await Ct.permanentDeleteSubmission(J),x("")}catch(te){console.error("Permanent delete error:",te),x("","error")}},Ie=async J=>{try{const te={...t,...J};await Ct.saveUser(te);const ce=a.map(V=>V.email===t.email?te:V);o(ce),e(te),localStorage.setItem("currentUser",JSON.stringify(te)),x("")}catch(te){console.error("Update profile error:",te),x("","error")}},nt=async(J,te)=>{try{if(t.password!==J){x("","error");return}const ce={...t,password:te};await Ct.saveUser(ce);const V=a.map(z=>z.email===t.email?ce:z);o(V),e(ce),localStorage.setItem("currentUser",JSON.stringify(ce)),x("")}catch(ce){console.error("Change password error:",ce),x("","error")}},Ke=(J,te,ce)=>{try{ce==="excel"?Kx.exportToExcel(J,te):ce==="csv"&&Kx.exportToCSV(J,te),x(` ${ce==="excel"?"Excel":"CSV"} `)}catch(V){x("","error"),console.error("Export error:",V)}},he=()=>{s(r);const J="profile";n(J),localStorage.setItem("currentPage",J)};return A?v.jsx("div",{className:"app-container",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:v.jsxs("div",{style:{textAlign:"center"},children:[v.jsx(lB,{}),v.jsx("p",{style:{fontSize:"18px",color:"var(--text-secondary)"},children:"..."})]})}):v.jsxs("div",{className:"app-container",children:[v.jsx(QU,{currentUser:t,onNavigateToProfile:he}),v.jsx(JU,{image:f,onClose:()=>h(null)}),v.jsx(ZU,{popup:d,onClose:()=>m({...d,show:!1})}),v.jsx(eB,{show:y,onConfirm:G,onCancel:()=>g(!1)}),!t&&v.jsx(tB,{onLogin:I,onRegister:L,onGoogleSignIn:W}),t&&!t.isAdmin&&r==="submit"&&v.jsx(rB,{onSubmit:E,onNavigate:J=>{n(J),localStorage.setItem("currentPage",J)},currentUser:t,onLogout:()=>g(!0)}),t&&!t.isAdmin&&r==="history"&&v.jsx(nB,{submissions:l.filter(J=>J.userEmail===t.email||J.studentName===t.name),onNavigate:J=>{n(J),localStorage.setItem("currentPage",J)},onLogout:()=>g(!0),onViewImage:h}),t&&t.isAdmin&&r==="admin"&&v.jsx(aB,{submissions:l,onLogout:()=>g(!0),onUpdateStatus:T,onUpdateSubmission:S,onUpdateNote:R,onUpdateGrading:N,onDelete:M,onRestore:D,onPermanentDelete:Re,onViewImage:h,onExport:Ke}),t&&r==="profile"&&v.jsx(oB,{user:t,onUpdate:Ie,onChangePassword:nt,onNavigate:J=>{n(J),localStorage.setItem("currentPage",J)},previousPage:i})]})};K0.createRoot(document.getElementById("root")).render(v.jsx(EC.StrictMode,{children:v.jsx(uB,{})}));
